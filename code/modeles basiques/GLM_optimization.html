<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="AKROUT Leyth, BOULAHFA Jawad, DE SANTIAGO Kylliann" />


<title>GLM optimization</title>

<style type="text/css">.pagedtable {
overflow: auto;
padding-left: 8px;
padding-right: 8px;
}
.pagedtable-wrapper {
border: 1px solid #ccc;
border-radius: 4px;
margin-bottom: 10px;
}
.pagedtable table {
width: 100%;
max-width: 100%;
margin: 0;
}
.pagedtable th {
padding: 0 5px 0 5px;
border: none;
border-bottom: 2px solid #dddddd;
min-width: 45px;
}
.pagedtable-empty th {
display: none;
}
.pagedtable td {
padding: 0 4px 0 4px;
}
.pagedtable .even {
background-color: rgba(140, 140, 140, 0.1);
}
.pagedtable-padding-col {
display: none;
}
.pagedtable a {
-webkit-touch-callout: none;
-webkit-user-select: none;
-khtml-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.pagedtable-index-nav {
cursor: pointer;
padding: 0 5px 0 5px;
float: right;
border: 0;
}
.pagedtable-index-nav-disabled {
cursor: default;
text-decoration: none;
color: #999;
}
a.pagedtable-index-nav-disabled:hover {
text-decoration: none;
color: #999;
}
.pagedtable-indexes {
cursor: pointer;
float: right;
border: 0;
}
.pagedtable-index-current {
cursor: default;
text-decoration: none;
font-weight: bold;
color: #333;
border: 0;
}
a.pagedtable-index-current:hover {
text-decoration: none;
font-weight: bold;
color: #333;
}
.pagedtable-index {
width: 30px;
display: inline-block;
text-align: center;
border: 0;
}
.pagedtable-index-separator-left {
display: inline-block;
color: #333;
font-size: 9px;
padding: 0 0 0 0;
cursor: default;
}
.pagedtable-index-separator-right {
display: inline-block;
color: #333;
font-size: 9px;
padding: 0 4px 0 0;
cursor: default;
}
.pagedtable-footer {
padding-top: 4px;
padding-bottom: 5px;
}
.pagedtable-not-empty .pagedtable-footer {
border-top: 2px solid #dddddd;
}
.pagedtable-info {
overflow: hidden;
color: #999;
white-space: nowrap;
text-overflow: ellipsis;
}
.pagedtable-header-name {
overflow: hidden;
text-overflow: ellipsis;
}
.pagedtable-header-type {
color: #999;
font-weight: 400;
}
.pagedtable-na-cell {
font-style: italic;
opacity: 0.3;
}
</style>
<script>// Production steps of ECMA-262, Edition 5, 15.4.4.18
// Reference: http://es5.github.io/#x15.4.4.18
if (!Array.prototype.forEach) {

  Array.prototype.forEach = function(callback, thisArg) {

    var T, k;

    if (this === null) {
      throw new TypeError(' this is null or not defined');
    }

    // 1. Let O be the result of calling toObject() passing the
    // |this| value as the argument.
    var O = Object(this);

    // 2. Let lenValue be the result of calling the Get() internal
    // method of O with the argument "length".
    // 3. Let len be toUint32(lenValue).
    var len = O.length >>> 0;

    // 4. If isCallable(callback) is false, throw a TypeError exception.
    // See: http://es5.github.com/#x9.11
    if (typeof callback !== "function") {
      throw new TypeError(callback + ' is not a function');
    }

    // 5. If thisArg was supplied, let T be thisArg; else let
    // T be undefined.
    if (arguments.length > 1) {
      T = thisArg;
    }

    // 6. Let k be 0
    k = 0;

    // 7. Repeat, while k < len
    while (k < len) {

      var kValue;

      // a. Let Pk be ToString(k).
      //    This is implicit for LHS operands of the in operator
      // b. Let kPresent be the result of calling the HasProperty
      //    internal method of O with argument Pk.
      //    This step can be combined with c
      // c. If kPresent is true, then
      if (k in O) {

        // i. Let kValue be the result of calling the Get internal
        // method of O with argument Pk.
        kValue = O[k];

        // ii. Call the Call internal method of callback with T as
        // the this value and argument list containing kValue, k, and O.
        callback.call(T, kValue, k, O);
      }
      // d. Increase k by 1.
      k++;
    }
    // 8. return undefined
  };
}

// Production steps of ECMA-262, Edition 5, 15.4.4.19
// Reference: http://es5.github.io/#x15.4.4.19
if (!Array.prototype.map) {

  Array.prototype.map = function(callback, thisArg) {

    var T, A, k;

    if (this == null) {
      throw new TypeError(' this is null or not defined');
    }

    // 1. Let O be the result of calling ToObject passing the |this|
    //    value as the argument.
    var O = Object(this);

    // 2. Let lenValue be the result of calling the Get internal
    //    method of O with the argument "length".
    // 3. Let len be ToUint32(lenValue).
    var len = O.length >>> 0;

    // 4. If IsCallable(callback) is false, throw a TypeError exception.
    // See: http://es5.github.com/#x9.11
    if (typeof callback !== 'function') {
      throw new TypeError(callback + ' is not a function');
    }

    // 5. If thisArg was supplied, let T be thisArg; else let T be undefined.
    if (arguments.length > 1) {
      T = thisArg;
    }

    // 6. Let A be a new array created as if by the expression new Array(len)
    //    where Array is the standard built-in constructor with that name and
    //    len is the value of len.
    A = new Array(len);

    // 7. Let k be 0
    k = 0;

    // 8. Repeat, while k < len
    while (k < len) {

      var kValue, mappedValue;

      // a. Let Pk be ToString(k).
      //   This is implicit for LHS operands of the in operator
      // b. Let kPresent be the result of calling the HasProperty internal
      //    method of O with argument Pk.
      //   This step can be combined with c
      // c. If kPresent is true, then
      if (k in O) {

        // i. Let kValue be the result of calling the Get internal
        //    method of O with argument Pk.
        kValue = O[k];

        // ii. Let mappedValue be the result of calling the Call internal
        //     method of callback with T as the this value and argument
        //     list containing kValue, k, and O.
        mappedValue = callback.call(T, kValue, k, O);

        // iii. Call the DefineOwnProperty internal method of A with arguments
        // Pk, Property Descriptor
        // { Value: mappedValue,
        //   Writable: true,
        //   Enumerable: true,
        //   Configurable: true },
        // and false.

        // In browsers that support Object.defineProperty, use the following:
        // Object.defineProperty(A, k, {
        //   value: mappedValue,
        //   writable: true,
        //   enumerable: true,
        //   configurable: true
        // });

        // For best browser support, use the following:
        A[k] = mappedValue;
      }
      // d. Increase k by 1.
      k++;
    }

    // 9. return A
    return A;
  };
}

var PagedTable = function (pagedTable) {
  var me = this;

  var source = function(pagedTable) {
    var sourceElems = [].slice.call(pagedTable.children).filter(function(e) {
      return e.hasAttribute("data-pagedtable-source");
    });

    if (sourceElems === null || sourceElems.length !== 1) {
      throw("A single data-pagedtable-source was not found");
    }

    return JSON.parse(sourceElems[0].innerHTML);
  }(pagedTable);

  var options = function(source) {
    var options = typeof(source.options) !== "undefined" &&
      source.options !== null ? source.options : {};

    var columns = typeof(options.columns) !== "undefined" ? options.columns : {};
    var rows = typeof(options.rows) !== "undefined" ? options.rows : {};

    var positiveIntOrNull = function(value) {
      return parseInt(value) >= 0 ? parseInt(value) : null;
    };

    return {
      pages: positiveIntOrNull(options.pages),
      rows: {
        min: positiveIntOrNull(rows.min),
        max: positiveIntOrNull(rows.max),
        total: positiveIntOrNull(rows.total)
      },
      columns: {
        min: positiveIntOrNull(columns.min),
        max: positiveIntOrNull(columns.max),
        total: positiveIntOrNull(columns.total)
      }
    };
  }(source);

  var Measurer = function() {

    // set some default initial values that will get adjusted in runtime
    me.measures = {
      padding: 12,
      character: 8,
      height: 15,
      defaults: true
    };

    me.calculate = function(measuresCell) {
      if (!me.measures.defaults)
        return;

      var measuresCellStyle = window.getComputedStyle(measuresCell, null);

      var newPadding = parsePadding(measuresCellStyle.paddingLeft) +
            parsePadding(measuresCellStyle.paddingRight);

      var sampleString = "ABCDEFGHIJ0123456789";
      var newCharacter = Math.ceil(measuresCell.clientWidth / sampleString.length);

      if (newPadding <= 0 || newCharacter <= 0)
        return;

      me.measures.padding = newPadding;
      me.measures.character = newCharacter;
      me.measures.height = measuresCell.clientHeight;
      me.measures.defaults = false;
    };

    return me;
  };

  var Page = function(data, options) {
    var me = this;

    var defaults = {
      max: 7,
      rows: 10
    };

    var totalPages = function() {
      return Math.ceil(data.length / me.rows);
    };

    me.number = 0;
    me.max = options.pages !== null ? options.pages : defaults.max;
    me.visible = me.max;
    me.rows = options.rows.min !== null ? options.rows.min : defaults.rows;
    me.total = totalPages();

    me.setRows = function(newRows) {
      me.rows = newRows;
      me.total = totalPages();
    };

    me.setPageNumber = function(newPageNumber) {
      if (newPageNumber < 0) newPageNumber = 0;
      if (newPageNumber >= me.total) newPageNumber = me.total - 1;

      me.number = newPageNumber;
    };

    me.setVisiblePages = function(visiblePages) {
      me.visible = Math.min(me.max, visiblePages);
      me.setPageNumber(me.number);
    };

    me.getVisiblePageRange = function() {
      var start = me.number - Math.max(Math.floor((me.visible - 1) / 2), 0);
      var end = me.number + Math.floor(me.visible / 2) + 1;
      var pageCount = me.total;

      if (start < 0) {
        var diffToStart = 0 - start;
        start += diffToStart;
        end += diffToStart;
      }

      if (end > pageCount) {
        var diffToEnd = end - pageCount;
        start -= diffToEnd;
        end -= diffToEnd;
      }

      start = start < 0 ? 0 : start;
      end = end >= pageCount ? pageCount : end;

      var first = false;
      var last = false;

      if (start > 0 && me.visible > 1) {
        start = start + 1;
        first = true;
      }

      if (end < pageCount && me.visible > 2) {
        end = end - 1;
        last = true;
      }

      return {
        first: first,
        start: start,
        end: end,
        last: last
      };
    };

    me.getRowStart = function() {
      var rowStart = page.number * page.rows;
      if (rowStart < 0)
        rowStart = 0;

      return rowStart;
    };

    me.getRowEnd = function() {
      var rowStart = me.getRowStart();
      return Math.min(rowStart + me.rows, data.length);
    };

    me.getPaddingRows = function() {
      var rowStart = me.getRowStart();
      var rowEnd = me.getRowEnd();
      return data.length > me.rows ? me.rows - (rowEnd - rowStart) : 0;
    };
  };

  var Columns = function(data, columns, options) {
    var me = this;

    me.defaults = {
      min: 5
    };

    me.number = 0;
    me.visible = 0;
    me.total = columns.length;
    me.subset = [];
    me.padding = 0;
    me.min = options.columns.min !== null ? options.columns.min : me.defaults.min;
    me.max = options.columns.max !== null ? options.columns.max : null;
    me.widths = {};

    var widthsLookAhead = Math.max(100, options.rows.min);
    var paddingColChars = 10;

    me.emptyNames = function() {
      columns.forEach(function(column) {
        if (columns.label !== null && columns.label !== "")
          return false;
      });

      return true;
    };

    var parsePadding = function(value) {
      return parseInt(value) >= 0 ? parseInt(value) : 0;
    };

    me.calculateWidths = function(measures) {
      columns.forEach(function(column) {
        var maxChars = Math.max(
          column.label.toString().length,
          column.type.toString().length
        );

        for (var idxRow = 0; idxRow < Math.min(widthsLookAhead, data.length); idxRow++) {
          maxChars = Math.max(maxChars, data[idxRow][column.name.toString()].length);
        }

        me.widths[column.name] = {
          // width in characters
          chars: maxChars,
          // width for the inner html columns
          inner: maxChars * measures.character,
          // width adding outer styles like padding
          outer: maxChars * measures.character + measures.padding
        };
      });
    };

    me.getWidth = function() {
      var widthOuter = 0;
      for (var idxCol = 0; idxCol < me.subset.length; idxCol++) {
        var columnName = me.subset[idxCol].name;
        widthOuter = widthOuter + me.widths[columnName].outer;
      }

      widthOuter = widthOuter + me.padding * paddingColChars * measurer.measures.character;

      if (me.hasMoreLeftColumns()) {
        widthOuter = widthOuter + columnNavigationWidthPX + measurer.measures.padding;
      }

      if (me.hasMoreRightColumns()) {
        widthOuter = widthOuter + columnNavigationWidthPX + measurer.measures.padding;
      }

      return widthOuter;
    };

    me.updateSlice = function() {
      if (me.number + me.visible >= me.total)
        me.number = me.total - me.visible;

      if (me.number < 0) me.number = 0;

      me.subset = columns.slice(me.number, Math.min(me.number + me.visible, me.total));

      me.subset = me.subset.map(function(column) {
        Object.keys(column).forEach(function(colKey) {
          column[colKey] = column[colKey] === null ? "" : column[colKey].toString();
        });

        column.width = null;
        return column;
      });
    };

    me.setVisibleColumns = function(columnNumber, newVisibleColumns, paddingCount) {
      me.number = columnNumber;
      me.visible = newVisibleColumns;
      me.padding = paddingCount;

      me.updateSlice();
    };

    me.incColumnNumber = function(increment) {
      me.number = me.number + increment;
    };

    me.setColumnNumber = function(newNumber) {
      me.number = newNumber;
    };

    me.setPaddingCount = function(newPadding) {
      me.padding = newPadding;
    };

    me.getPaddingCount = function() {
      return me.padding;
    };

    me.hasMoreLeftColumns = function() {
      return me.number > 0;
    };

    me.hasMoreRightColumns = function() {
      return me.number + me.visible < me.total;
    };

    me.updateSlice(0);
    return me;
  };

  var data = source.data;
  var page = new Page(data, options);
  var measurer = new Measurer(data, options);
  var columns = new Columns(data, source.columns, options);

  var table = null;
  var tableDiv = null;
  var header = null;
  var footer = null;
  var tbody = null;

  // Caches pagedTable.clientWidth, specially for webkit
  var cachedPagedTableClientWidth = null;

  var onChangeCallbacks = [];

  var clearSelection = function() {
    if(document.selection && document.selection.empty) {
      document.selection.empty();
    } else if(window.getSelection) {
      var sel = window.getSelection();
      sel.removeAllRanges();
    }
  };

  var columnNavigationWidthPX = 5;

  var renderColumnNavigation = function(increment, backwards) {
    var arrow = document.createElement("div");
    arrow.setAttribute("style",
      "border-top: " + columnNavigationWidthPX + "px solid transparent;" +
      "border-bottom: " + columnNavigationWidthPX + "px solid transparent;" +
      "border-" + (backwards ? "right" : "left") + ": " + columnNavigationWidthPX + "px solid;");

    var header = document.createElement("th");
    header.appendChild(arrow);
    header.setAttribute("style",
      "cursor: pointer;" +
      "vertical-align: middle;" +
      "min-width: " + columnNavigationWidthPX + "px;" +
      "width: " + columnNavigationWidthPX + "px;");

    header.onclick = function() {
      columns.incColumnNumber(backwards ? -1 : increment);

      me.animateColumns(backwards);
      renderFooter();

      clearSelection();
      triggerOnChange();
    };

    return header;
  };

  var maxColumnWidth = function(width) {
    var padding = 80;
    var columnMax = Math.max(cachedPagedTableClientWidth - padding, 0);

    return parseInt(width) > 0 ?
      Math.min(columnMax, parseInt(width)) + "px" :
      columnMax + "px";
  };

  var clearHeader = function() {
    var thead = pagedTable.querySelectorAll("thead")[0];
    thead.innerHTML = "";
  };

  var renderHeader = function(clear) {
    cachedPagedTableClientWidth = pagedTable.clientWidth;

    var fragment = document.createDocumentFragment();

    header = document.createElement("tr");
    fragment.appendChild(header);

    if (columns.number > 0)
      header.appendChild(renderColumnNavigation(-columns.visible, true));

    columns.subset = columns.subset.map(function(columnData) {
      var column = document.createElement("th");
      column.setAttribute("align", columnData.align);
      column.style.textAlign = columnData.align;

      column.style.maxWidth = maxColumnWidth(null);
      if (columnData.width) {
        column.style.minWidth =
          column.style.maxWidth = maxColumnWidth(columnData.width);
      }

      var columnName = document.createElement("div");
      columnName.setAttribute("class", "pagedtable-header-name");
      if (columnData.label === "") {
        columnName.innerHTML = "&nbsp;";
      }
      else {
        columnName.appendChild(document.createTextNode(columnData.label));
      }
      column.appendChild(columnName);

      var columnType = document.createElement("div");
      columnType.setAttribute("class", "pagedtable-header-type");
      if (columnData.type === "") {
        columnType.innerHTML = "&nbsp;";
      }
      else {
        columnType.appendChild(document.createTextNode("<" + columnData.type + ">"));
      }
      column.appendChild(columnType);

      header.appendChild(column);

      columnData.element = column;

      return columnData;
    });

    for (var idx = 0; idx < columns.getPaddingCount(); idx++) {
      var paddingCol = document.createElement("th");
      paddingCol.setAttribute("class", "pagedtable-padding-col");
      header.appendChild(paddingCol);
    }

    if (columns.number + columns.visible < columns.total)
      header.appendChild(renderColumnNavigation(columns.visible, false));

    if (typeof(clear) == "undefined" || clear) clearHeader();
    var thead = pagedTable.querySelectorAll("thead")[0];
    thead.appendChild(fragment);
  };

  me.animateColumns = function(backwards) {
    var thead = pagedTable.querySelectorAll("thead")[0];

    var headerOld = thead.querySelectorAll("tr")[0];
    var tbodyOld = table.querySelectorAll("tbody")[0];

    me.fitColumns(backwards);

    renderHeader(false);

    header.style.opacity = "0";
    header.style.transform = backwards ? "translateX(-30px)" : "translateX(30px)";
    header.style.transition = "transform 200ms linear, opacity 200ms";
    header.style.transitionDelay = "0";

    renderBody(false);

    if (headerOld) {
      headerOld.style.position = "absolute";
      headerOld.style.transform = "translateX(0px)";
      headerOld.style.opacity = "1";
      headerOld.style.transition = "transform 100ms linear, opacity 100ms";
      headerOld.setAttribute("class", "pagedtable-remove-head");
      if (headerOld.style.transitionEnd) {
        headerOld.addEventListener("transitionend", function() {
          var headerOldByClass = thead.querySelector(".pagedtable-remove-head");
          if (headerOldByClass) thead.removeChild(headerOldByClass);
        });
      }
      else {
        thead.removeChild(headerOld);
      }
    }

    if (tbodyOld) table.removeChild(tbodyOld);

    tbody.style.opacity = "0";
    tbody.style.transition = "transform 200ms linear, opacity 200ms";
    tbody.style.transitionDelay = "0ms";

    // force relayout
    window.getComputedStyle(header).opacity;
    window.getComputedStyle(tbody).opacity;

    if (headerOld) {
      headerOld.style.transform = backwards ? "translateX(20px)" : "translateX(-30px)";
      headerOld.style.opacity = "0";
    }

    header.style.transform = "translateX(0px)";
    header.style.opacity = "1";

    tbody.style.opacity = "1";
  }

  me.onChange = function(callback) {
    onChangeCallbacks.push(callback);
  };

  var triggerOnChange = function() {
    onChangeCallbacks.forEach(function(onChange) {
      onChange();
    });
  };

  var clearBody = function() {
    if (tbody) {
      table.removeChild(tbody);
      tbody = null;
    }
  };

  var renderBody = function(clear) {
    cachedPagedTableClientWidth = pagedTable.clientWidth

    var fragment = document.createDocumentFragment();

    var pageData = data.slice(page.getRowStart(), page.getRowEnd());

    pageData.forEach(function(dataRow, idxRow) {
      var htmlRow = document.createElement("tr");
      htmlRow.setAttribute("class", (idxRow % 2 !==0) ? "even" : "odd");

      if (columns.hasMoreLeftColumns())
        htmlRow.appendChild(document.createElement("td"));

      columns.subset.forEach(function(columnData) {
        var cellName = columnData.name;
        var dataCell = dataRow[cellName];
        var htmlCell = document.createElement("td");

        if (dataCell === "NA") htmlCell.setAttribute("class", "pagedtable-na-cell");
        if (dataCell === "__NA__") dataCell = "NA";

        var cellText = document.createTextNode(dataCell);
        htmlCell.appendChild(cellText);
        if (dataCell.length > 50) {
          htmlCell.setAttribute("title", dataCell);
        }
        htmlCell.setAttribute("align", columnData.align);
        htmlCell.style.textAlign = columnData.align;
        htmlCell.style.maxWidth = maxColumnWidth(null);
        if (columnData.width) {
          htmlCell.style.minWidth = htmlCell.style.maxWidth = maxColumnWidth(columnData.width);
        }
        htmlRow.appendChild(htmlCell);
      });

      for (var idx = 0; idx < columns.getPaddingCount(); idx++) {
        var paddingCol = document.createElement("td");
        paddingCol.setAttribute("class", "pagedtable-padding-col");
        htmlRow.appendChild(paddingCol);
      }

      if (columns.hasMoreRightColumns())
        htmlRow.appendChild(document.createElement("td"));

      fragment.appendChild(htmlRow);
    });

    for (var idxPadding = 0; idxPadding < page.getPaddingRows(); idxPadding++) {
      var paddingRow = document.createElement("tr");

      var paddingCellRow = document.createElement("td");
      paddingCellRow.innerHTML = "&nbsp;";
      paddingCellRow.setAttribute("colspan", "100%");
      paddingRow.appendChild(paddingCellRow);

      fragment.appendChild(paddingRow);
    }

    if (typeof(clear) == "undefined" || clear) clearBody();
    tbody = document.createElement("tbody");
    tbody.appendChild(fragment);

    table.appendChild(tbody);
  };

  var getLabelInfo = function() {
    var pageStart = page.getRowStart();
    var pageEnd = page.getRowEnd();
    var totalRows = data.length;

    var totalRowsLabel = options.rows.total ? options.rows.total : totalRows;
    var totalRowsLabelFormat = totalRowsLabel.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, '$1,');

    var infoText = (pageStart + 1) + "-" + pageEnd + " of " + totalRowsLabelFormat + " rows";
    if (totalRows < page.rows) {
      infoText = totalRowsLabel + " row" + (totalRows != 1 ? "s" : "");
    }
    if (columns.total > columns.visible) {
      var totalColumnsLabel = options.columns.total ? options.columns.total : columns.total;

      infoText = infoText + " | " + (columns.number + 1) + "-" +
        (Math.min(columns.number + columns.visible, columns.total)) +
        " of " + totalColumnsLabel + " columns";
    }

    return infoText;
  };

  var clearFooter = function() {
    footer = pagedTable.querySelectorAll("div.pagedtable-footer")[0];
    footer.innerHTML = "";

    return footer;
  };

  var createPageLink = function(idxPage) {
    var pageLink = document.createElement("a");
    pageLinkClass = idxPage === page.number ? "pagedtable-index pagedtable-index-current" : "pagedtable-index";
    pageLink.setAttribute("class", pageLinkClass);
    pageLink.setAttribute("data-page-index", idxPage);
    pageLink.onclick = function() {
      page.setPageNumber(parseInt(this.getAttribute("data-page-index")));
      renderBody();
      renderFooter();

      triggerOnChange();
    };

    pageLink.appendChild(document.createTextNode(idxPage + 1));

    return pageLink;
  }

  var renderFooter = function() {
    footer = clearFooter();

    var next = document.createElement("a");
    next.appendChild(document.createTextNode("Next"));
    next.onclick = function() {
      page.setPageNumber(page.number + 1);
      renderBody();
      renderFooter();

      triggerOnChange();
    };
    if (data.length > page.rows) footer.appendChild(next);

    var pageNumbers = document.createElement("div");
    pageNumbers.setAttribute("class", "pagedtable-indexes");

    var pageRange = page.getVisiblePageRange();

    if (pageRange.first) {
      var pageLink = createPageLink(0);
      pageNumbers.appendChild(pageLink);

      var pageSeparator = document.createElement("div");
      pageSeparator.setAttribute("class", "pagedtable-index-separator-left");
      pageSeparator.appendChild(document.createTextNode("..."))
      pageNumbers.appendChild(pageSeparator);
    }

    for (var idxPage = pageRange.start; idxPage < pageRange.end; idxPage++) {
      var pageLink = createPageLink(idxPage);

      pageNumbers.appendChild(pageLink);
    }

    if (pageRange.last) {
      var pageSeparator = document.createElement("div");
      pageSeparator.setAttribute("class", "pagedtable-index-separator-right");
      pageSeparator.appendChild(document.createTextNode("..."))
      pageNumbers.appendChild(pageSeparator);

      var pageLink = createPageLink(page.total - 1);
      pageNumbers.appendChild(pageLink);
    }

    if (data.length > page.rows) footer.appendChild(pageNumbers);

    var previous = document.createElement("a");
    previous.appendChild(document.createTextNode("Previous"));
    previous.onclick = function() {
      page.setPageNumber(page.number - 1);
      renderBody();
      renderFooter();

      triggerOnChange();
    };
    if (data.length > page.rows) footer.appendChild(previous);

    var infoLabel = document.createElement("div");
    infoLabel.setAttribute("class", "pagedtable-info");
    infoLabel.setAttribute("title", getLabelInfo());
    infoLabel.appendChild(document.createTextNode(getLabelInfo()));
    footer.appendChild(infoLabel);

    var enabledClass = "pagedtable-index-nav";
    var disabledClass = "pagedtable-index-nav pagedtable-index-nav-disabled";
    previous.setAttribute("class", page.number <= 0 ? disabledClass : enabledClass);
    next.setAttribute("class", (page.number + 1) * page.rows >= data.length ? disabledClass : enabledClass);
  };

  var measuresCell = null;

  var renderMeasures = function() {
    var measuresTable = document.createElement("table");
    measuresTable.style.visibility = "hidden";
    measuresTable.style.position = "absolute";
    measuresTable.style.whiteSpace = "nowrap";
    measuresTable.style.height = "auto";
    measuresTable.style.width = "auto";

    var measuresRow = document.createElement("tr");
    measuresTable.appendChild(measuresRow);

    measuresCell = document.createElement("td");
    var sampleString = "ABCDEFGHIJ0123456789";
    measuresCell.appendChild(document.createTextNode(sampleString));

    measuresRow.appendChild(measuresCell);

    tableDiv.appendChild(measuresTable);
  }

  me.init = function() {
    tableDiv = document.createElement("div");
    pagedTable.appendChild(tableDiv);
    var pagedTableClass = data.length > 0 ?
      "pagedtable pagedtable-not-empty" :
      "pagedtable pagedtable-empty";

    if (columns.total == 0 || (columns.emptyNames() && data.length == 0)) {
      pagedTableClass = pagedTableClass + " pagedtable-empty-columns";
    }

    tableDiv.setAttribute("class", pagedTableClass);

    renderMeasures();
    measurer.calculate(measuresCell);
    columns.calculateWidths(measurer.measures);

    table = document.createElement("table");
    table.setAttribute("cellspacing", "0");
    table.setAttribute("class", "table table-condensed");
    tableDiv.appendChild(table);

    table.appendChild(document.createElement("thead"));

    var footerDiv = document.createElement("div");
    footerDiv.setAttribute("class", "pagedtable-footer");
    tableDiv.appendChild(footerDiv);

    // if the host has not yet provided horizontal space, render hidden
    if (tableDiv.clientWidth <= 0) {
      tableDiv.style.opacity = "0";
    }

    me.render();

    // retry seizing columns later if the host has not provided space
    function retryFit() {
      if (tableDiv.clientWidth <= 0) {
        setTimeout(retryFit, 100);
      } else {
        me.render();
        triggerOnChange();
      }
    }
    if (tableDiv.clientWidth <= 0) {
      retryFit();
    }
  };

  var registerWidths = function() {
    columns.subset = columns.subset.map(function(column) {
      column.width = columns.widths[column.name].inner;
      return column;
    });
  };

  var parsePadding = function(value) {
    return parseInt(value) >= 0 ? parseInt(value) : 0;
  };

  me.fixedHeight = function() {
    return options.rows.max != null;
  }

  me.fitRows = function() {
    if (me.fixedHeight())
      return;

    measurer.calculate(measuresCell);

    var rows = options.rows.min !== null ? options.rows.min : 0;
    var headerHeight = header !== null && header.offsetHeight > 0 ? header.offsetHeight : 0;
    var footerHeight = footer !== null && footer.offsetHeight > 0 ? footer.offsetHeight : 0;

    if (pagedTable.offsetHeight > 0) {
      var availableHeight = pagedTable.offsetHeight - headerHeight - footerHeight;
      rows = Math.floor((availableHeight) / measurer.measures.height);
    }

    rows = options.rows.min !== null ? Math.max(options.rows.min, rows) : rows;

    page.setRows(rows);
  }

  // The goal of this function is to add as many columns as possible
  // starting from left-to-right, when the right most limit is reached
  // it tries to add columns from the left as well.
  //
  // When startBackwards is true columns are added from right-to-left
  me.fitColumns = function(startBackwards) {
    measurer.calculate(measuresCell);
    columns.calculateWidths(measurer.measures);

    if (tableDiv.clientWidth > 0) {
      tableDiv.style.opacity = 1;
    }

    var visibleColumns = tableDiv.clientWidth <= 0 ? Math.max(columns.min, 1) : 1;
    var columnNumber = columns.number;
    var paddingCount = 0;

    // track a list of added columns as we build the visible ones to allow us
    // to remove columns when they don't fit anymore.
    var columnHistory = [];

    var lastTableHeight = 0;
    var backwards = startBackwards;

    var tableDivStyle = window.getComputedStyle(tableDiv, null);
    var tableDivPadding = parsePadding(tableDivStyle.paddingLeft) +
      parsePadding(tableDivStyle.paddingRight);

    var addPaddingCol = false;
    var currentWidth = 0;

    while (true) {
      columns.setVisibleColumns(columnNumber, visibleColumns, paddingCount);
      currentWidth = columns.getWidth();

      if (tableDiv.clientWidth - tableDivPadding < currentWidth) {
        break;
      }

      columnHistory.push({
        columnNumber: columnNumber,
        visibleColumns: visibleColumns,
        paddingCount: paddingCount
      });

      if (columnHistory.length > 100) {
        console.error("More than 100 tries to fit columns, aborting");
        break;
      }

      if (columns.max !== null &&
        columns.visible + columns.getPaddingCount() >= columns.max) {
        break;
      }

      // if we run out of right-columns
      if (!backwards && columnNumber + columns.visible >= columns.total) {
        // if we started adding right-columns, try adding left-columns
        if (!startBackwards && columnNumber > 0) {
          backwards = true;
        }
        else if (columns.min === null || visibleColumns + columns.getPaddingCount() >= columns.min) {
          break;
        }
        else {
          paddingCount = paddingCount + 1;
        }
      }

      // if we run out of left-columns
      if (backwards && columnNumber == 0) {
        // if we started adding left-columns, try adding right-columns
        if (startBackwards && columnNumber + columns.visible < columns.total) {
          backwards = false;
        }
        else if (columns.min === null || visibleColumns + columns.getPaddingCount() >= columns.min) {
          break;
        }
        else {
          paddingCount = paddingCount + 1;
        }
      }

      // when moving backwards try fitting left columns first
      if (backwards && columnNumber > 0) {
        columnNumber = columnNumber - 1;
      }

      if (columnNumber + visibleColumns < columns.total) {
        visibleColumns = visibleColumns + 1;
      }
    }

    var lastRenderableColumn = {
        columnNumber: columnNumber,
        visibleColumns: visibleColumns,
        paddingCount: paddingCount
    };

    if (columnHistory.length > 0) {
      lastRenderableColumn = columnHistory[columnHistory.length - 1];
    }

    columns.setVisibleColumns(
      lastRenderableColumn.columnNumber,
      lastRenderableColumn.visibleColumns,
      lastRenderableColumn.paddingCount);

    if (pagedTable.offsetWidth > 0) {
      page.setVisiblePages(Math.max(Math.ceil(1.0 * (pagedTable.offsetWidth - 250) / 40), 2));
    }

    registerWidths();
  };

  me.fit = function(startBackwards) {
    me.fitRows();
    me.fitColumns(startBackwards);
  }

  me.render = function() {
    me.fitColumns(false);

    // render header/footer to measure height accurately
    renderHeader();
    renderFooter();

    me.fitRows();
    renderBody();

    // re-render footer to match new rows
    renderFooter();
  }

  var resizeLastWidth = -1;
  var resizeLastHeight = -1;
  var resizeNewWidth = -1;
  var resizeNewHeight = -1;
  var resizePending = false;

  me.resize = function(newWidth, newHeight) {

    function resizeDelayed() {
      resizePending = false;

      if (
        (resizeNewWidth !== resizeLastWidth) ||
        (!me.fixedHeight() && resizeNewHeight !== resizeLastHeight)
      ) {
        resizeLastWidth = resizeNewWidth;
        resizeLastHeight = resizeNewHeight;

        setTimeout(resizeDelayed, 200);
        resizePending = true;
      } else {
        me.render();
        triggerOnChange();

        resizeLastWidth = -1;
        resizeLastHeight = -1;
      }
    }

    resizeNewWidth = newWidth;
    resizeNewHeight = newHeight;

    if (!resizePending) resizeDelayed();
  };
};

var PagedTableDoc;
(function (PagedTableDoc) {
  var allPagedTables = [];

  PagedTableDoc.initAll = function() {
    allPagedTables = [];

    var pagedTables = [].slice.call(document.querySelectorAll('[data-pagedtable="false"],[data-pagedtable=""]'));
    pagedTables.forEach(function(pagedTable, idx) {
      pagedTable.setAttribute("data-pagedtable", "true");
      pagedTable.setAttribute("pagedtable-page", 0);
      pagedTable.setAttribute("class", "pagedtable-wrapper");

      var pagedTableInstance = new PagedTable(pagedTable);
      pagedTableInstance.init();

      allPagedTables.push(pagedTableInstance);
    });
  };

  PagedTableDoc.resizeAll = function() {
    allPagedTables.forEach(function(pagedTable) {
      pagedTable.render();
    });
  };

  window.addEventListener("resize", PagedTableDoc.resizeAll);

  return PagedTableDoc;
})(PagedTableDoc || (PagedTableDoc = {}));

window.onload = function() {
  PagedTableDoc.initAll();
};
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

/* A workaround for https://github.com/jgm/pandoc/issues/4278 */
a.sourceLine {
  pointer-events: auto;
}

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">@font-face{font-family:"Open Sans";font-style:normal;font-weight:400;src:local("Open Sans"),local("OpenSans"),url(data:application/font-woff;base64,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) format("woff")}@font-face{font-family:"Open Sans";font-style:normal;font-weight:700;src:local("Open Sans Bold"),local("OpenSans-Bold"),url(data:application/font-woff;base64,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) format("woff")}*{box-sizing:border-box}body{padding:0;margin:0;font-family:"Open Sans","Helvetica Neue",Helvetica,Arial,sans-serif;font-size:16px;line-height:1.5;color:#606c71}a{color:#1e6bb8;text-decoration:none}a:hover{text-decoration:underline}.page-header{color:#fff;text-align:center;background-color:#159957;background-image:linear-gradient(120deg,#155799,#159957);padding:1.5rem 2rem}.page-header :last-child{margin-bottom:.5rem}@media screen and (max-width:42em){.page-header{padding:1rem 1rem}}.project-name{margin-top:0;margin-bottom:.1rem;font-size:2rem}@media screen and (max-width:42em){.project-name{font-size:1.75rem}}.project-tagline{margin-bottom:2rem;font-weight:400;opacity:.7;font-size:1.5rem}@media screen and (max-width:42em){.project-tagline{font-size:1.2rem}}.project-author,.project-date{font-weight:400;opacity:.7;font-size:1.2rem}@media screen and (max-width:42em){.project-author,.project-date{font-size:1rem}}.main-content,.toc{max-width:64rem;padding:2rem 4rem;margin:0 auto;font-size:1.1rem}.toc{padding-bottom:0}.toc .toc-box{padding:1.5rem;background-color:#f3f6fa;border:solid 1px #dce6f0;border-radius:.3rem}.toc .toc-box .toc-title{margin:0 0 .5rem;text-align:center}.toc .toc-box>ul{margin:0;padding-left:1.5rem}@media screen and (min-width:42em) and (max-width:64em){.toc{padding:2rem 2rem 0}}@media screen and (max-width:42em){.toc{padding:2rem 1rem 0;font-size:1rem}}.main-content :first-child{margin-top:0}@media screen and (min-width:42em) and (max-width:64em){.main-content{padding:2rem}}@media screen and (max-width:42em){.main-content{padding:2rem 1rem;font-size:1rem}}.main-content img{max-width:100%}.main-content h1,.main-content h2,.main-content h3,.main-content h4,.main-content h5,.main-content h6{margin-top:2rem;margin-bottom:1rem;font-weight:400;color:#159957}.main-content p{margin-bottom:1em}.main-content code{padding:2px 4px;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;color:#567482;background-color:#f3f6fa;border-radius:.3rem}.main-content pre{padding:.8rem;margin-top:0;margin-bottom:1rem;font:1rem Consolas,"Liberation Mono",Menlo,Courier,monospace;color:#567482;word-wrap:normal;background-color:#f3f6fa;border:solid 1px #dce6f0;border-radius:.3rem;line-height:1.45;overflow:auto}@media screen and (max-width:42em){.main-content pre{font-size:.9rem}}.main-content pre>code{padding:0;margin:0;color:#567482;word-break:normal;white-space:pre;background:0 0;border:0}@media screen and (max-width:42em){.main-content pre>code{font-size:.9rem}}.main-content pre code,.main-content pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.main-content pre code:after,.main-content pre code:before,.main-content pre tt:after,.main-content pre tt:before{content:normal}.main-content ol,.main-content ul{margin-top:0}.main-content blockquote{padding:0 1rem;margin-left:0;color:#819198;border-left:.3rem solid #dce6f0;font-size:1.2rem}.main-content blockquote>:first-child{margin-top:0}.main-content blockquote>:last-child{margin-bottom:0}@media screen and (max-width:42em){.main-content blockquote{font-size:1.1rem}}.main-content table{width:100%;overflow:auto;word-break:normal;word-break:keep-all;-webkit-overflow-scrolling:touch;border-collapse:collapse;border-spacing:0;margin:1rem 0}.main-content table th{font-weight:700;background-color:#159957;color:#fff}.main-content table td,.main-content table th{padding:.5rem 1rem;border-bottom:1px solid #e9ebec;text-align:left}.main-content table tr:nth-child(odd){background-color:#f2f2f2}.main-content dl{padding:0}.main-content dl dt{padding:0;margin-top:1rem;font-size:1rem;font-weight:700}.main-content dl dd{padding:0;margin-bottom:1rem}.main-content hr{height:2px;padding:0;margin:1rem 0;background-color:#eff0f1;border:0}code span.kw { color: #a71d5d; font-weight: normal; } 
code span.dt { color: #795da3; } 
code span.dv { color: #0086b3; } 
code span.bn { color: #0086b3; } 
code span.fl { color: #0086b3; } 
code span.ch { color: #4070a0; } 
code span.st { color: #183691; } 
code span.co { color: #969896; font-style: italic; } 
code span.ot { color: #007020; } 
</style>





</head>

<body>




<section class="page-header">
<h1 class="title toc-ignore project-name">GLM optimization</h1>
<h4 class="author project-author">AKROUT Leyth, BOULAHFA Jawad, DE SANTIAGO Kylliann</h4>
<h4 class="date project-date">22 février 2021</h4>
</section>


<div id="TOC" class="toc">
<div class="toc-box">
<ul>
<li><a href="#chargement-et-réorganisation-des-données">Chargement et réorganisation des données</a></li>
<li><a href="#création-de-la-base-trainvalidation">Création de la base train/validation</a></li>
<li><a href="#test-sur-les-lois">Test sur les lois</a></li>
<li><a href="#modèles-simples-glm-loi-gamma-et-inverse.gaussian">Modèles simples : GLM : loi Gamma et inverse.gaussian</a><ul>
<li><a href="#reactivity">Reactivity</a><ul>
<li><a href="#loi-gamma">Loi Gamma</a></li>
<li><a href="#inverse.gaussian">Inverse.gaussian</a></li>
<li><a href="#récapitulatif-des-résultats">Récapitulatif des résultats</a></li>
</ul></li>
<li><a href="#deg_mg_ph10">deg_Mg_pH10</a><ul>
<li><a href="#loi-gamma-1">Loi Gamma</a></li>
<li><a href="#inverse.gaussian-1">Inverse.gaussian</a></li>
<li><a href="#récapitulatif-des-résultats-1">Récapitulatif des résultats</a></li>
</ul></li>
<li><a href="#deg_ph10">deg_pH10</a><ul>
<li><a href="#loi-gamma-2">Loi Gamma</a></li>
<li><a href="#inverse.gaussian-2">Inverse.gaussian</a></li>
<li><a href="#récapitulatif-des-résultats-2">Récapitulatif des résultats</a></li>
</ul></li>
<li><a href="#deg_mg_50c">deg_Mg_50C</a><ul>
<li><a href="#loi-gamma-3">Loi Gamma</a></li>
<li><a href="#inverse.gaussian-3">Inverse.gaussian</a></li>
<li><a href="#récapitulatif-des-résultats-3">Récapitulatif des résultats</a></li>
</ul></li>
<li><a href="#deg_50c">deg_50C</a><ul>
<li><a href="#loi-gamma-4">Loi Gamma</a></li>
<li><a href="#inverse.gaussian-4">Inverse.gaussian</a></li>
<li><a href="#récapitulatif-des-résultats-4">Récapitulatif des résultats</a></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>

<section class="main-content">
<div id="chargement-et-réorganisation-des-données" class="section level1">
<h1>Chargement et réorganisation des données</h1>
<p>Chargement du jeu de données.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># data = read.csv(&quot;~/suivi-du-data-camp-DeSantiago_Boulahfa_Akrout/code/data_train.csv&quot;)</span></a>
<a class="sourceLine" id="cb1-2" title="2">data =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data_train.csv&quot;</span>)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">head</span>(data)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["X"],"name":[1],"type":["int"],"align":["right"]},{"label":["id"],"name":[2],"type":["fct"],"align":["left"]},{"label":["sequence"],"name":[3],"type":["fct"],"align":["left"]},{"label":["index_sequence"],"name":[4],"type":["int"],"align":["right"]},{"label":["seq_be"],"name":[5],"type":["fct"],"align":["left"]},{"label":["seq_af"],"name":[6],"type":["fct"],"align":["left"]},{"label":["structure"],"name":[7],"type":["fct"],"align":["left"]},{"label":["struct_be"],"name":[8],"type":["fct"],"align":["left"]},{"label":["struct_af"],"name":[9],"type":["fct"],"align":["left"]},{"label":["predicted_loop_type"],"name":[10],"type":["fct"],"align":["left"]},{"label":["loop_type_be"],"name":[11],"type":["fct"],"align":["left"]},{"label":["loop_type_af"],"name":[12],"type":["fct"],"align":["left"]},{"label":["signal_to_noise"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["SN_filter"],"name":[14],"type":["int"],"align":["right"]},{"label":["reactivity"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["deg_Mg_pH10"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["deg_pH10"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["deg_Mg_50C"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["deg_50C"],"name":[19],"type":["dbl"],"align":["right"]}],"data":[{"1":"0","2":"id_001f94081_0","3":"G","4":"1","5":"O","6":"G","7":".","8":"O","9":".","10":"E","11":"O","12":"E","13":"6.894","14":"1","15":"0.3297","16":"0.7556","17":"2.3375","18":"0.3581","19":"0.6382","_rn_":"1"},{"1":"1","2":"id_001f94081_1","3":"G","4":"2","5":"G","6":"A","7":".","8":".","9":".","10":"E","11":"E","12":"E","13":"6.894","14":"1","15":"1.5693","16":"2.9830","17":"3.5060","18":"2.9683","19":"3.4773","_rn_":"2"},{"1":"2","2":"id_001f94081_2","3":"A","4":"3","5":"G","6":"A","7":".","8":".","9":".","10":"E","11":"E","12":"E","13":"6.894","14":"1","15":"1.1227","16":"0.2526","17":"0.3008","18":"0.2589","19":"0.9988","_rn_":"3"},{"1":"3","2":"id_001f94081_3","3":"A","4":"4","5":"A","6":"A","7":".","8":".","9":".","10":"E","11":"E","12":"E","13":"6.894","14":"1","15":"0.8686","16":"1.3789","17":"1.0108","18":"1.4552","19":"1.3228","_rn_":"4"},{"1":"4","2":"id_001f94081_4","3":"A","4":"5","5":"A","6":"A","7":".","8":".","9":"(","10":"E","11":"E","12":"S","13":"6.894","14":"1","15":"0.7217","16":"0.6376","17":"0.2635","18":"0.7244","19":"0.7877","_rn_":"5"},{"1":"5","2":"id_001f94081_5","3":"A","4":"6","5":"A","6":"G","7":"(","8":".","9":"(","10":"S","11":"E","12":"S","13":"6.894","14":"1","15":"0.4384","16":"0.3313","17":"0.3403","18":"0.4971","19":"0.5890","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">data=data[,<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">head</span>(data)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["id"],"name":[1],"type":["fct"],"align":["left"]},{"label":["sequence"],"name":[2],"type":["fct"],"align":["left"]},{"label":["index_sequence"],"name":[3],"type":["int"],"align":["right"]},{"label":["seq_be"],"name":[4],"type":["fct"],"align":["left"]},{"label":["seq_af"],"name":[5],"type":["fct"],"align":["left"]},{"label":["structure"],"name":[6],"type":["fct"],"align":["left"]},{"label":["struct_be"],"name":[7],"type":["fct"],"align":["left"]},{"label":["struct_af"],"name":[8],"type":["fct"],"align":["left"]},{"label":["predicted_loop_type"],"name":[9],"type":["fct"],"align":["left"]},{"label":["loop_type_be"],"name":[10],"type":["fct"],"align":["left"]},{"label":["loop_type_af"],"name":[11],"type":["fct"],"align":["left"]},{"label":["signal_to_noise"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["SN_filter"],"name":[13],"type":["int"],"align":["right"]},{"label":["reactivity"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["deg_Mg_pH10"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["deg_pH10"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["deg_Mg_50C"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["deg_50C"],"name":[18],"type":["dbl"],"align":["right"]}],"data":[{"1":"id_001f94081_0","2":"G","3":"1","4":"O","5":"G","6":".","7":"O","8":".","9":"E","10":"O","11":"E","12":"6.894","13":"1","14":"0.3297","15":"0.7556","16":"2.3375","17":"0.3581","18":"0.6382","_rn_":"1"},{"1":"id_001f94081_1","2":"G","3":"2","4":"G","5":"A","6":".","7":".","8":".","9":"E","10":"E","11":"E","12":"6.894","13":"1","14":"1.5693","15":"2.9830","16":"3.5060","17":"2.9683","18":"3.4773","_rn_":"2"},{"1":"id_001f94081_2","2":"A","3":"3","4":"G","5":"A","6":".","7":".","8":".","9":"E","10":"E","11":"E","12":"6.894","13":"1","14":"1.1227","15":"0.2526","16":"0.3008","17":"0.2589","18":"0.9988","_rn_":"3"},{"1":"id_001f94081_3","2":"A","3":"4","4":"A","5":"A","6":".","7":".","8":".","9":"E","10":"E","11":"E","12":"6.894","13":"1","14":"0.8686","15":"1.3789","16":"1.0108","17":"1.4552","18":"1.3228","_rn_":"4"},{"1":"id_001f94081_4","2":"A","3":"5","4":"A","5":"A","6":".","7":".","8":"(","9":"E","10":"E","11":"S","12":"6.894","13":"1","14":"0.7217","15":"0.6376","16":"0.2635","17":"0.7244","18":"0.7877","_rn_":"5"},{"1":"id_001f94081_5","2":"A","3":"6","4":"A","5":"G","6":"(","7":".","8":"(","9":"S","10":"E","11":"S","12":"6.894","13":"1","14":"0.4384","15":"0.3313","16":"0.3403","17":"0.4971","18":"0.5890","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>On change les types des variables qui sont mal codées.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">data=data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">sequence =</span> <span class="kw">as.factor</span>(sequence)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">seq_be =</span> <span class="kw">as.factor</span>(seq_be)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">seq_af =</span> <span class="kw">as.factor</span>(seq_af)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sequence =</span> <span class="kw">as.factor</span>(sequence)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">structure =</span> <span class="kw">as.factor</span>(structure)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">struct_be =</span> <span class="kw">as.factor</span>(struct_be)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">struct_af =</span> <span class="kw">as.factor</span>(struct_af)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">predicted_loop_type =</span> <span class="kw">as.factor</span>(predicted_loop_type)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">loop_type_be =</span> <span class="kw">as.factor</span>(loop_type_be)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">loop_type_af =</span> <span class="kw">as.factor</span>(loop_type_af)) </a></code></pre></div>
<p>On filtre maintenant les données qui ont SN_filter=0.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">print</span>(<span class="kw">sum</span>(<span class="kw">is.na</span>(data)))</a></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">print</span>(<span class="kw">sum</span>(data<span class="op">$</span>SN_filter<span class="op">==</span><span class="dv">0</span>)<span class="op">/</span><span class="dv">68</span>) <span class="co"># Nombre d&#39;individus dont le SN_filter=0</span></a></code></pre></div>
<pre><code>## [1] 811</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">data=data[data<span class="op">$</span>SN_filter<span class="op">==</span><span class="dv">1</span>,]</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">rownames</span>(data)=NULL<span class="co">#1:108052</span></a></code></pre></div>
<p>Mise à 0 des valeurs négatives.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co">#p=dim(data)[2]</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co">#sum(data[,(p-4):p]&lt;0) # nb de lignes où il existe des labels qui ont des valeurs négatives</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">#for (i in (p-4):p)</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">#{</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co">#  data[which(data[,i]&lt;0),i]=0</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="co">#}</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="co">#sum(data[,(p-4):p]&lt;0)</span></a></code></pre></div>
<p>Plutôt que mettre à 0 les valeurs négatives, on va effectuer une translation sur chaque label en soustrayant chacune de ses valeurs par la valeur minimale du label puis en ajoutant un bruit afin de se placer sur <span class="math inline">\(\mathbb{R}_+^*\)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">p =<span class="st"> </span><span class="kw">dim</span>(data)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb10-2" title="2">bruit =<span class="st"> </span><span class="fl">1e-12</span></a></code></pre></div>
<p>Initialement, il existe des valeurs négatives pour nos labels.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">sum</span>(data[,(p<span class="dv">-4</span>)<span class="op">:</span>p] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="co"># nb total de lignes où il existe des labels qui ont des valeurs négatives</span></a></code></pre></div>
<pre><code>## [1] 23008</code></pre>
<p>On peut aussi afficher le nombre de lignes où il y a des valeurs négatives pour chacun de nos labels. On peut remarquer que chaque label en possède.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">sum</span>(data<span class="op">$</span>reactivity <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] 7070</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">sum</span>(data<span class="op">$</span>deg_50C <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] 5512</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">sum</span>(data<span class="op">$</span>deg_Mg_50C <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] 4495</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">sum</span>(data<span class="op">$</span>deg_pH10 <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] 3937</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">sum</span>(data<span class="op">$</span>deg_Mg_pH10 <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] 1994</code></pre>
<p>On effectue une translation pour se placer sur <span class="math inline">\(\mathbb{R}_+^*\)</span>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="cf">for</span> (i <span class="cf">in</span> (p<span class="dv">-4</span>)<span class="op">:</span>p)</a>
<a class="sourceLine" id="cb23-2" title="2">{</a>
<a class="sourceLine" id="cb23-3" title="3">  data[,i] &lt;-<span class="st"> </span>data[,i] <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(data[,i]) <span class="op">+</span><span class="st"> </span>bruit <span class="co"># l&#39;ajout du bruit permet d&#39;éliminer les 0.</span></a>
<a class="sourceLine" id="cb23-4" title="4">}</a></code></pre></div>
<p>On a bien retiré toutes les valeurs négatives.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">sum</span>(data[,(p<span class="dv">-4</span>)<span class="op">:</span>p] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="co"># Il n&#39;y a plus aucune valeur négative</span></a></code></pre></div>
<pre><code>## [1] 0</code></pre>
</div>
<div id="création-de-la-base-trainvalidation" class="section level1">
<h1>Création de la base train/validation</h1>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">tamp=<span class="kw">train_test_split</span>(data)</a>
<a class="sourceLine" id="cb26-2" title="2">data_train=tamp<span class="op">$</span>train</a>
<a class="sourceLine" id="cb26-3" title="3">data_val=tamp<span class="op">$</span>val</a></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">sum</span>(<span class="kw">is.na</span>(data_train))</a></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">sum</span>(<span class="kw">is.na</span>(data_val))</a></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">dim</span>(data_train)[<span class="dv">1</span>]<span class="op">+</span><span class="kw">dim</span>(data_val)[<span class="dv">1</span>]<span class="op">-</span><span class="kw">dim</span>(data)[<span class="dv">1</span>]</a></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="co">#rm(tamp,data)</span></a></code></pre></div>
</div>
<div id="test-sur-les-lois" class="section level1">
<h1>Test sur les lois</h1>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">M=<span class="kw">mean</span>(data_train<span class="op">$</span>reactivity,<span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb34-2" title="2">S=<span class="kw">var</span>(data_train<span class="op">$</span>reactivity,<span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb34-3" title="3"><span class="kw">print</span>(M)</a></code></pre></div>
<pre><code>## [1] 0.7637478</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="kw">print</span>(S)</a></code></pre></div>
<pre><code>## [1] 0.2063177</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw">ks.test</span>(data_train<span class="op">$</span>reactivity,<span class="st">&quot;pexp&quot;</span>,<span class="dv">1</span><span class="op">/</span>M)</a></code></pre></div>
<pre><code>## Warning in ks.test(data_train$reactivity, &quot;pexp&quot;, 1/M): ties should not be
## present for the Kolmogorov-Smirnov test</code></pre>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  data_train$reactivity
## D = 0.37201, p-value &lt; 2.2e-16
## alternative hypothesis: two-sided</code></pre>
<p>Problème ici.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">alpha_LoiGamma=(M<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(S<span class="op">-</span>M<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb41-2" title="2">beta_LoiGamma=(S<span class="op">-</span>M<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>M</a>
<a class="sourceLine" id="cb41-3" title="3"><span class="kw">ks.test</span>(data_train<span class="op">$</span>reactivity,<span class="st">&quot;pgamma&quot;</span>,alpha_LoiGamma,beta_LoiGamma)</a></code></pre></div>
<pre><code>## Warning in ks.test(data_train$reactivity, &quot;pgamma&quot;, alpha_LoiGamma,
## beta_LoiGamma): ties should not be present for the Kolmogorov-Smirnov test</code></pre>
<pre><code>## Warning in y(sort(x), ...): production de NaN</code></pre>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  data_train$reactivity
## D = NaN, p-value = NA
## alternative hypothesis: two-sided</code></pre>
</div>
<div id="modèles-simples-glm-loi-gamma-et-inverse.gaussian" class="section level1">
<h1>Modèles simples : GLM : loi Gamma et inverse.gaussian</h1>
<p>Initialisation de vecteurs pour stocker nos résultats.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">models_reactivity &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb45-2" title="2">errors_reactivity_train &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb45-3" title="3">errors_reactivity_val &lt;-<span class="st"> </span><span class="kw">c</span>()</a></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">models_deg_Mg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb46-2" title="2">errors_deg_Mg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb46-3" title="3">errors_deg_Mg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>()</a></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1">models_deg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb47-2" title="2">errors_deg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb47-3" title="3">errors_deg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>()</a></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1">models_deg_Mg_50C &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb48-2" title="2">errors_deg_Mg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb48-3" title="3">errors_deg_Mg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>()</a></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">models_deg_50C &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb49-2" title="2">errors_deg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb49-3" title="3">errors_deg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>()</a></code></pre></div>
<div id="reactivity" class="section level2">
<h2>Reactivity</h2>
<div id="loi-gamma" class="section level3">
<h3>Loi Gamma</h3>
<p>Ici on fera énormément de tests pour essayer de voir quels variables apportent des informations utiles.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(reactivity<span class="op">~</span>sequence, <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb50-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb50-3" title="3"></a>
<a class="sourceLine" id="cb50-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb50-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1877767</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb52-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1943097</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">model=<span class="kw">glm</span>(reactivity<span class="op">~</span>(sequence<span class="op">+</span>seq_be<span class="op">+</span>seq_af),<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb54-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb54-3" title="3"></a>
<a class="sourceLine" id="cb54-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb54-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1518317</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb56-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1546658</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1">model=<span class="kw">glm</span>(reactivity<span class="op">~</span>sequence<span class="op">+</span>index_sequence,<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb58-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb58-3" title="3"></a>
<a class="sourceLine" id="cb58-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb58-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1764709</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb60-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1813932</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1">model=<span class="kw">glm</span>(reactivity<span class="op">~</span>sequence<span class="op">+</span>predicted_loop_type<span class="op">+</span>index_sequence,<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb62-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb62-3" title="3">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb62-4" title="4"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1372949</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb64-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1443621</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">model=<span class="kw">glm</span>(reactivity<span class="op">~</span>sequence<span class="op">+</span>structure<span class="op">+</span>index_sequence,<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb66-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb66-3" title="3"></a>
<a class="sourceLine" id="cb66-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb66-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1467982</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb68-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1408403</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(reactivity  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span></a>
<a class="sourceLine" id="cb70-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb70-3" title="3">                       <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb70-4" title="4"></a>
<a class="sourceLine" id="cb70-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb70-6" title="6"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1366397</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb72-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1335081</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(reactivity  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span></a>
<a class="sourceLine" id="cb74-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb74-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb74-4" title="4"></a>
<a class="sourceLine" id="cb74-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb74-6" title="6"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1152924</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb76-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1122223</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(reactivity  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span></a>
<a class="sourceLine" id="cb78-2" title="2"><span class="st">              </span>seq_be <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span><span class="st"> </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb78-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb78-4" title="4"></a>
<a class="sourceLine" id="cb78-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1137812</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1112648</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(reactivity  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span></a>
<a class="sourceLine" id="cb86-2" title="2"><span class="st">              </span>seq_be <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span><span class="st"> </span>index_sequence <span class="op">+</span><span class="st"> </span>structure <span class="op">+</span></a>
<a class="sourceLine" id="cb86-3" title="3"><span class="st">              </span>predicted_loop_type,</a>
<a class="sourceLine" id="cb86-4" title="4">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb86-5" title="5"></a>
<a class="sourceLine" id="cb86-6" title="6">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1133965</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1085452</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(reactivity  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span></a>
<a class="sourceLine" id="cb94-2" title="2"><span class="st">              </span>seq_be <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span><span class="st"> </span>index_sequence <span class="op">+</span><span class="st"> </span>structure <span class="op">+</span></a>
<a class="sourceLine" id="cb94-3" title="3"><span class="st">              </span>predicted_loop_type <span class="op">+</span><span class="st"> </span>loop_type_be,</a>
<a class="sourceLine" id="cb94-4" title="4">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb94-5" title="5"></a>
<a class="sourceLine" id="cb94-6" title="6">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1131154</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1083464</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(reactivity  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span></a>
<a class="sourceLine" id="cb102-2" title="2"><span class="st">              </span>seq_be <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span><span class="st"> </span>index_sequence <span class="op">+</span><span class="st"> </span>structure <span class="op">+</span></a>
<a class="sourceLine" id="cb102-3" title="3"><span class="st">              </span>predicted_loop_type <span class="op">+</span><span class="st"> </span>loop_type_af,</a>
<a class="sourceLine" id="cb102-4" title="4">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb102-5" title="5"></a>
<a class="sourceLine" id="cb102-6" title="6">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1135613</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1084381</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(reactivity  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span></a>
<a class="sourceLine" id="cb110-2" title="2"><span class="st">              </span>seq_be <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span><span class="st"> </span>index_sequence <span class="op">+</span><span class="st"> </span>structure <span class="op">+</span></a>
<a class="sourceLine" id="cb110-3" title="3"><span class="st">              </span>predicted_loop_type <span class="op">+</span><span class="st"> </span>loop_type_be <span class="op">+</span><span class="st"> </span>loop_type_af,</a>
<a class="sourceLine" id="cb110-4" title="4">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb110-5" title="5"></a>
<a class="sourceLine" id="cb110-6" title="6">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1132704</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1082247</code></pre>
<div id="optimisation" class="section level4">
<h4>Optimisation</h4>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1">formula_gamma_reactivity =</a>
<a class="sourceLine" id="cb118-2" title="2"><span class="st">  &quot;reactivity  ~ sequence + seq_be + seq_af + index_sequence + structure&quot;</span></a></code></pre></div>
<p>On stocke le meilleur modèle pour la loi gamma.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1">model_gamma_reactivity =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_gamma_reactivity,</a>
<a class="sourceLine" id="cb119-2" title="2">                             <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a></code></pre></div>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1"><span class="kw">summary</span>(model_gamma_reactivity)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = formula_gamma_reactivity, family = Gamma, data = data_train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -7.2939  -0.2616  -0.0838   0.1391   3.8483  
## 
## Coefficients:
##                  Estimate Std. Error  t value Pr(&gt;|t|)    
## (Intercept)     1.400e+00  6.548e-03  213.764  &lt; 2e-16 ***
## sequenceC       3.865e-01  6.189e-03   62.454  &lt; 2e-16 ***
## sequenceG       1.808e-03  4.016e-03    0.450    0.653    
## sequenceU      -2.757e-02  4.987e-03   -5.528 3.25e-08 ***
## seq_beC         3.867e-02  4.957e-03    7.800 6.27e-15 ***
## seq_beG        -7.474e-02  3.930e-03  -19.020  &lt; 2e-16 ***
## seq_beO        -1.896e-01  1.294e-02  -14.650  &lt; 2e-16 ***
## seq_beU        -8.861e-02  5.058e-03  -17.520  &lt; 2e-16 ***
## seq_afC         4.638e-01  5.610e-03   82.673  &lt; 2e-16 ***
## seq_afG         4.803e-01  5.142e-03   93.414  &lt; 2e-16 ***
## seq_afO         2.400e-01  1.605e-02   14.951  &lt; 2e-16 ***
## seq_afU        -6.994e-02  4.352e-03  -16.070  &lt; 2e-16 ***
## index_sequence  4.853e-03  9.014e-05   53.841  &lt; 2e-16 ***
## structure)     -4.803e-02  6.796e-03   -7.068 1.58e-12 ***
## structure.     -6.662e-01  5.304e-03 -125.615  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.1481723)
## 
##     Null deviance: 22593  on 86427  degrees of freedom
## Residual deviance: 10528  on 86413  degrees of freedom
## AIC: -4075.5
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1">y_pred_gamma_train =<span class="st"> </span><span class="kw">predict.glm</span>(model_gamma_reactivity,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb122-2" title="2">error_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_gamma_train<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb122-3" title="3"><span class="kw">print</span>(error_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1122223</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1">y_pred_gamma_val=<span class="kw">predict.glm</span>(model_gamma_reactivity,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb124-2" title="2">error_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_gamma_val<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb124-3" title="3"><span class="kw">print</span>(error_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1152924</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1">models_reactivity &lt;-<span class="st"> </span><span class="kw">c</span>(models_reactivity, <span class="st">&quot;model_gamma&quot;</span>)</a>
<a class="sourceLine" id="cb126-2" title="2">errors_reactivity_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_reactivity_train, error_gamma_train)</a>
<a class="sourceLine" id="cb126-3" title="3">errors_reactivity_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_reactivity_val, error_gamma_val)</a>
<a class="sourceLine" id="cb126-4" title="4"><span class="kw">rm</span>(error_gamma_val, error_gamma_train, y_pred_gamma_train, y_pred_gamma_val)</a></code></pre></div>
<div id="stepaic" class="section level5">
<h5>StepAIC</h5>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1">model_gamma_reactivity_aic =<span class="st"> </span><span class="kw">stepAIC</span>(model_gamma_reactivity, <span class="dt">trace =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>Pas de changement du modèle. Cela est sûrement dû au fait qu’on n’a pas assez de variables initialement.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1"><span class="kw">summary</span>(model_gamma_reactivity_aic)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = reactivity ~ sequence + seq_be + seq_af + index_sequence + 
##     structure, family = Gamma, data = data_train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -7.2939  -0.2616  -0.0838   0.1391   3.8483  
## 
## Coefficients:
##                  Estimate Std. Error  t value Pr(&gt;|t|)    
## (Intercept)     1.400e+00  6.548e-03  213.764  &lt; 2e-16 ***
## sequenceC       3.865e-01  6.189e-03   62.454  &lt; 2e-16 ***
## sequenceG       1.808e-03  4.016e-03    0.450    0.653    
## sequenceU      -2.757e-02  4.987e-03   -5.528 3.25e-08 ***
## seq_beC         3.867e-02  4.957e-03    7.800 6.27e-15 ***
## seq_beG        -7.474e-02  3.930e-03  -19.020  &lt; 2e-16 ***
## seq_beO        -1.896e-01  1.294e-02  -14.650  &lt; 2e-16 ***
## seq_beU        -8.861e-02  5.058e-03  -17.520  &lt; 2e-16 ***
## seq_afC         4.638e-01  5.610e-03   82.673  &lt; 2e-16 ***
## seq_afG         4.803e-01  5.142e-03   93.414  &lt; 2e-16 ***
## seq_afO         2.400e-01  1.605e-02   14.951  &lt; 2e-16 ***
## seq_afU        -6.994e-02  4.352e-03  -16.070  &lt; 2e-16 ***
## index_sequence  4.853e-03  9.014e-05   53.841  &lt; 2e-16 ***
## structure)     -4.803e-02  6.796e-03   -7.068 1.58e-12 ***
## structure.     -6.662e-01  5.304e-03 -125.615  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.1481723)
## 
##     Null deviance: 22593  on 86427  degrees of freedom
## Residual deviance: 10528  on 86413  degrees of freedom
## AIC: -4075.5
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Pas de changement sur les performances de prédiction.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1">y_pred_gamma_train_aic =<span class="st"> </span><span class="kw">predict.glm</span>(model_gamma_reactivity_aic,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb130-2" title="2"><span class="kw">mean</span>((y_pred_gamma_train_aic<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1122223</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1">y_pred_gamma_val_aic=<span class="kw">predict.glm</span>(model_gamma_reactivity_aic,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb132-2" title="2"><span class="kw">mean</span>((y_pred_gamma_val_aic<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1152924</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1"><span class="kw">rm</span>(model_gamma_reactivity_aic, y_pred_gamma_train_aic, y_pred_gamma_val_aic)</a></code></pre></div>
<p>On va maintenant tester des pénalisations ridge, lasso et elastic-net.</p>
</div>
<div id="pénalisation-ridge-et-lasso" class="section level5">
<h5>Pénalisation ridge et lasso</h5>
<p>On commence par calculer la matrice de design du model_gamma_reactivity sur le train et le test.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1"><span class="co"># Matrice de design du train</span></a>
<a class="sourceLine" id="cb135-2" title="2">data_train_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_gamma_reactivity)</a>
<a class="sourceLine" id="cb135-3" title="3"><span class="co">#head(data_train_pen)</span></a></code></pre></div>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1"><span class="co"># Pour faire la matrice de design de la validation</span></a>
<a class="sourceLine" id="cb136-2" title="2">model_gamma_reactivity_val =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_gamma_reactivity,</a>
<a class="sourceLine" id="cb136-3" title="3">                                 <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_val)</a>
<a class="sourceLine" id="cb136-4" title="4">data_val_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_gamma_reactivity_val)</a>
<a class="sourceLine" id="cb136-5" title="5"><span class="co">#head(data_val_pen)</span></a>
<a class="sourceLine" id="cb136-6" title="6"></a>
<a class="sourceLine" id="cb136-7" title="7"><span class="co"># On supprime le modèle sur le test</span></a>
<a class="sourceLine" id="cb136-8" title="8"><span class="kw">rm</span>(model_gamma_reactivity_val)</a></code></pre></div>
<p>On pénalise le model_gamma_reactivity avec une pénalité ridge. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1"><span class="co">#model_gamma_reactivity_pen_ridge = cv.glmnet(data_train_pen, data_train$reactivity,</span></a>
<a class="sourceLine" id="cb137-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb137-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 0)</span></a>
<a class="sourceLine" id="cb137-4" title="4"><span class="co">## lambda.min est le lambda qui minimise l&#39;erreur de cross validation</span></a>
<a class="sourceLine" id="cb137-5" title="5"><span class="co">#coef(model_gamma_reactivity_pen_ridge, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" title="1"><span class="co">#saveRDS(model_gamma_reactivity_pen_ridge, &quot;model_gamma_reactivity_pen_ridge.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1">model_gamma_reactivity_pen_ridge &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_reactivity_pen_ridge.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation ridge.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" title="1">y_pred_ridge_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_reactivity_pen_ridge, data_train_pen,</a>
<a class="sourceLine" id="cb140-2" title="2">                                   <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb140-3" title="3">y_pred_ridge_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_reactivity_pen_ridge, data_val_pen,</a>
<a class="sourceLine" id="cb140-4" title="4">                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb140-5" title="5">error_ridge_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_ridge_gamma_train<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb140-6" title="6"><span class="kw">print</span>(error_ridge_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1443514</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" title="1">error_ridge_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_ridge_gamma_val<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb142-2" title="2"><span class="kw">print</span>(error_ridge_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1494319</code></pre>
<p>On pénalise le model_gamma_reactivity avec une pénalité lasso. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" title="1"><span class="co">#model_gamma_reactivity_pen_lasso = cv.glmnet(data_train_pen, data_train$reactivity,</span></a>
<a class="sourceLine" id="cb144-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb144-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 1)</span></a>
<a class="sourceLine" id="cb144-4" title="4"><span class="co">#coef(model_gamma_reactivity_pen_lasso, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" title="1"><span class="co">#saveRDS(model_gamma_reactivity_pen_lasso, &quot;model_gamma_reactivity_pen_lasso.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" title="1">model_gamma_reactivity_pen_lasso &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_reactivity_pen_lasso.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation lasso.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" title="1">y_pred_lasso_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_reactivity_pen_lasso, data_train_pen,</a>
<a class="sourceLine" id="cb147-2" title="2">                                   <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb147-3" title="3">error_lasso_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_lasso_gamma_train<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb147-4" title="4"><span class="kw">print</span>(error_lasso_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1122858</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" title="1">y_pred_lasso_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_reactivity_pen_lasso, data_val_pen,</a>
<a class="sourceLine" id="cb149-2" title="2">                                 <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb149-3" title="3">error_lasso_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_lasso_gamma_val<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb149-4" title="4"><span class="kw">print</span>(error_lasso_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1152241</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" title="1">models_reactivity &lt;-<span class="st"> </span><span class="kw">c</span>(models_reactivity, <span class="st">&quot;model_gamma_ridge&quot;</span>, <span class="st">&quot;model_gamma_lasso&quot;</span>)</a>
<a class="sourceLine" id="cb151-2" title="2">errors_reactivity_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_reactivity_train, error_ridge_gamma_train,</a>
<a class="sourceLine" id="cb151-3" title="3">                             error_lasso_gamma_train)</a>
<a class="sourceLine" id="cb151-4" title="4">errors_reactivity_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_reactivity_val, error_ridge_gamma_val, error_lasso_gamma_val)</a>
<a class="sourceLine" id="cb151-5" title="5"><span class="kw">rm</span>(error_ridge_gamma_val, error_lasso_gamma_val,</a>
<a class="sourceLine" id="cb151-6" title="6">   error_ridge_gamma_train, error_lasso_gamma_train,</a>
<a class="sourceLine" id="cb151-7" title="7">   y_pred_ridge_gamma_train, y_pred_ridge_gamma_val,</a>
<a class="sourceLine" id="cb151-8" title="8">   y_pred_lasso_gamma_train, y_pred_lasso_gamma_val)</a></code></pre></div>
</div>
<div id="pénalisation-elastic-net" class="section level5">
<h5>Pénalisation elastic-net</h5>
<p>On choisit <span class="math inline">\(\alpha\)</span> qui minimise le MSE sur la validation.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" title="1"><span class="co">#alpha_opti_enet_gamma_reactivity =</span></a>
<a class="sourceLine" id="cb152-2" title="2"><span class="co">#  alpha_opti_enet(data_train = data_train_pen, data_val = data_val_pen,</span></a>
<a class="sourceLine" id="cb152-3" title="3"><span class="co">#                  y_true_train = data_train$reactivity,</span></a>
<a class="sourceLine" id="cb152-4" title="4"><span class="co">#                  y_true_val = data_val$reactivity,</span></a>
<a class="sourceLine" id="cb152-5" title="5"><span class="co">#                  family = Gamma, cores = detectCores() - 2)</span></a></code></pre></div>
<p>Au final, le meilleur modèle est le lasso.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" title="1"><span class="co">#print(alpha_opti_enet_gamma_reactivity)</span></a></code></pre></div>
<p>On construit le modèle avec le choix optimal pour <span class="math inline">\(\alpha\)</span>.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" title="1"><span class="co">#model_gamma_reactivity_pen_enet = cv.glmnet(data_train_pen, data_train$reactivity,</span></a>
<a class="sourceLine" id="cb154-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb154-3" title="3"><span class="co">#                                             standardize = FALSE,</span></a>
<a class="sourceLine" id="cb154-4" title="4"><span class="co">#                                             alpha = alpha_opti_enet_gamma_reactivity)</span></a>
<a class="sourceLine" id="cb154-5" title="5"><span class="co">#coef(model_gamma_reactivity_pen_enet, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" title="1"><span class="co">#saveRDS(model_gamma_reactivity_pen_enet, &quot;model_gamma_reactivity_pen_enet.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" title="1">model_gamma_reactivity_pen_enet &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_reactivity_pen_enet.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation elastic-net.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" title="1">y_pred_enet_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_reactivity_pen_enet, data_train_pen,</a>
<a class="sourceLine" id="cb157-2" title="2">                                   <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb157-3" title="3">error_enet_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_enet_gamma_train <span class="op">-</span><span class="st"> </span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb157-4" title="4"><span class="kw">print</span>(error_enet_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1122858</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" title="1">y_pred_enet_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_reactivity_pen_enet, data_val_pen,</a>
<a class="sourceLine" id="cb159-2" title="2">                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb159-3" title="3">error_enet_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_enet_gamma_val <span class="op">-</span><span class="st"> </span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb159-4" title="4"><span class="kw">print</span>(error_enet_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1152241</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" title="1">models_reactivity &lt;-<span class="st"> </span><span class="kw">c</span>(models_reactivity, <span class="st">&quot;model_gamma_enet&quot;</span>)</a>
<a class="sourceLine" id="cb161-2" title="2">errors_reactivity_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_reactivity_train, error_enet_gamma_train)</a>
<a class="sourceLine" id="cb161-3" title="3">errors_reactivity_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_reactivity_val, error_enet_gamma_val)</a>
<a class="sourceLine" id="cb161-4" title="4"><span class="kw">rm</span>(error_enet_gamma_train, error_enet_gamma_val,</a>
<a class="sourceLine" id="cb161-5" title="5">   y_pred_enet_gamma_train, y_pred_enet_gamma_val)</a></code></pre></div>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" title="1"><span class="kw">data.frame</span>(models_reactivity, errors_reactivity_train, errors_reactivity_val)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["models_reactivity"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_reactivity_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_reactivity_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma","2":"0.1122223","3":"0.1152924"},{"1":"model_gamma_ridge","2":"0.1443514","3":"0.1494319"},{"1":"model_gamma_lasso","2":"0.1122858","3":"0.1152241"},{"1":"model_gamma_enet","2":"0.1122858","3":"0.1152241"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<div id="inverse.gaussian" class="section level3">
<h3>Inverse.gaussian</h3>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" title="1">model=<span class="kw">glm</span>(reactivity<span class="op">~</span>sequence,<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb163-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb163-3" title="3"></a>
<a class="sourceLine" id="cb163-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb163-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1887423</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb165-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1950117</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" title="1">model=<span class="kw">glm</span>(reactivity<span class="op">~</span>(sequence<span class="op">+</span>seq_be<span class="op">+</span>seq_af),<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb167-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb167-3" title="3"></a>
<a class="sourceLine" id="cb167-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb167-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.161739</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb169-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1618419</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb171-1" title="1">model=<span class="kw">glm</span>(reactivity<span class="op">~</span>sequence<span class="op">+</span>index_sequence,<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb171-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb171-3" title="3"></a>
<a class="sourceLine" id="cb171-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb171-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1897299</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb173-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb173-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1925604</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" title="1">model=<span class="kw">glm</span>(reactivity<span class="op">~</span>sequence<span class="op">+</span>predicted_loop_type,<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb175-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb175-3" title="3">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb175-4" title="4"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1541035</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb177-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1575073</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb179-1" title="1">model=<span class="kw">glm</span>(reactivity<span class="op">~</span>sequence<span class="op">+</span>structure,<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb179-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb179-3" title="3"></a>
<a class="sourceLine" id="cb179-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb179-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1637478</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb181-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1584819</code></pre>
<p>On stocke le meilleur modèle pour l’inverse gaussian.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" title="1">model=<span class="kw">glm</span>(reactivity<span class="op">~</span>sequence<span class="op">+</span>predicted_loop_type,<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb183-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb183-3" title="3">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb183-4" title="4"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1541035</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb185-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb185-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1575073</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb187-1" title="1"><span class="co">#model = glm(reactivity  ~ sequence + struct_be + struct_af +</span></a>
<a class="sourceLine" id="cb187-2" title="2"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb187-3" title="3"><span class="co">#                       family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb187-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb187-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb187-6" title="6"><span class="co">#mean((y_pred-data_val$reactivity)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb187-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb187-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb187-9" title="9"><span class="co">#mean((y_pred-data_train$reactivity)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb188-1" title="1"><span class="co"># Ne marche pas</span></a>
<a class="sourceLine" id="cb188-2" title="2"><span class="co">#model = glm(reactivity  ~ sequence + seq_be + seq_af +</span></a>
<a class="sourceLine" id="cb188-3" title="3"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb188-4" title="4"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb188-5" title="5"></a>
<a class="sourceLine" id="cb188-6" title="6">model =<span class="st"> </span><span class="kw">glm</span>(reactivity  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span></a>
<a class="sourceLine" id="cb188-7" title="7"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb188-8" title="8">            <span class="dt">family =</span> inverse.gaussian, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb188-9" title="9"></a>
<a class="sourceLine" id="cb188-10" title="10">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb188-11" title="11"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1400279</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb190-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1394548</code></pre>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb192-1" title="1"><span class="co">#model = glm(reactivity  ~ sequence + seq_be + struct_be +</span></a>
<a class="sourceLine" id="cb192-2" title="2"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb192-3" title="3"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb192-4" title="4"></a>
<a class="sourceLine" id="cb192-5" title="5"><span class="co">#model = glm(reactivity  ~ sequence + seq_af + struct_be +</span></a>
<a class="sourceLine" id="cb192-6" title="6"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb192-7" title="7"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb192-8" title="8"></a>
<a class="sourceLine" id="cb192-9" title="9"><span class="co">#model = glm(reactivity  ~ sequence + seq_af + struct_af +</span></a>
<a class="sourceLine" id="cb192-10" title="10"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb192-11" title="11"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb192-12" title="12"></a>
<a class="sourceLine" id="cb192-13" title="13"><span class="co">#model = glm(reactivity  ~ sequence + seq_be + predicted_loop_type +</span></a>
<a class="sourceLine" id="cb192-14" title="14"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb192-15" title="15"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb192-16" title="16"></a>
<a class="sourceLine" id="cb192-17" title="17"><span class="co">#model = glm(reactivity  ~ sequence + seq_af + predicted_loop_type +</span></a>
<a class="sourceLine" id="cb192-18" title="18"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb192-19" title="19"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb192-20" title="20"></a>
<a class="sourceLine" id="cb192-21" title="21"><span class="co">#model = glm(reactivity  ~ sequence + seq_be + seq_af + predicted_loop_type +</span></a>
<a class="sourceLine" id="cb192-22" title="22"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb192-23" title="23"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb192-24" title="24"></a>
<a class="sourceLine" id="cb192-25" title="25"><span class="co">#model = glm(reactivity  ~ sequence + struct_be + predicted_loop_type +</span></a>
<a class="sourceLine" id="cb192-26" title="26"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb192-27" title="27"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb192-28" title="28"></a>
<a class="sourceLine" id="cb192-29" title="29"><span class="co">#model = glm(reactivity  ~ sequence + struct_af + predicted_loop_type +</span></a>
<a class="sourceLine" id="cb192-30" title="30"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb192-31" title="31"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a></code></pre></div>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" title="1"><span class="co">#model = glm(reactivity  ~ sequence + struct_be + struct_af +</span></a>
<a class="sourceLine" id="cb193-2" title="2"><span class="co">#              seq_be + seq_af + index_sequence + structure,</span></a>
<a class="sourceLine" id="cb193-3" title="3"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb193-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb193-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb193-6" title="6"><span class="co">#mean((y_pred-data_val$reactivity)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb193-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb193-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb193-9" title="9"><span class="co">#mean((y_pred-data_train$reactivity)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb194-1" title="1"><span class="co">#model = glm(reactivity  ~ sequence + struct_be + struct_af +</span></a>
<a class="sourceLine" id="cb194-2" title="2"><span class="co">#              seq_be + seq_af + index_sequence + structure +</span></a>
<a class="sourceLine" id="cb194-3" title="3"><span class="co">#              predicted_loop_type,</span></a>
<a class="sourceLine" id="cb194-4" title="4"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb194-5" title="5"><span class="co">#</span></a>
<a class="sourceLine" id="cb194-6" title="6"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb194-7" title="7"><span class="co">#mean((y_pred-data_val$reactivity)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb194-8" title="8"><span class="co">#</span></a>
<a class="sourceLine" id="cb194-9" title="9"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb194-10" title="10"><span class="co">#mean((y_pred-data_train$reactivity)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" title="1"><span class="co">#model = glm(reactivity  ~ sequence + struct_be + struct_af +</span></a>
<a class="sourceLine" id="cb195-2" title="2"><span class="co">#              seq_be + seq_af + index_sequence + structure +</span></a>
<a class="sourceLine" id="cb195-3" title="3"><span class="co">#              predicted_loop_type + loop_type_be,</span></a>
<a class="sourceLine" id="cb195-4" title="4"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb195-5" title="5"><span class="co">#</span></a>
<a class="sourceLine" id="cb195-6" title="6"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb195-7" title="7"><span class="co">#mean((y_pred-data_val$reactivity)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb195-8" title="8"><span class="co">#</span></a>
<a class="sourceLine" id="cb195-9" title="9"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb195-10" title="10"><span class="co">#mean((y_pred-data_train$reactivity)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb196-1" title="1"><span class="co">#model = glm(reactivity  ~ sequence + struct_be + struct_af +</span></a>
<a class="sourceLine" id="cb196-2" title="2"><span class="co">#              seq_be + seq_af + index_sequence + structure +</span></a>
<a class="sourceLine" id="cb196-3" title="3"><span class="co">#              predicted_loop_type + loop_type_af,</span></a>
<a class="sourceLine" id="cb196-4" title="4"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb196-5" title="5"><span class="co">#</span></a>
<a class="sourceLine" id="cb196-6" title="6"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb196-7" title="7"><span class="co">#mean((y_pred-data_val$reactivity)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb196-8" title="8"><span class="co">#</span></a>
<a class="sourceLine" id="cb196-9" title="9"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb196-10" title="10"><span class="co">#mean((y_pred-data_train$reactivity)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" title="1"><span class="co">#model = glm(reactivity  ~ sequence + struct_be + struct_af +</span></a>
<a class="sourceLine" id="cb197-2" title="2"><span class="co">#              seq_be + seq_af + index_sequence + structure +</span></a>
<a class="sourceLine" id="cb197-3" title="3"><span class="co">#              predicted_loop_type + loop_type_be + loop_type_af,</span></a>
<a class="sourceLine" id="cb197-4" title="4"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb197-5" title="5"><span class="co">#</span></a>
<a class="sourceLine" id="cb197-6" title="6"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb197-7" title="7"><span class="co">#mean((y_pred-data_val$reactivity)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb197-8" title="8"><span class="co">#</span></a>
<a class="sourceLine" id="cb197-9" title="9"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb197-10" title="10"><span class="co">#mean((y_pred-data_train$reactivity)^2,na.rm=TRUE)</span></a></code></pre></div>
<div id="optimisation-1" class="section level4">
<h4>Optimisation</h4>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb198-1" title="1">formula_inverse_gaussian_reactivity =</a>
<a class="sourceLine" id="cb198-2" title="2"><span class="st">  &quot;reactivity  ~ sequence + seq_be + struct_af + index_sequence + structure&quot;</span></a></code></pre></div>
<p>On stocke le meilleur modèle pour la loi gamma.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb199-1" title="1">model_inverse_gaussian_reactivity =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_inverse_gaussian_reactivity,</a>
<a class="sourceLine" id="cb199-2" title="2">                                        <span class="dt">family =</span> inverse.gaussian, <span class="dt">data =</span> data_train)</a></code></pre></div>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb200-1" title="1"><span class="kw">summary</span>(model_inverse_gaussian_reactivity)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = formula_inverse_gaussian_reactivity, family = inverse.gaussian, 
##     data = data_train)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1e+06   0e+00   0e+00   0e+00   3e+00  
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     2.4554498  0.0151062 162.546  &lt; 2e-16 ***
## sequenceC       1.2107942  0.0187757  64.487  &lt; 2e-16 ***
## sequenceG      -0.0640841  0.0078479  -8.166 3.24e-16 ***
## sequenceU      -0.1666024  0.0088741 -18.774  &lt; 2e-16 ***
## seq_beC        -0.0163094  0.0103079  -1.582    0.114    
## seq_beG        -0.1240224  0.0082611 -15.013  &lt; 2e-16 ***
## seq_beO         0.5764066  0.0308362  18.693  &lt; 2e-16 ***
## seq_beU        -0.2454987  0.0093923 -26.138  &lt; 2e-16 ***
## struct_af)     -0.2152049  0.0215791  -9.973  &lt; 2e-16 ***
## struct_af.     -0.7714718  0.0150806 -51.157  &lt; 2e-16 ***
## struct_afO     -0.2259637  0.0505638  -4.469 7.87e-06 ***
## index_sequence  0.0095834  0.0001855  51.664  &lt; 2e-16 ***
## structure)      0.3368557  0.0242317  13.901  &lt; 2e-16 ***
## structure.     -1.1866343  0.0161594 -73.433  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for inverse.gaussian family taken to be 0.3710785)
## 
##     Null deviance: 1e+12  on 86427  degrees of freedom
## Residual deviance: 1e+12  on 86414  degrees of freedom
## AIC: 1547192
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb202-1" title="1">y_pred_inverse_gaussian_train =<span class="st"> </span><span class="kw">predict.glm</span>(model_inverse_gaussian_reactivity,</a>
<a class="sourceLine" id="cb202-2" title="2">                                            data_train, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb202-3" title="3">error_inverse_gaussian_train &lt;-</a>
<a class="sourceLine" id="cb202-4" title="4"><span class="st">  </span><span class="kw">mean</span>((y_pred_inverse_gaussian_train<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb202-5" title="5"><span class="kw">print</span>(error_inverse_gaussian_train)</a></code></pre></div>
<pre><code>## [1] 0.1394548</code></pre>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb204-1" title="1">y_pred_inverse_gaussian_val =<span class="st"> </span><span class="kw">predict.glm</span>(model_inverse_gaussian_reactivity,</a>
<a class="sourceLine" id="cb204-2" title="2">                                          data_val, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb204-3" title="3">error_inverse_gaussian_val &lt;-</a>
<a class="sourceLine" id="cb204-4" title="4"><span class="st">  </span><span class="kw">mean</span>((y_pred_inverse_gaussian_val <span class="op">-</span><span class="st"> </span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb204-5" title="5"><span class="kw">print</span>(error_inverse_gaussian_val)</a></code></pre></div>
<pre><code>## [1] 0.1400279</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb206-1" title="1">models_reactivity &lt;-<span class="st"> </span><span class="kw">c</span>(models_reactivity, <span class="st">&quot;model_inverse_gaussian&quot;</span>)</a>
<a class="sourceLine" id="cb206-2" title="2">errors_reactivity_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_reactivity_train, error_inverse_gaussian_train)</a>
<a class="sourceLine" id="cb206-3" title="3">errors_reactivity_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_reactivity_val, error_inverse_gaussian_val)</a>
<a class="sourceLine" id="cb206-4" title="4"><span class="kw">rm</span>(error_inverse_gaussian_val, error_inverse_gaussian_train,</a>
<a class="sourceLine" id="cb206-5" title="5">   y_pred_inverse_gaussian_train, y_pred_inverse_gaussian_val)</a></code></pre></div>
<div id="stepaic-1" class="section level5">
<h5>StepAIC</h5>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" title="1">model_inverse_gaussian_reactivity_aic =</a>
<a class="sourceLine" id="cb207-2" title="2"><span class="st">  </span><span class="kw">stepAIC</span>(model_inverse_gaussian_reactivity, <span class="dt">trace =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>Pas de changement du modèle. Cela est sûrement dû au fait qu’on n’a pas assez de variables initialement.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb208-1" title="1"><span class="kw">summary</span>(model_inverse_gaussian_reactivity_aic)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = reactivity ~ sequence + seq_be + struct_af + index_sequence + 
##     structure, family = inverse.gaussian, data = data_train)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1e+06   0e+00   0e+00   0e+00   3e+00  
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     2.4554498  0.0151062 162.546  &lt; 2e-16 ***
## sequenceC       1.2107942  0.0187757  64.487  &lt; 2e-16 ***
## sequenceG      -0.0640841  0.0078479  -8.166 3.24e-16 ***
## sequenceU      -0.1666024  0.0088741 -18.774  &lt; 2e-16 ***
## seq_beC        -0.0163094  0.0103079  -1.582    0.114    
## seq_beG        -0.1240224  0.0082611 -15.013  &lt; 2e-16 ***
## seq_beO         0.5764066  0.0308362  18.693  &lt; 2e-16 ***
## seq_beU        -0.2454987  0.0093923 -26.138  &lt; 2e-16 ***
## struct_af)     -0.2152049  0.0215791  -9.973  &lt; 2e-16 ***
## struct_af.     -0.7714718  0.0150806 -51.157  &lt; 2e-16 ***
## struct_afO     -0.2259637  0.0505638  -4.469 7.87e-06 ***
## index_sequence  0.0095834  0.0001855  51.664  &lt; 2e-16 ***
## structure)      0.3368557  0.0242317  13.901  &lt; 2e-16 ***
## structure.     -1.1866343  0.0161594 -73.433  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for inverse.gaussian family taken to be 0.3710785)
## 
##     Null deviance: 1e+12  on 86427  degrees of freedom
## Residual deviance: 1e+12  on 86414  degrees of freedom
## AIC: 1547192
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<p>Pas de changement sur les performances de prédiction.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" title="1">y_pred_inverse_gaussian_train_aic =<span class="st"> </span><span class="kw">predict.glm</span>(model_inverse_gaussian_reactivity_aic,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb210-2" title="2"><span class="kw">mean</span>((y_pred_inverse_gaussian_train_aic<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1394548</code></pre>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb212-1" title="1">y_pred_inverse_gaussian_val_aic=<span class="kw">predict.glm</span>(model_inverse_gaussian_reactivity_aic,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb212-2" title="2"><span class="kw">mean</span>((y_pred_inverse_gaussian_val_aic<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1400279</code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb214-1" title="1"><span class="kw">rm</span>(model_inverse_gaussian_reactivity_aic, y_pred_inverse_gaussian_train_aic, y_pred_inverse_gaussian_val_aic)</a></code></pre></div>
<p>On va maintenant tester des pénalisations ridge, lasso et elastic-net.</p>
</div>
<div id="pénalisation-ridge-et-lasso-1" class="section level5">
<h5>Pénalisation ridge et lasso</h5>
<p>On commence par calculer la matrice de design du model_inverse_gaussian_reactivity sur le train et le test.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb215-1" title="1"><span class="co"># Matrice de design du train</span></a>
<a class="sourceLine" id="cb215-2" title="2">data_train_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_inverse_gaussian_reactivity)</a>
<a class="sourceLine" id="cb215-3" title="3"><span class="co">#head(data_train_pen)</span></a></code></pre></div>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" title="1"><span class="co"># Pour faire la matrice de design de la validation</span></a>
<a class="sourceLine" id="cb216-2" title="2">model_inverse_gaussian_reactivity_val =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_inverse_gaussian_reactivity,</a>
<a class="sourceLine" id="cb216-3" title="3">                                 <span class="dt">family =</span> inverse.gaussian, <span class="dt">data =</span> data_val)</a>
<a class="sourceLine" id="cb216-4" title="4">data_val_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_inverse_gaussian_reactivity_val)</a>
<a class="sourceLine" id="cb216-5" title="5"><span class="co">#head(data_val_pen)</span></a>
<a class="sourceLine" id="cb216-6" title="6"></a>
<a class="sourceLine" id="cb216-7" title="7"><span class="co"># On supprime le modèle sur le test</span></a>
<a class="sourceLine" id="cb216-8" title="8"><span class="kw">rm</span>(model_inverse_gaussian_reactivity_val)</a></code></pre></div>
<p>On pénalise le model_inverse_gaussian_reactivity avec une pénalité ridge. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" title="1"><span class="co">#model_inverse_gaussian_reactivity_pen_ridge = cv.glmnet(data_train_pen, data_train$reactivity,</span></a>
<a class="sourceLine" id="cb217-2" title="2"><span class="co">#                                             family = inverse.gaussian, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb217-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 0)</span></a>
<a class="sourceLine" id="cb217-4" title="4"><span class="co">## lambda.min est le lambda qui minimise l&#39;erreur de cross validation</span></a>
<a class="sourceLine" id="cb217-5" title="5"><span class="co">#coef(model_inverse_gaussian_reactivity_pen_ridge, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb218-1" title="1"><span class="co">#saveRDS(model_inverse_gaussian_reactivity_pen_ridge,</span></a>
<a class="sourceLine" id="cb218-2" title="2"><span class="co">#        &quot;model_inverse_gaussian_reactivity_pen_ridge.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb219-1" title="1">model_inverse_gaussian_reactivity_pen_ridge &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb219-2" title="2"><span class="st">  </span><span class="kw">readRDS</span>(<span class="st">&quot;model_inverse_gaussian_reactivity_pen_ridge.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation ridge.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb220-1" title="1">y_pred_ridge_inverse_gaussian_train =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_reactivity_pen_ridge,</a>
<a class="sourceLine" id="cb220-2" title="2">                                              data_train_pen,</a>
<a class="sourceLine" id="cb220-3" title="3">                                              <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb220-4" title="4">y_pred_ridge_inverse_gaussian_val =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_reactivity_pen_ridge,</a>
<a class="sourceLine" id="cb220-5" title="5">                                            data_val_pen,</a>
<a class="sourceLine" id="cb220-6" title="6">                                            <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb220-7" title="7"></a>
<a class="sourceLine" id="cb220-8" title="8">error_ridge_inverse_gaussian_train &lt;-</a>
<a class="sourceLine" id="cb220-9" title="9"><span class="st">  </span><span class="kw">mean</span>((y_pred_ridge_inverse_gaussian_train<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb220-10" title="10"><span class="kw">print</span>(error_ridge_inverse_gaussian_train)</a></code></pre></div>
<pre><code>## [1] 0.2050952</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb222-1" title="1">error_ridge_inverse_gaussian_val &lt;-</a>
<a class="sourceLine" id="cb222-2" title="2"><span class="st">  </span><span class="kw">mean</span>((y_pred_ridge_inverse_gaussian_val<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb222-3" title="3"><span class="kw">print</span>(error_ridge_inverse_gaussian_val)</a></code></pre></div>
<pre><code>## [1] 0.2126171</code></pre>
<p>On pénalise le model_inverse_gaussian_reactivity avec une pénalité lasso. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb224-1" title="1"><span class="co">#model_inverse_gaussian_reactivity_pen_lasso = cv.glmnet(data_train_pen, data_train$reactivity,</span></a>
<a class="sourceLine" id="cb224-2" title="2"><span class="co">#                                             family = inverse.gaussian, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb224-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 1)</span></a>
<a class="sourceLine" id="cb224-4" title="4"><span class="co">#coef(model_inverse_gaussian_reactivity_pen_lasso, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" title="1"><span class="co">#saveRDS(model_inverse_gaussian_reactivity_pen_lasso,</span></a>
<a class="sourceLine" id="cb225-2" title="2"><span class="co">#        &quot;model_inverse_gaussian_reactivity_pen_lasso.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" title="1">model_inverse_gaussian_reactivity_pen_lasso &lt;-</a>
<a class="sourceLine" id="cb226-2" title="2"><span class="st">  </span><span class="kw">readRDS</span>(<span class="st">&quot;model_inverse_gaussian_reactivity_pen_lasso.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation lasso.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb227-1" title="1">y_pred_lasso_inverse_gaussian_train =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_reactivity_pen_lasso,</a>
<a class="sourceLine" id="cb227-2" title="2">                                              data_train_pen,</a>
<a class="sourceLine" id="cb227-3" title="3">                                              <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb227-4" title="4">error_lasso_inverse_gaussian_train &lt;-</a>
<a class="sourceLine" id="cb227-5" title="5"><span class="st">  </span><span class="kw">mean</span>((y_pred_lasso_inverse_gaussian_train<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb227-6" title="6"><span class="kw">print</span>(error_lasso_inverse_gaussian_train)</a></code></pre></div>
<pre><code>## [1] 0.2003694</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb229-1" title="1">y_pred_lasso_inverse_gaussian_val =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_reactivity_pen_lasso,</a>
<a class="sourceLine" id="cb229-2" title="2">                                            data_val_pen,</a>
<a class="sourceLine" id="cb229-3" title="3">                                            <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb229-4" title="4">error_lasso_inverse_gaussian_val &lt;-</a>
<a class="sourceLine" id="cb229-5" title="5"><span class="st">  </span><span class="kw">mean</span>((y_pred_lasso_inverse_gaussian_val<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb229-6" title="6"><span class="kw">print</span>(error_lasso_inverse_gaussian_val)</a></code></pre></div>
<pre><code>## [1] 0.2074772</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb231-1" title="1">models_reactivity &lt;-<span class="st"> </span><span class="kw">c</span>(models_reactivity, <span class="st">&quot;model_inverse_gaussian_ridge&quot;</span>, <span class="st">&quot;model_inverse_gaussian_lasso&quot;</span>)</a>
<a class="sourceLine" id="cb231-2" title="2">errors_reactivity_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_reactivity_train, error_ridge_inverse_gaussian_train,</a>
<a class="sourceLine" id="cb231-3" title="3">                             error_lasso_inverse_gaussian_train)</a>
<a class="sourceLine" id="cb231-4" title="4">errors_reactivity_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_reactivity_val, error_ridge_inverse_gaussian_val, error_lasso_inverse_gaussian_val)</a>
<a class="sourceLine" id="cb231-5" title="5"><span class="kw">rm</span>(error_ridge_inverse_gaussian_val, error_lasso_inverse_gaussian_val,</a>
<a class="sourceLine" id="cb231-6" title="6">   error_ridge_inverse_gaussian_train, error_lasso_inverse_gaussian_train,</a>
<a class="sourceLine" id="cb231-7" title="7">   y_pred_ridge_inverse_gaussian_train, y_pred_ridge_inverse_gaussian_val,</a>
<a class="sourceLine" id="cb231-8" title="8">   y_pred_lasso_inverse_gaussian_train, y_pred_lasso_inverse_gaussian_val)</a></code></pre></div>
</div>
<div id="pénalisation-elastic-net-1" class="section level5">
<h5>Pénalisation elastic-net</h5>
<p>On choisit <span class="math inline">\(\alpha\)</span> qui minimise le MSE sur la validation.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb232-1" title="1"><span class="co">#alpha_opti_enet_inverse_gaussian_reactivity =</span></a>
<a class="sourceLine" id="cb232-2" title="2"><span class="co">#  alpha_opti_enet(data_train = data_train_pen, data_val = data_val_pen,</span></a>
<a class="sourceLine" id="cb232-3" title="3"><span class="co">#                  y_true_train = data_train$reactivity,</span></a>
<a class="sourceLine" id="cb232-4" title="4"><span class="co">#                  y_true_val = data_val$reactivity,</span></a>
<a class="sourceLine" id="cb232-5" title="5"><span class="co">#                  family = inverse.gaussian, cores = detectCores() - 2)</span></a></code></pre></div>
<p>Au final, le meilleur modèle est le lasso.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb233-1" title="1"><span class="co">#print(alpha_opti_enet_inverse_gaussian_reactivity)</span></a></code></pre></div>
<p>On construit le modèle avec le choix optimal pour <span class="math inline">\(\alpha\)</span>.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" title="1"><span class="co">#model_inverse_gaussian_reactivity_pen_enet = cv.glmnet(data_train_pen, data_train$reactivity,</span></a>
<a class="sourceLine" id="cb234-2" title="2"><span class="co">#                                             family = inverse.gaussian, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb234-3" title="3"><span class="co">#                                             standardize = FALSE,</span></a>
<a class="sourceLine" id="cb234-4" title="4"><span class="co">#                                             alpha = alpha_opti_enet_inverse_gaussian_reactivity)</span></a>
<a class="sourceLine" id="cb234-5" title="5"><span class="co">#coef(model_inverse_gaussian_reactivity_pen_enet, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb235-1" title="1"><span class="co">#saveRDS(model_inverse_gaussian_reactivity_pen_enet,</span></a>
<a class="sourceLine" id="cb235-2" title="2"><span class="co">#        &quot;model_inverse_gaussian_reactivity_pen_enet.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb236-1" title="1">model_inverse_gaussian_reactivity_pen_enet &lt;-</a>
<a class="sourceLine" id="cb236-2" title="2"><span class="st">  </span><span class="kw">readRDS</span>(<span class="st">&quot;model_inverse_gaussian_reactivity_pen_enet.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation elastic-net.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb237-1" title="1">y_pred_enet_inverse_gaussian_train =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_reactivity_pen_enet,</a>
<a class="sourceLine" id="cb237-2" title="2">                                             data_train_pen,</a>
<a class="sourceLine" id="cb237-3" title="3">                                             <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb237-4" title="4">error_enet_inverse_gaussian_train &lt;-</a>
<a class="sourceLine" id="cb237-5" title="5"><span class="st">  </span><span class="kw">mean</span>((y_pred_enet_inverse_gaussian_train <span class="op">-</span><span class="st"> </span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb237-6" title="6"><span class="kw">print</span>(error_enet_inverse_gaussian_train)</a></code></pre></div>
<pre><code>## [1] 0.2003694</code></pre>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb239-1" title="1">y_pred_enet_inverse_gaussian_val =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_reactivity_pen_enet,</a>
<a class="sourceLine" id="cb239-2" title="2">                                           data_val_pen,</a>
<a class="sourceLine" id="cb239-3" title="3">                                           <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb239-4" title="4">error_enet_inverse_gaussian_val &lt;-</a>
<a class="sourceLine" id="cb239-5" title="5"><span class="st">  </span><span class="kw">mean</span>((y_pred_enet_inverse_gaussian_val <span class="op">-</span><span class="st"> </span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb239-6" title="6"><span class="kw">print</span>(error_enet_inverse_gaussian_val)</a></code></pre></div>
<pre><code>## [1] 0.2074772</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb241-1" title="1">models_reactivity &lt;-<span class="st"> </span><span class="kw">c</span>(models_reactivity, <span class="st">&quot;model_inverse_gaussian_enet&quot;</span>)</a>
<a class="sourceLine" id="cb241-2" title="2">errors_reactivity_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_reactivity_train, error_enet_inverse_gaussian_train)</a>
<a class="sourceLine" id="cb241-3" title="3">errors_reactivity_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_reactivity_val, error_enet_inverse_gaussian_val)</a>
<a class="sourceLine" id="cb241-4" title="4"><span class="kw">rm</span>(error_enet_inverse_gaussian_train, error_enet_inverse_gaussian_val,</a>
<a class="sourceLine" id="cb241-5" title="5">   y_pred_enet_inverse_gaussian_train, y_pred_enet_inverse_gaussian_val)</a></code></pre></div>
</div>
</div>
</div>
<div id="récapitulatif-des-résultats" class="section level3">
<h3>Récapitulatif des résultats</h3>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb242-1" title="1">models_reactivity_errors_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(models_reactivity,</a>
<a class="sourceLine" id="cb242-2" title="2">                                          errors_reactivity_train,</a>
<a class="sourceLine" id="cb242-3" title="3">                                          errors_reactivity_val)</a></code></pre></div>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb243-1" title="1">models_reactivity_errors_df</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["models_reactivity"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_reactivity_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_reactivity_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma","2":"0.1122223","3":"0.1152924"},{"1":"model_gamma_ridge","2":"0.1443514","3":"0.1494319"},{"1":"model_gamma_lasso","2":"0.1122858","3":"0.1152241"},{"1":"model_gamma_enet","2":"0.1122858","3":"0.1152241"},{"1":"model_inverse_gaussian","2":"0.1394548","3":"0.1400279"},{"1":"model_inverse_gaussian_ridge","2":"0.2050952","3":"0.2126171"},{"1":"model_inverse_gaussian_lasso","2":"0.2003694","3":"0.2074772"},{"1":"model_inverse_gaussian_enet","2":"0.2003694","3":"0.2074772"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Le meilleur modèle (au sens de la minimisation du MSE sur la validation) est le <code>model_gamma</code>. Ainsi, la pénalisation n’a pas permis d’améliorer les performances ici.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb244-1" title="1">models_reactivity_errors_df[<span class="kw">which.min</span>(errors_reactivity_val), ]</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["models_reactivity"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_reactivity_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_reactivity_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma_lasso","2":"0.1122858","3":"0.1152241","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="deg_mg_ph10" class="section level2">
<h2>deg_Mg_pH10</h2>
<div id="loi-gamma-1" class="section level3">
<h3>Loi Gamma</h3>
<p>Ici on fera énormément de tests pour essayer de voir quels variables apportent des informations utiles.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb245-1" title="1">model=<span class="kw">glm</span>(deg_Mg_pH10<span class="op">~</span>sequence,<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb245-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb245-3" title="3"></a>
<a class="sourceLine" id="cb245-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb245-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2636452</code></pre>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb247-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb247-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2637861</code></pre>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb249-1" title="1">model=<span class="kw">glm</span>(deg_Mg_pH10<span class="op">~</span>(sequence<span class="op">+</span>seq_be<span class="op">+</span>seq_af),<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb249-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb249-3" title="3"></a>
<a class="sourceLine" id="cb249-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb249-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2218754</code></pre>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb251-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb251-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2180554</code></pre>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb253-1" title="1">model=<span class="kw">glm</span>(deg_Mg_pH10<span class="op">~</span>sequence<span class="op">+</span>index_sequence,<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb253-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb253-3" title="3"></a>
<a class="sourceLine" id="cb253-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb253-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2559701</code></pre>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb255-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb255-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2555254</code></pre>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb257-1" title="1">model=<span class="kw">glm</span>(deg_Mg_pH10<span class="op">~</span>sequence<span class="op">+</span>predicted_loop_type<span class="op">+</span>index_sequence,<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb257-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb257-3" title="3">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb257-4" title="4"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2264197</code></pre>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb259-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb259-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2256427</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb261-1" title="1">model=<span class="kw">glm</span>(deg_Mg_pH10<span class="op">~</span>sequence<span class="op">+</span>structure<span class="op">+</span>index_sequence,<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb261-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb261-3" title="3"></a>
<a class="sourceLine" id="cb261-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb261-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2286726</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb263-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb263-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2298265</code></pre>
<p>AUTRES ESSAIS</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb265-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span></a>
<a class="sourceLine" id="cb265-2" title="2"><span class="st">              </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb265-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb265-4" title="4"></a>
<a class="sourceLine" id="cb265-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb265-6" title="6"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2136914</code></pre>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb267-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb267-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2178301</code></pre>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb269-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span></a>
<a class="sourceLine" id="cb269-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb269-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb269-4" title="4"></a>
<a class="sourceLine" id="cb269-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb269-6" title="6"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1830101</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb271-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb271-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1881872</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb273-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span></a>
<a class="sourceLine" id="cb273-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb273-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb273-4" title="4"></a>
<a class="sourceLine" id="cb273-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb273-6" title="6"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2124203</code></pre>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb275-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb275-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2160423</code></pre>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb277-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span></a>
<a class="sourceLine" id="cb277-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb277-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb277-4" title="4"></a>
<a class="sourceLine" id="cb277-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb279-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2166718</code></pre>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb281-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb283-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2189296</code></pre>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb285-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span></a>
<a class="sourceLine" id="cb285-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb285-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb285-4" title="4"></a>
<a class="sourceLine" id="cb285-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb285-6" title="6"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1834829</code></pre>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb287-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb287-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1888434</code></pre>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb289-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span></a>
<a class="sourceLine" id="cb289-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb289-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb289-4" title="4"></a>
<a class="sourceLine" id="cb289-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb291-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1854234</code></pre>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb293-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb295-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1905148</code></pre>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb297-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>predicted_loop_type <span class="op">+</span></a>
<a class="sourceLine" id="cb297-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb297-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb297-4" title="4"></a>
<a class="sourceLine" id="cb297-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb299-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2147132</code></pre>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb301-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb303-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2161259</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb305-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span><span class="st"> </span>predicted_loop_type <span class="op">+</span></a>
<a class="sourceLine" id="cb305-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb305-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb305-4" title="4"></a>
<a class="sourceLine" id="cb305-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb307-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1853169</code></pre>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb309-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb311-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1897372</code></pre>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb313-1" title="1"><span class="co">#model = glm(deg_Mg_pH10  ~ sequence + seq_be + seq_af + predicted_loop_type +</span></a>
<a class="sourceLine" id="cb313-2" title="2"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb313-3" title="3"><span class="co">#            family = Gamma, data = data_train)</span></a>
<a class="sourceLine" id="cb313-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb313-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb313-6" title="6"><span class="co">#mean((y_pred-data_val$deg_Mg_pH10)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb313-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb313-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb313-9" title="9"><span class="co">#mean((y_pred-data_train$deg_Mg_pH10)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb314-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span><span class="st"> </span>predicted_loop_type <span class="op">+</span></a>
<a class="sourceLine" id="cb314-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb314-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb314-4" title="4"></a>
<a class="sourceLine" id="cb314-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb316-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2182601</code></pre>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb318-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb320-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2195804</code></pre>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb322-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span><span class="st"> </span>predicted_loop_type <span class="op">+</span></a>
<a class="sourceLine" id="cb322-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb322-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb322-4" title="4"></a>
<a class="sourceLine" id="cb322-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb324-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.221361</code></pre>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb326-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb328-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2226565</code></pre>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb330-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span></a>
<a class="sourceLine" id="cb330-2" title="2"><span class="st">              </span>seq_be <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span><span class="st"> </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb330-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb330-4" title="4"></a>
<a class="sourceLine" id="cb330-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb332-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.141588</code></pre>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb334-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb336-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.137518</code></pre>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb338-1" title="1"><span class="co">#model = glm(deg_Mg_pH10  ~ sequence + struct_be + struct_af +</span></a>
<a class="sourceLine" id="cb338-2" title="2"><span class="co">#              seq_be + seq_af + index_sequence + structure +</span></a>
<a class="sourceLine" id="cb338-3" title="3"><span class="co">#              predicted_loop_type,</span></a>
<a class="sourceLine" id="cb338-4" title="4"><span class="co">#            family = Gamma, data = data_train)</span></a>
<a class="sourceLine" id="cb338-5" title="5"><span class="co">#</span></a>
<a class="sourceLine" id="cb338-6" title="6"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb338-7" title="7"><span class="co">#mean((y_pred-data_val$reactivity)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb338-8" title="8"><span class="co">#</span></a>
<a class="sourceLine" id="cb338-9" title="9"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb338-10" title="10"><span class="co">#mean((y_pred-data_train$reactivity)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb339-1" title="1"><span class="co">#model = glm(deg_Mg_pH10  ~ sequence + struct_be + struct_af +</span></a>
<a class="sourceLine" id="cb339-2" title="2"><span class="co">#              seq_be + seq_af + index_sequence + structure +</span></a>
<a class="sourceLine" id="cb339-3" title="3"><span class="co">#              predicted_loop_type + loop_type_be,</span></a>
<a class="sourceLine" id="cb339-4" title="4"><span class="co">#            family = Gamma, data = data_train)</span></a>
<a class="sourceLine" id="cb339-5" title="5"><span class="co">#</span></a>
<a class="sourceLine" id="cb339-6" title="6"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb339-7" title="7"><span class="co">#mean((y_pred-data_val$reactivity)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb339-8" title="8"><span class="co">#</span></a>
<a class="sourceLine" id="cb339-9" title="9"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb339-10" title="10"><span class="co">#mean((y_pred-data_train$reactivity)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb340-1" title="1"><span class="co">#model = glm(deg_Mg_pH10  ~ sequence + struct_be + struct_af +</span></a>
<a class="sourceLine" id="cb340-2" title="2"><span class="co">#              seq_be + seq_af + index_sequence + structure +</span></a>
<a class="sourceLine" id="cb340-3" title="3"><span class="co">#              predicted_loop_type + loop_type_af,</span></a>
<a class="sourceLine" id="cb340-4" title="4"><span class="co">#            family = Gamma, data = data_train)</span></a>
<a class="sourceLine" id="cb340-5" title="5"><span class="co">#</span></a>
<a class="sourceLine" id="cb340-6" title="6"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb340-7" title="7"><span class="co">#mean((y_pred-data_val$reactivity)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb340-8" title="8"><span class="co">#</span></a>
<a class="sourceLine" id="cb340-9" title="9"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb340-10" title="10"><span class="co">#mean((y_pred-data_train$reactivity)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb341-1" title="1"><span class="co">#model = glm(deg_Mg_pH10  ~ sequence + struct_be + struct_af +</span></a>
<a class="sourceLine" id="cb341-2" title="2"><span class="co">#              seq_be + seq_af + index_sequence + structure +</span></a>
<a class="sourceLine" id="cb341-3" title="3"><span class="co">#              predicted_loop_type + loop_type_be + loop_type_af,</span></a>
<a class="sourceLine" id="cb341-4" title="4"><span class="co">#            family = Gamma, data = data_train)</span></a>
<a class="sourceLine" id="cb341-5" title="5"><span class="co">#</span></a>
<a class="sourceLine" id="cb341-6" title="6"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb341-7" title="7"><span class="co">#mean((y_pred-data_val$reactivity)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb341-8" title="8"><span class="co">#</span></a>
<a class="sourceLine" id="cb341-9" title="9"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb341-10" title="10"><span class="co">#mean((y_pred-data_train$reactivity)^2,na.rm=TRUE)</span></a></code></pre></div>
<div id="optimisation-2" class="section level4">
<h4>Optimisation</h4>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb342-1" title="1">formula_gamma_deg_Mg_pH10 =</a>
<a class="sourceLine" id="cb342-2" title="2"><span class="st">  &quot;deg_Mg_pH10  ~ sequence + seq_be + seq_af + index_sequence + structure&quot;</span></a></code></pre></div>
<p>On stocke le meilleur modèle pour la loi gamma.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb343-1" title="1">model_gamma_deg_Mg_pH10 =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_gamma_deg_Mg_pH10,</a>
<a class="sourceLine" id="cb343-2" title="2">                             <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a></code></pre></div>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb344-1" title="1"><span class="kw">summary</span>(model_gamma_deg_Mg_pH10)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = formula_gamma_deg_Mg_pH10, family = Gamma, data = data_train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -7.2282  -0.3301  -0.1193   0.1526   4.7982  
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     1.5634369  0.0084197 185.688  &lt; 2e-16 ***
## sequenceC       0.0469550  0.0071133   6.601 4.11e-11 ***
## sequenceG      -0.2241830  0.0051455 -43.569  &lt; 2e-16 ***
## sequenceU      -0.1405955  0.0065580 -21.439  &lt; 2e-16 ***
## seq_beC         0.1285083  0.0066237  19.401  &lt; 2e-16 ***
## seq_beG        -0.0697741  0.0051532 -13.540  &lt; 2e-16 ***
## seq_beO        -0.1806919  0.0170725 -10.584  &lt; 2e-16 ***
## seq_beU        -0.0834686  0.0062872 -13.276  &lt; 2e-16 ***
## seq_afC         0.4717403  0.0075954  62.109  &lt; 2e-16 ***
## seq_afG         0.5313726  0.0071224  74.606  &lt; 2e-16 ***
## seq_afO        -0.3760616  0.0149093 -25.223  &lt; 2e-16 ***
## seq_afU        -0.3444595  0.0050605 -68.069  &lt; 2e-16 ***
## index_sequence  0.0060148  0.0001219  49.338  &lt; 2e-16 ***
## structure)     -0.2188066  0.0079820 -27.413  &lt; 2e-16 ***
## structure.     -0.6204443  0.0064485 -96.216  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.2375491)
## 
##     Null deviance: 26169  on 86427  degrees of freedom
## Residual deviance: 15513  on 86413  degrees of freedom
## AIC: 22391
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb346-1" title="1">y_pred_gamma_train =<span class="st"> </span><span class="kw">predict.glm</span>(model_gamma_deg_Mg_pH10,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb346-2" title="2">error_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb346-3" title="3"><span class="kw">print</span>(error_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1881872</code></pre>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb348-1" title="1">y_pred_gamma_val=<span class="kw">predict.glm</span>(model_gamma_deg_Mg_pH10,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb348-2" title="2">error_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb348-3" title="3"><span class="kw">print</span>(error_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1830101</code></pre>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb350-1" title="1">models_deg_Mg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_Mg_pH10, <span class="st">&quot;model_gamma&quot;</span>)</a>
<a class="sourceLine" id="cb350-2" title="2">errors_deg_Mg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_pH10_train, error_gamma_train)</a>
<a class="sourceLine" id="cb350-3" title="3">errors_deg_Mg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_pH10_val, error_gamma_val)</a>
<a class="sourceLine" id="cb350-4" title="4"><span class="kw">rm</span>(error_gamma_val, error_gamma_train, y_pred_gamma_train, y_pred_gamma_val)</a></code></pre></div>
<div id="stepaic-2" class="section level5">
<h5>StepAIC</h5>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb351-1" title="1">model_gamma_deg_Mg_pH10_aic =<span class="st"> </span><span class="kw">stepAIC</span>(model_gamma_deg_Mg_pH10, <span class="dt">trace =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>Pas de changement du modèle. Cela est sûrement dû au fait qu’on n’a pas assez de variables initialement.</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb352-1" title="1"><span class="kw">summary</span>(model_gamma_deg_Mg_pH10_aic)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = deg_Mg_pH10 ~ sequence + seq_be + seq_af + index_sequence + 
##     structure, family = Gamma, data = data_train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -7.2282  -0.3301  -0.1193   0.1526   4.7982  
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     1.5634369  0.0084197 185.688  &lt; 2e-16 ***
## sequenceC       0.0469550  0.0071133   6.601 4.11e-11 ***
## sequenceG      -0.2241830  0.0051455 -43.569  &lt; 2e-16 ***
## sequenceU      -0.1405955  0.0065580 -21.439  &lt; 2e-16 ***
## seq_beC         0.1285083  0.0066237  19.401  &lt; 2e-16 ***
## seq_beG        -0.0697741  0.0051532 -13.540  &lt; 2e-16 ***
## seq_beO        -0.1806919  0.0170725 -10.584  &lt; 2e-16 ***
## seq_beU        -0.0834686  0.0062872 -13.276  &lt; 2e-16 ***
## seq_afC         0.4717403  0.0075954  62.109  &lt; 2e-16 ***
## seq_afG         0.5313726  0.0071224  74.606  &lt; 2e-16 ***
## seq_afO        -0.3760616  0.0149093 -25.223  &lt; 2e-16 ***
## seq_afU        -0.3444595  0.0050605 -68.069  &lt; 2e-16 ***
## index_sequence  0.0060148  0.0001219  49.338  &lt; 2e-16 ***
## structure)     -0.2188066  0.0079820 -27.413  &lt; 2e-16 ***
## structure.     -0.6204443  0.0064485 -96.216  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.2375491)
## 
##     Null deviance: 26169  on 86427  degrees of freedom
## Residual deviance: 15513  on 86413  degrees of freedom
## AIC: 22391
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>Pas de changement sur les performances de prédiction.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb354-1" title="1">y_pred_gamma_train_aic =<span class="st"> </span><span class="kw">predict.glm</span>(model_gamma_deg_Mg_pH10_aic,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb354-2" title="2"><span class="kw">mean</span>((y_pred_gamma_train_aic<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1881872</code></pre>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb356-1" title="1">y_pred_gamma_val_aic=<span class="kw">predict.glm</span>(model_gamma_deg_Mg_pH10_aic,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb356-2" title="2"><span class="kw">mean</span>((y_pred_gamma_val_aic<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1830101</code></pre>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb358-1" title="1"><span class="kw">rm</span>(model_gamma_deg_Mg_pH10_aic, y_pred_gamma_train_aic, y_pred_gamma_val_aic)</a></code></pre></div>
<p>On va maintenant tester des pénalisations ridge, lasso et elastic-net.</p>
</div>
<div id="pénalisation-ridge-et-lasso-2" class="section level5">
<h5>Pénalisation ridge et lasso</h5>
<p>On commence par calculer la matrice de design du model_gamma_deg_Mg_pH10 sur le train et le test.</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb359-1" title="1"><span class="co"># Matrice de design du train</span></a>
<a class="sourceLine" id="cb359-2" title="2">data_train_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_gamma_deg_Mg_pH10)</a>
<a class="sourceLine" id="cb359-3" title="3"><span class="co">#head(data_train_pen)</span></a></code></pre></div>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb360-1" title="1"><span class="co"># Pour faire la matrice de design de la validation</span></a>
<a class="sourceLine" id="cb360-2" title="2">model_gamma_deg_Mg_pH10_val =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_gamma_deg_Mg_pH10,</a>
<a class="sourceLine" id="cb360-3" title="3">                                 <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_val)</a>
<a class="sourceLine" id="cb360-4" title="4">data_val_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_gamma_deg_Mg_pH10_val)</a>
<a class="sourceLine" id="cb360-5" title="5"><span class="co">#head(data_val_pen)</span></a>
<a class="sourceLine" id="cb360-6" title="6"></a>
<a class="sourceLine" id="cb360-7" title="7"><span class="co"># On supprime le modèle sur le test</span></a>
<a class="sourceLine" id="cb360-8" title="8"><span class="kw">rm</span>(model_gamma_deg_Mg_pH10_val)</a></code></pre></div>
<p>On pénalise le model_gamma_deg_Mg_pH10 avec une pénalité ridge. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb361-1" title="1"><span class="co">#model_gamma_deg_Mg_pH10_pen_ridge = cv.glmnet(data_train_pen, data_train$deg_Mg_pH10,</span></a>
<a class="sourceLine" id="cb361-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb361-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 0)</span></a>
<a class="sourceLine" id="cb361-4" title="4"><span class="co">## lambda.min est le lambda qui minimise l&#39;erreur de cross validation</span></a>
<a class="sourceLine" id="cb361-5" title="5"><span class="co">#coef(model_gamma_deg_Mg_pH10_pen_ridge, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb362-1" title="1"><span class="co">#saveRDS(model_gamma_deg_Mg_pH10_pen_ridge, &quot;model_gamma_deg_Mg_pH10_pen_ridge.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb363-1" title="1">model_gamma_deg_Mg_pH10_pen_ridge &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_Mg_pH10_pen_ridge.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation ridge.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb364-1" title="1">y_pred_ridge_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_pH10_pen_ridge, data_train_pen,</a>
<a class="sourceLine" id="cb364-2" title="2">                                   <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb364-3" title="3">y_pred_ridge_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_pH10_pen_ridge, data_val_pen,</a>
<a class="sourceLine" id="cb364-4" title="4">                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb364-5" title="5">error_ridge_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_ridge_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb364-6" title="6"><span class="kw">print</span>(error_ridge_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.2158509</code></pre>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb366-1" title="1">error_ridge_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_ridge_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb366-2" title="2"><span class="kw">print</span>(error_ridge_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.2132939</code></pre>
<p>On pénalise le model_gamma_deg_Mg_pH10 avec une pénalité lasso. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb368-1" title="1"><span class="co">#model_gamma_deg_Mg_pH10_pen_lasso = cv.glmnet(data_train_pen, data_train$deg_Mg_pH10,</span></a>
<a class="sourceLine" id="cb368-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb368-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 1)</span></a>
<a class="sourceLine" id="cb368-4" title="4"><span class="co">#coef(model_gamma_deg_Mg_pH10_pen_lasso, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb369-1" title="1"><span class="co">#saveRDS(model_gamma_deg_Mg_pH10_pen_lasso, &quot;model_gamma_deg_Mg_pH10_pen_lasso.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb370-1" title="1">model_gamma_deg_Mg_pH10_pen_lasso &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_Mg_pH10_pen_lasso.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation lasso.</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb371-1" title="1">y_pred_lasso_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_pH10_pen_lasso, data_train_pen,</a>
<a class="sourceLine" id="cb371-2" title="2">                                   <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb371-3" title="3">error_lasso_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_lasso_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb371-4" title="4"><span class="kw">print</span>(error_lasso_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1881508</code></pre>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb373-1" title="1">y_pred_lasso_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_pH10_pen_lasso, data_val_pen,</a>
<a class="sourceLine" id="cb373-2" title="2">                                 <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb373-3" title="3">error_lasso_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_lasso_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb373-4" title="4"><span class="kw">print</span>(error_lasso_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1828771</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb375-1" title="1">models_deg_Mg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_Mg_pH10, <span class="st">&quot;model_gamma_ridge&quot;</span>, <span class="st">&quot;model_gamma_lasso&quot;</span>)</a>
<a class="sourceLine" id="cb375-2" title="2">errors_deg_Mg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_pH10_train, error_ridge_gamma_train,</a>
<a class="sourceLine" id="cb375-3" title="3">                             error_lasso_gamma_train)</a>
<a class="sourceLine" id="cb375-4" title="4">errors_deg_Mg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_pH10_val, error_ridge_gamma_val, error_lasso_gamma_val)</a>
<a class="sourceLine" id="cb375-5" title="5"><span class="kw">rm</span>(error_ridge_gamma_val, error_lasso_gamma_val,</a>
<a class="sourceLine" id="cb375-6" title="6">   error_ridge_gamma_train, error_lasso_gamma_train,</a>
<a class="sourceLine" id="cb375-7" title="7">   y_pred_ridge_gamma_train, y_pred_ridge_gamma_val,</a>
<a class="sourceLine" id="cb375-8" title="8">   y_pred_lasso_gamma_train, y_pred_lasso_gamma_val)</a></code></pre></div>
</div>
<div id="pénalisation-elastic-net-2" class="section level5">
<h5>Pénalisation elastic-net</h5>
<p>On choisit <span class="math inline">\(\alpha\)</span> qui minimise le MSE sur la validation.</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb376-1" title="1"><span class="co">#alpha_opti_enet_gamma_deg_Mg_pH10 =</span></a>
<a class="sourceLine" id="cb376-2" title="2"><span class="co">#  alpha_opti_enet(data_train = data_train_pen, data_val = data_val_pen,</span></a>
<a class="sourceLine" id="cb376-3" title="3"><span class="co">#                  y_true_train = data_train$deg_Mg_pH10,</span></a>
<a class="sourceLine" id="cb376-4" title="4"><span class="co">#                  y_true_val = data_val$deg_Mg_pH10,</span></a>
<a class="sourceLine" id="cb376-5" title="5"><span class="co">#                  family = Gamma, cores = detectCores() - 2)</span></a></code></pre></div>
<p>Au final, le meilleur modèle est celui avec <span class="math inline">\(\alpha = 0.05\)</span>.</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb377-1" title="1"><span class="co">#print(alpha_opti_enet_gamma_deg_Mg_pH10)</span></a></code></pre></div>
<p>On construit le modèle avec le choix optimal pour <span class="math inline">\(\alpha\)</span>.</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb378-1" title="1"><span class="co">#model_gamma_deg_Mg_pH10_pen_enet = cv.glmnet(data_train_pen, data_train$deg_Mg_pH10,</span></a>
<a class="sourceLine" id="cb378-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb378-3" title="3"><span class="co">#                                             standardize = FALSE,</span></a>
<a class="sourceLine" id="cb378-4" title="4"><span class="co">#                                             alpha = alpha_opti_enet_gamma_deg_Mg_pH10)</span></a>
<a class="sourceLine" id="cb378-5" title="5"><span class="co">#coef(model_gamma_deg_Mg_pH10_pen_enet, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb379-1" title="1"><span class="co">#saveRDS(model_gamma_deg_Mg_pH10_pen_enet, &quot;model_gamma_deg_Mg_pH10_pen_enet.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb380-1" title="1">model_gamma_deg_Mg_pH10_pen_enet &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_Mg_pH10_pen_enet.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation elastic-net.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb381-1" title="1">y_pred_enet_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_pH10_pen_enet, data_train_pen,</a>
<a class="sourceLine" id="cb381-2" title="2">                                   <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb381-3" title="3">error_enet_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_enet_gamma_train <span class="op">-</span><span class="st"> </span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb381-4" title="4"><span class="kw">print</span>(error_enet_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1881386</code></pre>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb383-1" title="1">y_pred_enet_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_pH10_pen_enet, data_val_pen,</a>
<a class="sourceLine" id="cb383-2" title="2">                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb383-3" title="3">error_enet_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_enet_gamma_val <span class="op">-</span><span class="st"> </span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb383-4" title="4"><span class="kw">print</span>(error_enet_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1829963</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb385-1" title="1">models_deg_Mg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_Mg_pH10, <span class="st">&quot;model_gamma_enet&quot;</span>)</a>
<a class="sourceLine" id="cb385-2" title="2">errors_deg_Mg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_pH10_train, error_enet_gamma_train)</a>
<a class="sourceLine" id="cb385-3" title="3">errors_deg_Mg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_pH10_val, error_enet_gamma_val)</a>
<a class="sourceLine" id="cb385-4" title="4"><span class="kw">rm</span>(error_enet_gamma_train, error_enet_gamma_val,</a>
<a class="sourceLine" id="cb385-5" title="5">   y_pred_enet_gamma_train, y_pred_enet_gamma_val)</a></code></pre></div>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb386-1" title="1"><span class="kw">data.frame</span>(models_deg_Mg_pH10, errors_deg_Mg_pH10_train, errors_deg_Mg_pH10_val)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["models_deg_Mg_pH10"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_deg_Mg_pH10_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_deg_Mg_pH10_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma","2":"0.1881872","3":"0.1830101"},{"1":"model_gamma_ridge","2":"0.2158509","3":"0.2132939"},{"1":"model_gamma_lasso","2":"0.1881508","3":"0.1828771"},{"1":"model_gamma_enet","2":"0.1881386","3":"0.1829963"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<div id="inverse.gaussian-1" class="section level3">
<h3>Inverse.gaussian</h3>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb387-1" title="1">model=<span class="kw">glm</span>(deg_Mg_pH10<span class="op">~</span>sequence,<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb387-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb387-3" title="3"></a>
<a class="sourceLine" id="cb387-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb387-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2692446</code></pre>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb389-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb389-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2693435</code></pre>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb391-1" title="1">model=<span class="kw">glm</span>(deg_Mg_pH10<span class="op">~</span>(sequence<span class="op">+</span>seq_be),<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb391-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb391-3" title="3"></a>
<a class="sourceLine" id="cb391-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb391-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2640555</code></pre>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb393-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb393-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2631486</code></pre>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb395-1" title="1">model=<span class="kw">glm</span>(deg_Mg_pH10<span class="op">~</span>sequence<span class="op">+</span>index_sequence,<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb395-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb395-3" title="3"></a>
<a class="sourceLine" id="cb395-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb395-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.256573</code></pre>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb397-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb397-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2555125</code></pre>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb399-1" title="1">model=<span class="kw">glm</span>(deg_Mg_pH10<span class="op">~</span>sequence<span class="op">+</span>predicted_loop_type,<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb399-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb399-3" title="3">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb399-4" title="4"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2325482</code></pre>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb401-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb401-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.228966</code></pre>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb403-1" title="1">model=<span class="kw">glm</span>(deg_Mg_pH10<span class="op">~</span>sequence<span class="op">+</span>structure,<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb403-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb403-3" title="3"></a>
<a class="sourceLine" id="cb403-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb403-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2388208</code></pre>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb405-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb405-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2398585</code></pre>
<p>AUTRES ESSAIS</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb407-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span></a>
<a class="sourceLine" id="cb407-2" title="2"><span class="st">              </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb407-3" title="3">            <span class="dt">family =</span> inverse.gaussian, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb407-4" title="4"></a>
<a class="sourceLine" id="cb407-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb407-6" title="6"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2066344</code></pre>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb409-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb409-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2126698</code></pre>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb411-1" title="1"><span class="co">#model = glm(deg_Mg_pH10  ~ sequence + seq_be + seq_af +</span></a>
<a class="sourceLine" id="cb411-2" title="2"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb411-3" title="3"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb411-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb411-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb411-6" title="6"><span class="co">#mean((y_pred-data_val$deg_Mg_pH10)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb411-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb411-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb411-9" title="9"><span class="co">#mean((y_pred-data_train$deg_Mg_pH10)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb412-1" title="1"><span class="co">#model = glm(deg_Mg_pH10  ~ sequence + seq_be + struct_af +</span></a>
<a class="sourceLine" id="cb412-2" title="2"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb412-3" title="3"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb412-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb412-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb412-6" title="6"><span class="co">#mean((y_pred-data_val$deg_Mg_pH10)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb412-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb412-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb412-9" title="9"><span class="co">#mean((y_pred-data_train$deg_Mg_pH10)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb413-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span></a>
<a class="sourceLine" id="cb413-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb413-3" title="3">            <span class="dt">family =</span> inverse.gaussian, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb413-4" title="4"></a>
<a class="sourceLine" id="cb413-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb415-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.212168</code></pre>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb417-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb419-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2159495</code></pre>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb421-1" title="1"><span class="co">#model = glm(deg_Mg_pH10  ~ sequence + seq_af + struct_be +</span></a>
<a class="sourceLine" id="cb421-2" title="2"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb421-3" title="3"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb421-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb421-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb421-6" title="6"><span class="co">#mean((y_pred-data_val$deg_Mg_pH10)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb421-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb421-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb421-9" title="9"><span class="co">#mean((y_pred-data_train$deg_Mg_pH10)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb422-1" title="1"><span class="co">#model = glm(deg_Mg_pH10  ~ sequence + seq_af + struct_af +</span></a>
<a class="sourceLine" id="cb422-2" title="2"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb422-3" title="3"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb422-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb422-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb422-6" title="6"><span class="co">#mean((y_pred-data_val$deg_Mg_pH10)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb422-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb422-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb422-9" title="9"><span class="co">#mean((y_pred-data_train$deg_Mg_pH10)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb423-1" title="1"><span class="co">#model = glm(deg_Mg_pH10  ~ sequence + seq_be + predicted_loop_type +</span></a>
<a class="sourceLine" id="cb423-2" title="2"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb423-3" title="3"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb423-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb423-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb423-6" title="6"><span class="co">#mean((y_pred-data_val$deg_Mg_pH10)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb423-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb423-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb423-9" title="9"><span class="co">#mean((y_pred-data_train$deg_Mg_pH10)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb424-1" title="1"><span class="co">#model = glm(deg_Mg_pH10  ~ sequence + seq_af + predicted_loop_type +</span></a>
<a class="sourceLine" id="cb424-2" title="2"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb424-3" title="3"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb424-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb424-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb424-6" title="6"><span class="co">#mean((y_pred-data_val$deg_Mg_pH10)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb424-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb424-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb424-9" title="9"><span class="co">#mean((y_pred-data_train$deg_Mg_pH10)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb425-1" title="1"><span class="co">#model = glm(deg_Mg_pH10  ~ sequence + seq_be + seq_af + predicted_loop_type +</span></a>
<a class="sourceLine" id="cb425-2" title="2"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb425-3" title="3"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb425-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb425-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb425-6" title="6"><span class="co">#mean((y_pred-data_val$deg_Mg_pH10)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb425-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb425-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb425-9" title="9"><span class="co">#mean((y_pred-data_train$deg_Mg_pH10)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb426-1" title="1"><span class="co">#model = glm(deg_Mg_pH10  ~ sequence + struct_be + predicted_loop_type +</span></a>
<a class="sourceLine" id="cb426-2" title="2"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb426-3" title="3"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb426-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb426-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb426-6" title="6"><span class="co">#mean((y_pred-data_val$deg_Mg_pH10)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb426-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb426-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb426-9" title="9"><span class="co">#mean((y_pred-data_train$deg_Mg_pH10)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb427-1" title="1"><span class="co">#model = glm(deg_Mg_pH10  ~ sequence + struct_af + predicted_loop_type +</span></a>
<a class="sourceLine" id="cb427-2" title="2"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb427-3" title="3"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb427-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb427-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb427-6" title="6"><span class="co">#mean((y_pred-data_val$deg_Mg_pH10)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb427-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb427-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb427-9" title="9"><span class="co">#mean((y_pred-data_train$deg_Mg_pH10)^2,na.rm=TRUE)</span></a></code></pre></div>
<div id="optimisation-3" class="section level4">
<h4>Optimisation</h4>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb428-1" title="1"><span class="co"># Cette formule =&gt; problème pour extraire matrice de design de la validation</span></a>
<a class="sourceLine" id="cb428-2" title="2"><span class="co">#formula_inverse_gaussian_deg_Mg_pH10 =</span></a>
<a class="sourceLine" id="cb428-3" title="3"><span class="co">#  &quot;deg_Mg_pH10  ~ sequence + seq_be + struct_af + index_sequence + structure&quot;</span></a>
<a class="sourceLine" id="cb428-4" title="4"></a>
<a class="sourceLine" id="cb428-5" title="5">formula_inverse_gaussian_deg_Mg_pH10 =</a>
<a class="sourceLine" id="cb428-6" title="6"><span class="st">  &quot;deg_Mg_pH10  ~ sequence + struct_be + struct_af + index_sequence + structure&quot;</span></a></code></pre></div>
<p>On stocke le meilleur modèle pour la loi inverse.gaussian.</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb429-1" title="1">model_inverse_gaussian_deg_Mg_pH10 =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_inverse_gaussian_deg_Mg_pH10,</a>
<a class="sourceLine" id="cb429-2" title="2">                                        <span class="dt">family =</span> inverse.gaussian, <span class="dt">data =</span> data_train)</a></code></pre></div>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb430-1" title="1"><span class="kw">summary</span>(model_inverse_gaussian_deg_Mg_pH10)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = formula_inverse_gaussian_deg_Mg_pH10, family = inverse.gaussian, 
##     data = data_train)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1e+06  -1e+00   0e+00   0e+00   4e+00  
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     2.8077551  0.0234182 119.896  &lt; 2e-16 ***
## sequenceC       0.2486705  0.0223982  11.102  &lt; 2e-16 ***
## sequenceG      -0.4523499  0.0127583 -35.455  &lt; 2e-16 ***
## sequenceU      -0.3059426  0.0175926 -17.390  &lt; 2e-16 ***
## struct_be)     -0.4295865  0.0290071 -14.810  &lt; 2e-16 ***
## struct_be.     -0.3919994  0.0208001 -18.846  &lt; 2e-16 ***
## struct_beO      0.4758086  0.0516987   9.203  &lt; 2e-16 ***
## struct_af)     -0.0105364  0.0314420  -0.335    0.738    
## struct_af.     -0.5306382  0.0224200 -23.668  &lt; 2e-16 ***
## struct_afO     -1.2600048  0.0486510 -25.899  &lt; 2e-16 ***
## index_sequence  0.0139724  0.0003256  42.909  &lt; 2e-16 ***
## structure)     -0.2526664  0.0392453  -6.438 1.22e-10 ***
## structure.     -1.1645637  0.0284536 -40.928  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for inverse.gaussian family taken to be 0.6389812)
## 
##     Null deviance: 1e+12  on 86427  degrees of freedom
## Residual deviance: 1e+12  on 86415  degrees of freedom
## AIC: 1535398
## 
## Number of Fisher Scoring iterations: 3</code></pre>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb432-1" title="1">y_pred_inverse_gaussian_train =<span class="st"> </span><span class="kw">predict.glm</span>(model_inverse_gaussian_deg_Mg_pH10,</a>
<a class="sourceLine" id="cb432-2" title="2">                                            data_train, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb432-3" title="3">error_inverse_gaussian_train &lt;-</a>
<a class="sourceLine" id="cb432-4" title="4"><span class="st">  </span><span class="kw">mean</span>((y_pred_inverse_gaussian_train<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb432-5" title="5"><span class="kw">print</span>(error_inverse_gaussian_train)</a></code></pre></div>
<pre><code>## [1] 0.2126698</code></pre>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb434-1" title="1">y_pred_inverse_gaussian_val =<span class="st"> </span><span class="kw">predict.glm</span>(model_inverse_gaussian_deg_Mg_pH10,</a>
<a class="sourceLine" id="cb434-2" title="2">                                          data_val, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb434-3" title="3">error_inverse_gaussian_val &lt;-</a>
<a class="sourceLine" id="cb434-4" title="4"><span class="st">  </span><span class="kw">mean</span>((y_pred_inverse_gaussian_val <span class="op">-</span><span class="st"> </span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb434-5" title="5"><span class="kw">print</span>(error_inverse_gaussian_val)</a></code></pre></div>
<pre><code>## [1] 0.2066344</code></pre>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb436-1" title="1">models_deg_Mg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_Mg_pH10, <span class="st">&quot;model_inverse_gaussian&quot;</span>)</a>
<a class="sourceLine" id="cb436-2" title="2">errors_deg_Mg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_pH10_train, error_inverse_gaussian_train)</a>
<a class="sourceLine" id="cb436-3" title="3">errors_deg_Mg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_pH10_val, error_inverse_gaussian_val)</a>
<a class="sourceLine" id="cb436-4" title="4"><span class="kw">rm</span>(error_inverse_gaussian_val, error_inverse_gaussian_train,</a>
<a class="sourceLine" id="cb436-5" title="5">   y_pred_inverse_gaussian_train, y_pred_inverse_gaussian_val)</a></code></pre></div>
<div id="stepaic-3" class="section level5">
<h5>StepAIC</h5>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb437-1" title="1">model_inverse_gaussian_deg_Mg_pH10_aic =</a>
<a class="sourceLine" id="cb437-2" title="2"><span class="st">  </span><span class="kw">stepAIC</span>(model_inverse_gaussian_deg_Mg_pH10, <span class="dt">trace =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>Pas de changement du modèle. Cela est sûrement dû au fait qu’on n’a pas assez de variables initialement.</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb438-1" title="1"><span class="kw">summary</span>(model_inverse_gaussian_deg_Mg_pH10_aic)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = deg_Mg_pH10 ~ sequence + struct_be + struct_af + 
##     index_sequence + structure, family = inverse.gaussian, data = data_train)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1e+06  -1e+00   0e+00   0e+00   4e+00  
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     2.8077551  0.0234182 119.896  &lt; 2e-16 ***
## sequenceC       0.2486705  0.0223982  11.102  &lt; 2e-16 ***
## sequenceG      -0.4523499  0.0127583 -35.455  &lt; 2e-16 ***
## sequenceU      -0.3059426  0.0175926 -17.390  &lt; 2e-16 ***
## struct_be)     -0.4295865  0.0290071 -14.810  &lt; 2e-16 ***
## struct_be.     -0.3919994  0.0208001 -18.846  &lt; 2e-16 ***
## struct_beO      0.4758086  0.0516987   9.203  &lt; 2e-16 ***
## struct_af)     -0.0105364  0.0314420  -0.335    0.738    
## struct_af.     -0.5306382  0.0224200 -23.668  &lt; 2e-16 ***
## struct_afO     -1.2600048  0.0486510 -25.899  &lt; 2e-16 ***
## index_sequence  0.0139724  0.0003256  42.909  &lt; 2e-16 ***
## structure)     -0.2526664  0.0392453  -6.438 1.22e-10 ***
## structure.     -1.1645637  0.0284536 -40.928  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for inverse.gaussian family taken to be 0.6389812)
## 
##     Null deviance: 1e+12  on 86427  degrees of freedom
## Residual deviance: 1e+12  on 86415  degrees of freedom
## AIC: 1535398
## 
## Number of Fisher Scoring iterations: 3</code></pre>
<p>Pas de changement sur les performances de prédiction.</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb440-1" title="1">y_pred_inverse_gaussian_train_aic =<span class="st"> </span><span class="kw">predict.glm</span>(model_inverse_gaussian_deg_Mg_pH10_aic,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb440-2" title="2"><span class="kw">mean</span>((y_pred_inverse_gaussian_train_aic<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2126698</code></pre>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb442-1" title="1">y_pred_inverse_gaussian_val_aic=<span class="kw">predict.glm</span>(model_inverse_gaussian_deg_Mg_pH10_aic,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb442-2" title="2"><span class="kw">mean</span>((y_pred_inverse_gaussian_val_aic<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2066344</code></pre>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb444-1" title="1"><span class="kw">rm</span>(model_inverse_gaussian_deg_Mg_pH10_aic, y_pred_inverse_gaussian_train_aic,</a>
<a class="sourceLine" id="cb444-2" title="2">   y_pred_inverse_gaussian_val_aic)</a></code></pre></div>
<p>On va maintenant tester des pénalisations ridge, lasso et elastic-net.</p>
</div>
<div id="pénalisation-ridge-et-lasso-3" class="section level5">
<h5>Pénalisation ridge et lasso</h5>
<p>On commence par calculer la matrice de design du model_inverse_gaussian_deg_Mg_pH10 sur le train et le test.</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb445-1" title="1"><span class="co"># Matrice de design du train</span></a>
<a class="sourceLine" id="cb445-2" title="2">data_train_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_inverse_gaussian_deg_Mg_pH10)</a>
<a class="sourceLine" id="cb445-3" title="3"><span class="co">#head(data_train_pen)</span></a></code></pre></div>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb446-1" title="1"><span class="co"># Pour faire la matrice de design de la validation</span></a>
<a class="sourceLine" id="cb446-2" title="2">model_inverse_gaussian_deg_Mg_pH10_val =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_inverse_gaussian_deg_Mg_pH10,</a>
<a class="sourceLine" id="cb446-3" title="3">                                             <span class="dt">family =</span> inverse.gaussian, <span class="dt">data =</span> data_val)</a>
<a class="sourceLine" id="cb446-4" title="4">data_val_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_inverse_gaussian_deg_Mg_pH10_val)</a>
<a class="sourceLine" id="cb446-5" title="5"><span class="co">#head(data_val_pen)</span></a>
<a class="sourceLine" id="cb446-6" title="6"></a>
<a class="sourceLine" id="cb446-7" title="7"><span class="co"># On supprime le modèle sur le test</span></a>
<a class="sourceLine" id="cb446-8" title="8"><span class="kw">rm</span>(model_inverse_gaussian_deg_Mg_pH10_val)</a></code></pre></div>
<p>On pénalise le model_inverse_gaussian_deg_Mg_pH10 avec une pénalité ridge. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb447-1" title="1"><span class="co">#model_inverse_gaussian_deg_Mg_pH10_pen_ridge = cv.glmnet(data_train_pen, data_train$deg_Mg_pH10,</span></a>
<a class="sourceLine" id="cb447-2" title="2"><span class="co">#                                             family = inverse.gaussian, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb447-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 0)</span></a>
<a class="sourceLine" id="cb447-4" title="4"><span class="co">## lambda.min est le lambda qui minimise l&#39;erreur de cross validation</span></a>
<a class="sourceLine" id="cb447-5" title="5"><span class="co">#coef(model_inverse_gaussian_deg_Mg_pH10_pen_ridge, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb448-1" title="1"><span class="co">#saveRDS(model_inverse_gaussian_deg_Mg_pH10_pen_ridge,</span></a>
<a class="sourceLine" id="cb448-2" title="2"><span class="co">#        &quot;model_inverse_gaussian_deg_Mg_pH10_pen_ridge.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb449-1" title="1">model_inverse_gaussian_deg_Mg_pH10_pen_ridge &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb449-2" title="2"><span class="st">  </span><span class="kw">readRDS</span>(<span class="st">&quot;model_inverse_gaussian_deg_Mg_pH10_pen_ridge.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation ridge.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb450-1" title="1">y_pred_ridge_inverse_gaussian_train =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_Mg_pH10_pen_ridge,</a>
<a class="sourceLine" id="cb450-2" title="2">                                              data_train_pen,</a>
<a class="sourceLine" id="cb450-3" title="3">                                              <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb450-4" title="4">y_pred_ridge_inverse_gaussian_val =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_Mg_pH10_pen_ridge,</a>
<a class="sourceLine" id="cb450-5" title="5">                                            data_val_pen,</a>
<a class="sourceLine" id="cb450-6" title="6">                                            <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb450-7" title="7"></a>
<a class="sourceLine" id="cb450-8" title="8">error_ridge_inverse_gaussian_train &lt;-</a>
<a class="sourceLine" id="cb450-9" title="9"><span class="st">  </span><span class="kw">mean</span>((y_pred_ridge_inverse_gaussian_train<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb450-10" title="10"><span class="kw">print</span>(error_ridge_inverse_gaussian_train)</a></code></pre></div>
<pre><code>## [1] 0.2682107</code></pre>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb452-1" title="1">error_ridge_inverse_gaussian_val &lt;-</a>
<a class="sourceLine" id="cb452-2" title="2"><span class="st">  </span><span class="kw">mean</span>((y_pred_ridge_inverse_gaussian_val<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb452-3" title="3"><span class="kw">print</span>(error_ridge_inverse_gaussian_val)</a></code></pre></div>
<pre><code>## [1] 0.2682879</code></pre>
<p>On pénalise le model_inverse_gaussian_deg_Mg_pH10 avec une pénalité lasso. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb454-1" title="1"><span class="co">#model_inverse_gaussian_deg_Mg_pH10_pen_lasso = cv.glmnet(data_train_pen, data_train$deg_Mg_pH10,</span></a>
<a class="sourceLine" id="cb454-2" title="2"><span class="co">#                                             family = inverse.gaussian, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb454-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 1)</span></a>
<a class="sourceLine" id="cb454-4" title="4"><span class="co">#coef(model_inverse_gaussian_deg_Mg_pH10_pen_lasso, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb455-1" title="1"><span class="co">#saveRDS(model_inverse_gaussian_deg_Mg_pH10_pen_lasso,</span></a>
<a class="sourceLine" id="cb455-2" title="2"><span class="co">#        &quot;model_inverse_gaussian_deg_Mg_pH10_pen_lasso.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb456-1" title="1">model_inverse_gaussian_deg_Mg_pH10_pen_lasso &lt;-</a>
<a class="sourceLine" id="cb456-2" title="2"><span class="st">  </span><span class="kw">readRDS</span>(<span class="st">&quot;model_inverse_gaussian_deg_Mg_pH10_pen_lasso.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation lasso.</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb457-1" title="1">y_pred_lasso_inverse_gaussian_train =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_Mg_pH10_pen_lasso,</a>
<a class="sourceLine" id="cb457-2" title="2">                                              data_train_pen,</a>
<a class="sourceLine" id="cb457-3" title="3">                                              <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb457-4" title="4">error_lasso_inverse_gaussian_train &lt;-</a>
<a class="sourceLine" id="cb457-5" title="5"><span class="st">  </span><span class="kw">mean</span>((y_pred_lasso_inverse_gaussian_train<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb457-6" title="6"><span class="kw">print</span>(error_lasso_inverse_gaussian_train)</a></code></pre></div>
<pre><code>## [1] 0.2655441</code></pre>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb459-1" title="1">y_pred_lasso_inverse_gaussian_val =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_Mg_pH10_pen_lasso,</a>
<a class="sourceLine" id="cb459-2" title="2">                                            data_val_pen,</a>
<a class="sourceLine" id="cb459-3" title="3">                                            <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb459-4" title="4">error_lasso_inverse_gaussian_val &lt;-</a>
<a class="sourceLine" id="cb459-5" title="5"><span class="st">  </span><span class="kw">mean</span>((y_pred_lasso_inverse_gaussian_val<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb459-6" title="6"><span class="kw">print</span>(error_lasso_inverse_gaussian_val)</a></code></pre></div>
<pre><code>## [1] 0.2654918</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb461-1" title="1">models_deg_Mg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_Mg_pH10, <span class="st">&quot;model_inverse_gaussian_ridge&quot;</span>, <span class="st">&quot;model_inverse_gaussian_lasso&quot;</span>)</a>
<a class="sourceLine" id="cb461-2" title="2">errors_deg_Mg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_pH10_train, error_ridge_inverse_gaussian_train,</a>
<a class="sourceLine" id="cb461-3" title="3">                             error_lasso_inverse_gaussian_train)</a>
<a class="sourceLine" id="cb461-4" title="4">errors_deg_Mg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_pH10_val, error_ridge_inverse_gaussian_val, error_lasso_inverse_gaussian_val)</a>
<a class="sourceLine" id="cb461-5" title="5"><span class="kw">rm</span>(error_ridge_inverse_gaussian_val, error_lasso_inverse_gaussian_val,</a>
<a class="sourceLine" id="cb461-6" title="6">   error_ridge_inverse_gaussian_train, error_lasso_inverse_gaussian_train,</a>
<a class="sourceLine" id="cb461-7" title="7">   y_pred_ridge_inverse_gaussian_train, y_pred_ridge_inverse_gaussian_val,</a>
<a class="sourceLine" id="cb461-8" title="8">   y_pred_lasso_inverse_gaussian_train, y_pred_lasso_inverse_gaussian_val)</a></code></pre></div>
</div>
<div id="pénalisation-elastic-net-3" class="section level5">
<h5>Pénalisation elastic-net</h5>
<p>On choisit <span class="math inline">\(\alpha\)</span> qui minimise le MSE sur la validation.</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb462-1" title="1"><span class="co">#alpha_opti_enet_inverse_gaussian_deg_Mg_pH10 =</span></a>
<a class="sourceLine" id="cb462-2" title="2"><span class="co">#  alpha_opti_enet(data_train = data_train_pen, data_val = data_val_pen,</span></a>
<a class="sourceLine" id="cb462-3" title="3"><span class="co">#                  y_true_train = data_train$deg_Mg_pH10,</span></a>
<a class="sourceLine" id="cb462-4" title="4"><span class="co">#                  y_true_val = data_val$deg_Mg_pH10,</span></a>
<a class="sourceLine" id="cb462-5" title="5"><span class="co">#                  family = inverse.gaussian, cores = detectCores() - 2)</span></a></code></pre></div>
<p>Au final, le meilleur modèle est le lasso.</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb463-1" title="1"><span class="co">#print(alpha_opti_enet_inverse_gaussian_deg_Mg_pH10)</span></a></code></pre></div>
<p>On construit le modèle avec le choix optimal pour <span class="math inline">\(\alpha\)</span>.</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb464-1" title="1"><span class="co">#model_inverse_gaussian_deg_Mg_pH10_pen_enet = cv.glmnet(data_train_pen, data_train$deg_Mg_pH10,</span></a>
<a class="sourceLine" id="cb464-2" title="2"><span class="co">#                                             family = inverse.gaussian, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb464-3" title="3"><span class="co">#                                             standardize = FALSE,</span></a>
<a class="sourceLine" id="cb464-4" title="4"><span class="co">#                                             alpha = alpha_opti_enet_inverse_gaussian_deg_Mg_pH10)</span></a>
<a class="sourceLine" id="cb464-5" title="5"><span class="co">#coef(model_inverse_gaussian_deg_Mg_pH10_pen_enet, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb465-1" title="1"><span class="co">#saveRDS(model_inverse_gaussian_deg_Mg_pH10_pen_enet,</span></a>
<a class="sourceLine" id="cb465-2" title="2"><span class="co">#        &quot;model_inverse_gaussian_deg_Mg_pH10_pen_enet.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb466-1" title="1">model_inverse_gaussian_deg_Mg_pH10_pen_enet &lt;-</a>
<a class="sourceLine" id="cb466-2" title="2"><span class="st">  </span><span class="kw">readRDS</span>(<span class="st">&quot;model_inverse_gaussian_deg_Mg_pH10_pen_enet.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation elastic-net.</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb467-1" title="1">y_pred_enet_inverse_gaussian_train =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_Mg_pH10_pen_enet,</a>
<a class="sourceLine" id="cb467-2" title="2">                                             data_train_pen,</a>
<a class="sourceLine" id="cb467-3" title="3">                                             <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb467-4" title="4">error_enet_inverse_gaussian_train &lt;-</a>
<a class="sourceLine" id="cb467-5" title="5"><span class="st">  </span><span class="kw">mean</span>((y_pred_enet_inverse_gaussian_train <span class="op">-</span><span class="st"> </span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb467-6" title="6"><span class="kw">print</span>(error_enet_inverse_gaussian_train)</a></code></pre></div>
<pre><code>## [1] 0.2655441</code></pre>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb469-1" title="1">y_pred_enet_inverse_gaussian_val =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_Mg_pH10_pen_enet,</a>
<a class="sourceLine" id="cb469-2" title="2">                                           data_val_pen,</a>
<a class="sourceLine" id="cb469-3" title="3">                                           <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb469-4" title="4">error_enet_inverse_gaussian_val &lt;-</a>
<a class="sourceLine" id="cb469-5" title="5"><span class="st">  </span><span class="kw">mean</span>((y_pred_enet_inverse_gaussian_val <span class="op">-</span><span class="st"> </span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb469-6" title="6"><span class="kw">print</span>(error_enet_inverse_gaussian_val)</a></code></pre></div>
<pre><code>## [1] 0.2654918</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb471-1" title="1">models_deg_Mg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_Mg_pH10, <span class="st">&quot;model_inverse_gaussian_enet&quot;</span>)</a>
<a class="sourceLine" id="cb471-2" title="2">errors_deg_Mg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_pH10_train, error_enet_inverse_gaussian_train)</a>
<a class="sourceLine" id="cb471-3" title="3">errors_deg_Mg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_pH10_val, error_enet_inverse_gaussian_val)</a>
<a class="sourceLine" id="cb471-4" title="4"><span class="kw">rm</span>(error_enet_inverse_gaussian_train, error_enet_inverse_gaussian_val,</a>
<a class="sourceLine" id="cb471-5" title="5">   y_pred_enet_inverse_gaussian_train, y_pred_enet_inverse_gaussian_val)</a></code></pre></div>
</div>
</div>
</div>
<div id="récapitulatif-des-résultats-1" class="section level3">
<h3>Récapitulatif des résultats</h3>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb472-1" title="1">models_deg_Mg_pH10_errors_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(models_deg_Mg_pH10,</a>
<a class="sourceLine" id="cb472-2" title="2">                                          errors_deg_Mg_pH10_train,</a>
<a class="sourceLine" id="cb472-3" title="3">                                          errors_deg_Mg_pH10_val)</a></code></pre></div>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb473-1" title="1">models_deg_Mg_pH10_errors_df</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["models_deg_Mg_pH10"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_deg_Mg_pH10_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_deg_Mg_pH10_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma","2":"0.1881872","3":"0.1830101"},{"1":"model_gamma_ridge","2":"0.2158509","3":"0.2132939"},{"1":"model_gamma_lasso","2":"0.1881508","3":"0.1828771"},{"1":"model_gamma_enet","2":"0.1881386","3":"0.1829963"},{"1":"model_inverse_gaussian","2":"0.2126698","3":"0.2066344"},{"1":"model_inverse_gaussian_ridge","2":"0.2682107","3":"0.2682879"},{"1":"model_inverse_gaussian_lasso","2":"0.2655441","3":"0.2654918"},{"1":"model_inverse_gaussian_enet","2":"0.2655441","3":"0.2654918"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Le meilleur modèle (au sens de la minimisation du MSE sur la validation) est le <code>model_gamma_enet</code>. Ainsi, la pénalisation a permis d’améliorer légèrement les performances ici.</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb474-1" title="1">models_deg_Mg_pH10_errors_df[<span class="kw">which.min</span>(errors_deg_Mg_pH10_val), ]</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["models_deg_Mg_pH10"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_deg_Mg_pH10_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_deg_Mg_pH10_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma_lasso","2":"0.1881508","3":"0.1828771","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="deg_ph10" class="section level2">
<h2>deg_pH10</h2>
<div id="loi-gamma-2" class="section level3">
<h3>Loi Gamma</h3>
<p>Ici on fera énormément de tests pour essayer de voir quels variables apportent des informations utiles.</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb475-1" title="1">model=<span class="kw">glm</span>(deg_pH10<span class="op">~</span>sequence,<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb475-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb475-3" title="3"></a>
<a class="sourceLine" id="cb475-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb475-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.3120218</code></pre>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb477-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb477-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.3162245</code></pre>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb479-1" title="1">model=<span class="kw">glm</span>(deg_pH10<span class="op">~</span>(sequence<span class="op">+</span>seq_be<span class="op">+</span>seq_af),<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb479-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb479-3" title="3"></a>
<a class="sourceLine" id="cb479-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb479-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2393905</code></pre>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb481-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb481-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2399885</code></pre>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb483-1" title="1">model=<span class="kw">glm</span>(deg_pH10<span class="op">~</span>sequence<span class="op">+</span>index_sequence,<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb483-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb483-3" title="3"></a>
<a class="sourceLine" id="cb483-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb483-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2748455</code></pre>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb485-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb485-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2781491</code></pre>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb487-1" title="1">model=<span class="kw">glm</span>(deg_pH10<span class="op">~</span>sequence<span class="op">+</span>predicted_loop_type<span class="op">+</span>index_sequence,<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb487-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb487-3" title="3">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb487-4" title="4"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2001317</code></pre>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb489-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb489-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1974088</code></pre>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb491-1" title="1">model=<span class="kw">glm</span>(deg_pH10<span class="op">~</span>sequence<span class="op">+</span>structure<span class="op">+</span>index_sequence,<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb491-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb491-3" title="3"></a>
<a class="sourceLine" id="cb491-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb491-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2214398</code></pre>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb493-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb493-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2200763</code></pre>
<p>AUTRES ESSAIS</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb495-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span></a>
<a class="sourceLine" id="cb495-2" title="2"><span class="st">              </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb495-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb495-4" title="4"></a>
<a class="sourceLine" id="cb495-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb495-6" title="6"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2824998</code></pre>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb497-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb497-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2914631</code></pre>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb499-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span></a>
<a class="sourceLine" id="cb499-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb499-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb499-4" title="4"></a>
<a class="sourceLine" id="cb499-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb499-6" title="6"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2524331</code></pre>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb501-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb501-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2613151</code></pre>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb503-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span></a>
<a class="sourceLine" id="cb503-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb503-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb503-4" title="4"></a>
<a class="sourceLine" id="cb503-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb503-6" title="6"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2813877</code></pre>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb505-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb505-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2887207</code></pre>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb507-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span></a>
<a class="sourceLine" id="cb507-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb507-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb507-4" title="4"></a>
<a class="sourceLine" id="cb507-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb509-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2839505</code></pre>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb511-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb513-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2900048</code></pre>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb515-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span></a>
<a class="sourceLine" id="cb515-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb515-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb515-4" title="4"></a>
<a class="sourceLine" id="cb515-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb515-6" title="6"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2529421</code></pre>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb517-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb517-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.26361</code></pre>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb519-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span></a>
<a class="sourceLine" id="cb519-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb519-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb519-4" title="4"></a>
<a class="sourceLine" id="cb519-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb521-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2315431</code></pre>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb523-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb525-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.241908</code></pre>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb527-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>predicted_loop_type <span class="op">+</span></a>
<a class="sourceLine" id="cb527-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb527-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb527-4" title="4"></a>
<a class="sourceLine" id="cb527-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb529-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2790267</code></pre>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb531-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb533-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2888508</code></pre>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb535-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span><span class="st"> </span>predicted_loop_type <span class="op">+</span></a>
<a class="sourceLine" id="cb535-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb535-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb535-4" title="4"></a>
<a class="sourceLine" id="cb535-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb537-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.231591</code></pre>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb539-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb541-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2463595</code></pre>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb543-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span><span class="st"> </span>predicted_loop_type <span class="op">+</span></a>
<a class="sourceLine" id="cb543-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb543-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb543-4" title="4"></a>
<a class="sourceLine" id="cb543-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb545-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2476522</code></pre>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb547-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb549-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2599749</code></pre>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb551-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span><span class="st"> </span>predicted_loop_type <span class="op">+</span></a>
<a class="sourceLine" id="cb551-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb551-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb551-4" title="4"></a>
<a class="sourceLine" id="cb551-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb553-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.283485</code></pre>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb555-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb557-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.293736</code></pre>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb559-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span><span class="st"> </span>predicted_loop_type <span class="op">+</span></a>
<a class="sourceLine" id="cb559-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb559-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb559-4" title="4"></a>
<a class="sourceLine" id="cb559-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb561-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.221361</code></pre>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb563-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb565-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2226565</code></pre>
<div id="optimisation-4" class="section level4">
<h4>Optimisation</h4>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb567-1" title="1">formula_gamma_deg_pH10 =</a>
<a class="sourceLine" id="cb567-2" title="2"><span class="st">  &quot;deg_pH10 ~ sequence + predicted_loop_type + index_sequence&quot;</span></a></code></pre></div>
<p>On stocke le meilleur modèle pour la loi gamma.</p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb568-1" title="1">model_gamma_deg_pH10 =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_gamma_deg_pH10,</a>
<a class="sourceLine" id="cb568-2" title="2">                             <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a></code></pre></div>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb569-1" title="1"><span class="kw">summary</span>(model_gamma_deg_pH10)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = formula_gamma_deg_pH10, family = Gamma, data = data_train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -7.2743  -0.2801  -0.1082   0.1351   4.6195  
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           8.891e-01  1.035e-02  85.941   &lt;2e-16 ***
## sequenceC            -9.659e-02  4.690e-03 -20.596   &lt;2e-16 ***
## sequenceG            -2.412e-01  3.410e-03 -70.730   &lt;2e-16 ***
## sequenceU            -1.227e-01  4.764e-03 -25.768   &lt;2e-16 ***
## predicted_loop_typeE -1.755e-01  1.021e-02 -17.197   &lt;2e-16 ***
## predicted_loop_typeH  6.276e-02  1.058e-02   5.932    3e-09 ***
## predicted_loop_typeI  1.959e-01  1.125e-02  17.413   &lt;2e-16 ***
## predicted_loop_typeM -1.129e-01  1.206e-02  -9.366   &lt;2e-16 ***
## predicted_loop_typeS  3.962e-01  1.015e-02  39.048   &lt;2e-16 ***
## predicted_loop_typeX -2.409e-01  1.160e-02 -20.769   &lt;2e-16 ***
## index_sequence        4.822e-03  8.538e-05  56.481   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.1703881)
## 
##     Null deviance: 18742  on 86427  degrees of freedom
## Residual deviance: 11607  on 86417  degrees of freedom
## AIC: 45465
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb571-1" title="1">y_pred_gamma_train =<span class="st"> </span><span class="kw">predict.glm</span>(model_gamma_deg_pH10,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb571-2" title="2">error_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb571-3" title="3"><span class="kw">print</span>(error_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.2001317</code></pre>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb573-1" title="1">y_pred_gamma_val=<span class="kw">predict.glm</span>(model_gamma_deg_pH10,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb573-2" title="2">error_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb573-3" title="3"><span class="kw">print</span>(error_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1974088</code></pre>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb575-1" title="1">models_deg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_pH10, <span class="st">&quot;model_gamma&quot;</span>)</a>
<a class="sourceLine" id="cb575-2" title="2">errors_deg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_pH10_train, error_gamma_train)</a>
<a class="sourceLine" id="cb575-3" title="3">errors_deg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_pH10_val, error_gamma_val)</a>
<a class="sourceLine" id="cb575-4" title="4"><span class="kw">rm</span>(error_gamma_val, error_gamma_train, y_pred_gamma_train, y_pred_gamma_val)</a></code></pre></div>
<div id="stepaic-4" class="section level5">
<h5>StepAIC</h5>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb576-1" title="1">model_gamma_deg_pH10_aic =<span class="st"> </span><span class="kw">stepAIC</span>(model_gamma_deg_pH10, <span class="dt">trace =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>Pas de changement du modèle. Cela est sûrement dû au fait qu’on n’a pas assez de variables initialement.</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb577-1" title="1"><span class="kw">summary</span>(model_gamma_deg_pH10_aic)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = deg_pH10 ~ sequence + predicted_loop_type + index_sequence, 
##     family = Gamma, data = data_train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -7.2743  -0.2801  -0.1082   0.1351   4.6195  
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           8.891e-01  1.035e-02  85.941   &lt;2e-16 ***
## sequenceC            -9.659e-02  4.690e-03 -20.596   &lt;2e-16 ***
## sequenceG            -2.412e-01  3.410e-03 -70.730   &lt;2e-16 ***
## sequenceU            -1.227e-01  4.764e-03 -25.768   &lt;2e-16 ***
## predicted_loop_typeE -1.755e-01  1.021e-02 -17.197   &lt;2e-16 ***
## predicted_loop_typeH  6.276e-02  1.058e-02   5.932    3e-09 ***
## predicted_loop_typeI  1.959e-01  1.125e-02  17.413   &lt;2e-16 ***
## predicted_loop_typeM -1.129e-01  1.206e-02  -9.366   &lt;2e-16 ***
## predicted_loop_typeS  3.962e-01  1.015e-02  39.048   &lt;2e-16 ***
## predicted_loop_typeX -2.409e-01  1.160e-02 -20.769   &lt;2e-16 ***
## index_sequence        4.822e-03  8.538e-05  56.481   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.1703881)
## 
##     Null deviance: 18742  on 86427  degrees of freedom
## Residual deviance: 11607  on 86417  degrees of freedom
## AIC: 45465
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Pas de changement sur les performances de prédiction.</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb579-1" title="1">y_pred_gamma_train_aic =<span class="st"> </span><span class="kw">predict.glm</span>(model_gamma_deg_pH10_aic,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb579-2" title="2"><span class="kw">mean</span>((y_pred_gamma_train_aic<span class="op">-</span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2001317</code></pre>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb581-1" title="1">y_pred_gamma_val_aic=<span class="kw">predict.glm</span>(model_gamma_deg_pH10_aic,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb581-2" title="2"><span class="kw">mean</span>((y_pred_gamma_val_aic<span class="op">-</span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1974088</code></pre>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb583-1" title="1"><span class="kw">rm</span>(model_gamma_deg_pH10_aic, y_pred_gamma_train_aic, y_pred_gamma_val_aic)</a></code></pre></div>
<p>On va maintenant tester des pénalisations ridge, lasso et elastic-net.</p>
</div>
<div id="pénalisation-ridge-et-lasso-4" class="section level5">
<h5>Pénalisation ridge et lasso</h5>
<p>On commence par calculer la matrice de design du model_gamma_deg_pH10 sur le train et le test.</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb584-1" title="1"><span class="co"># Matrice de design du train</span></a>
<a class="sourceLine" id="cb584-2" title="2">data_train_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_gamma_deg_pH10)</a>
<a class="sourceLine" id="cb584-3" title="3"><span class="co">#head(data_train_pen)</span></a></code></pre></div>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb585-1" title="1"><span class="co"># Pour faire la matrice de design de la validation</span></a>
<a class="sourceLine" id="cb585-2" title="2">model_gamma_deg_pH10_val =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_gamma_deg_pH10,</a>
<a class="sourceLine" id="cb585-3" title="3">                                 <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_val)</a>
<a class="sourceLine" id="cb585-4" title="4">data_val_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_gamma_deg_pH10_val)</a>
<a class="sourceLine" id="cb585-5" title="5"><span class="co">#head(data_val_pen)</span></a>
<a class="sourceLine" id="cb585-6" title="6"></a>
<a class="sourceLine" id="cb585-7" title="7"><span class="co"># On supprime le modèle sur le test</span></a>
<a class="sourceLine" id="cb585-8" title="8"><span class="kw">rm</span>(model_gamma_deg_pH10_val)</a></code></pre></div>
<p>On pénalise le model_gamma_deg_pH10 avec une pénalité ridge. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb586-1" title="1"><span class="co">#model_gamma_deg_pH10_pen_ridge = cv.glmnet(data_train_pen, data_train$deg_pH10,</span></a>
<a class="sourceLine" id="cb586-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb586-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 0)</span></a>
<a class="sourceLine" id="cb586-4" title="4"><span class="co">## lambda.min est le lambda qui minimise l&#39;erreur de cross validation</span></a>
<a class="sourceLine" id="cb586-5" title="5"><span class="co">#coef(model_gamma_deg_pH10_pen_ridge, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb587-1" title="1"><span class="co">#saveRDS(model_gamma_deg_pH10_pen_ridge, &quot;model_gamma_deg_pH10_pen_ridge.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb588-1" title="1">model_gamma_deg_pH10_pen_ridge &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_pH10_pen_ridge.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation ridge.</p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb589-1" title="1">y_pred_ridge_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_pH10_pen_ridge, data_train_pen,</a>
<a class="sourceLine" id="cb589-2" title="2">                                   <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb589-3" title="3">y_pred_ridge_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_pH10_pen_ridge, data_val_pen,</a>
<a class="sourceLine" id="cb589-4" title="4">                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb589-5" title="5">error_ridge_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_ridge_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb589-6" title="6"><span class="kw">print</span>(error_ridge_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.241403</code></pre>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb591-1" title="1">error_ridge_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_ridge_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb591-2" title="2"><span class="kw">print</span>(error_ridge_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.2423041</code></pre>
<p>On pénalise le model_gamma_deg_pH10 avec une pénalité lasso. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb593-1" title="1"><span class="co">#model_gamma_deg_pH10_pen_lasso = cv.glmnet(data_train_pen, data_train$deg_pH10,</span></a>
<a class="sourceLine" id="cb593-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb593-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 1)</span></a>
<a class="sourceLine" id="cb593-4" title="4"><span class="co">#coef(model_gamma_deg_pH10_pen_lasso, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb594-1" title="1"><span class="co">#saveRDS(model_gamma_deg_pH10_pen_lasso, &quot;model_gamma_deg_pH10_pen_lasso.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb595-1" title="1">model_gamma_deg_pH10_pen_lasso &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_pH10_pen_lasso.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation lasso.</p>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb596-1" title="1">y_pred_lasso_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_pH10_pen_lasso, data_train_pen,</a>
<a class="sourceLine" id="cb596-2" title="2">                                   <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb596-3" title="3">error_lasso_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_lasso_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb596-4" title="4"><span class="kw">print</span>(error_lasso_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.2007077</code></pre>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb598-1" title="1">y_pred_lasso_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_pH10_pen_lasso, data_val_pen,</a>
<a class="sourceLine" id="cb598-2" title="2">                                 <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb598-3" title="3">error_lasso_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_lasso_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb598-4" title="4"><span class="kw">print</span>(error_lasso_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1977433</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb600-1" title="1">models_deg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_pH10, <span class="st">&quot;model_gamma_ridge&quot;</span>, <span class="st">&quot;model_gamma_lasso&quot;</span>)</a>
<a class="sourceLine" id="cb600-2" title="2">errors_deg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_pH10_train, error_ridge_gamma_train,</a>
<a class="sourceLine" id="cb600-3" title="3">                             error_lasso_gamma_train)</a>
<a class="sourceLine" id="cb600-4" title="4">errors_deg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_pH10_val, error_ridge_gamma_val, error_lasso_gamma_val)</a>
<a class="sourceLine" id="cb600-5" title="5"><span class="kw">rm</span>(error_ridge_gamma_val, error_lasso_gamma_val,</a>
<a class="sourceLine" id="cb600-6" title="6">   error_ridge_gamma_train, error_lasso_gamma_train,</a>
<a class="sourceLine" id="cb600-7" title="7">   y_pred_ridge_gamma_train, y_pred_ridge_gamma_val,</a>
<a class="sourceLine" id="cb600-8" title="8">   y_pred_lasso_gamma_train, y_pred_lasso_gamma_val)</a></code></pre></div>
</div>
<div id="pénalisation-elastic-net-4" class="section level5">
<h5>Pénalisation elastic-net</h5>
<p>On choisit <span class="math inline">\(\alpha\)</span> qui minimise le MSE sur la validation.</p>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb601-1" title="1"><span class="co">#alpha_opti_enet_gamma_deg_pH10 =</span></a>
<a class="sourceLine" id="cb601-2" title="2"><span class="co">#  alpha_opti_enet(data_train = data_train_pen, data_val = data_val_pen,</span></a>
<a class="sourceLine" id="cb601-3" title="3"><span class="co">#                  y_true_train = data_train$deg_pH10,</span></a>
<a class="sourceLine" id="cb601-4" title="4"><span class="co">#                  y_true_val = data_val$deg_pH10,</span></a>
<a class="sourceLine" id="cb601-5" title="5"><span class="co">#                  family = Gamma, cores = detectCores() - 2)</span></a></code></pre></div>
<p>Au final, le meilleur modèle est le lasso.</p>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb602-1" title="1"><span class="co">#print(alpha_opti_enet_gamma_deg_pH10)</span></a></code></pre></div>
<p>On construit le modèle avec le choix optimal pour <span class="math inline">\(\alpha\)</span>.</p>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb603-1" title="1"><span class="co">#model_gamma_deg_pH10_pen_enet = cv.glmnet(data_train_pen, data_train$deg_pH10,</span></a>
<a class="sourceLine" id="cb603-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb603-3" title="3"><span class="co">#                                             standardize = FALSE,</span></a>
<a class="sourceLine" id="cb603-4" title="4"><span class="co">#                                             alpha = alpha_opti_enet_gamma_deg_pH10)</span></a>
<a class="sourceLine" id="cb603-5" title="5"><span class="co">#coef(model_gamma_deg_pH10_pen_enet, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb604-1" title="1"><span class="co">#saveRDS(model_gamma_deg_pH10_pen_enet, &quot;model_gamma_deg_pH10_pen_enet.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb605-1" title="1">model_gamma_deg_pH10_pen_enet &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_pH10_pen_enet.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation elastic-net.</p>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb606-1" title="1">y_pred_enet_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_pH10_pen_enet, data_train_pen,</a>
<a class="sourceLine" id="cb606-2" title="2">                                   <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb606-3" title="3">error_enet_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_enet_gamma_train <span class="op">-</span><span class="st"> </span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb606-4" title="4"><span class="kw">print</span>(error_enet_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.2007077</code></pre>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb608-1" title="1">y_pred_enet_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_pH10_pen_enet, data_val_pen,</a>
<a class="sourceLine" id="cb608-2" title="2">                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb608-3" title="3">error_enet_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_enet_gamma_val <span class="op">-</span><span class="st"> </span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb608-4" title="4"><span class="kw">print</span>(error_enet_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1977433</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb610-1" title="1">models_deg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_pH10, <span class="st">&quot;model_gamma_enet&quot;</span>)</a>
<a class="sourceLine" id="cb610-2" title="2">errors_deg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_pH10_train, error_enet_gamma_train)</a>
<a class="sourceLine" id="cb610-3" title="3">errors_deg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_pH10_val, error_enet_gamma_val)</a>
<a class="sourceLine" id="cb610-4" title="4"><span class="kw">rm</span>(error_enet_gamma_train, error_enet_gamma_val,</a>
<a class="sourceLine" id="cb610-5" title="5">   y_pred_enet_gamma_train, y_pred_enet_gamma_val)</a></code></pre></div>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb611-1" title="1"><span class="kw">data.frame</span>(models_deg_pH10, errors_deg_pH10_train, errors_deg_pH10_val)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["models_deg_pH10"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_deg_pH10_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_deg_pH10_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma","2":"0.2001317","3":"0.1974088"},{"1":"model_gamma_ridge","2":"0.2414030","3":"0.2423041"},{"1":"model_gamma_lasso","2":"0.2007077","3":"0.1977433"},{"1":"model_gamma_enet","2":"0.2007077","3":"0.1977433"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<div id="inverse.gaussian-2" class="section level3">
<h3>Inverse.gaussian</h3>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb612-1" title="1">model=<span class="kw">glm</span>(deg_pH10<span class="op">~</span>sequence,<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb612-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb612-3" title="3"></a>
<a class="sourceLine" id="cb612-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb612-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.3845807</code></pre>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb614-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb614-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.3923577</code></pre>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb616-1" title="1">model=<span class="kw">glm</span>(deg_pH10<span class="op">~</span>(sequence<span class="op">+</span>seq_be),<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb616-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb616-3" title="3"></a>
<a class="sourceLine" id="cb616-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb616-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.3009361</code></pre>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb618-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb618-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.3051934</code></pre>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb620-1" title="1">model=<span class="kw">glm</span>(deg_pH10<span class="op">~</span>index_sequence,<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb620-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb620-3" title="3"></a>
<a class="sourceLine" id="cb620-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb620-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2918146</code></pre>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb622-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb622-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2933634</code></pre>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb624-1" title="1">model=<span class="kw">glm</span>(deg_pH10<span class="op">~</span>sequence<span class="op">+</span>predicted_loop_type,<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb624-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb624-3" title="3">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb624-4" title="4"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2143404</code></pre>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb626-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb626-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1984605</code></pre>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb628-1" title="1">model=<span class="kw">glm</span>(deg_pH10<span class="op">~</span>sequence<span class="op">+</span>structure,<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb628-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb628-3" title="3"></a>
<a class="sourceLine" id="cb628-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb628-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2886531</code></pre>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb630-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb630-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2889241</code></pre>
<p>AUTRES ESSAIS</p>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb632-1" title="1"><span class="co">#model = glm(deg_pH10  ~ sequence + struct_be + struct_af +</span></a>
<a class="sourceLine" id="cb632-2" title="2"><span class="co">#              index_sequence + structure,</span></a>
<a class="sourceLine" id="cb632-3" title="3"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb632-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb632-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb632-6" title="6"><span class="co">#mean((y_pred-data_val$deg_Mg_pH10)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb632-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb632-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb632-9" title="9"><span class="co">#mean((y_pred-data_train$deg_Mg_pH10)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb633-1" title="1"><span class="co">#model = glm(deg_pH10  ~ sequence + seq_be + seq_af +</span></a>
<a class="sourceLine" id="cb633-2" title="2"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb633-3" title="3"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb633-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb633-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb633-6" title="6"><span class="co">#mean((y_pred-data_val$deg_Mg_pH10)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb633-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb633-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb633-9" title="9"><span class="co">#mean((y_pred-data_train$deg_Mg_pH10)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb634-1" title="1"><span class="co">#model = glm(deg_pH10  ~ sequence + seq_be + struct_af +</span></a>
<a class="sourceLine" id="cb634-2" title="2"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb634-3" title="3"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb634-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb634-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb634-6" title="6"><span class="co">#mean((y_pred-data_val$deg_Mg_pH10)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb634-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb634-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb634-9" title="9"><span class="co">#mean((y_pred-data_train$deg_Mg_pH10)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb635-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_pH10  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span></a>
<a class="sourceLine" id="cb635-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb635-3" title="3">            <span class="dt">family =</span> inverse.gaussian, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb635-4" title="4"></a>
<a class="sourceLine" id="cb635-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb637-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.3077923</code></pre>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb639-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb641-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.3165601</code></pre>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb643-1" title="1"><span class="co">#model = glm(deg_pH10  ~ sequence + seq_af + struct_be +</span></a>
<a class="sourceLine" id="cb643-2" title="2"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb643-3" title="3"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb643-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb643-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb643-6" title="6"><span class="co">#mean((y_pred-data_val$deg_Mg_pH10)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb643-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb643-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb643-9" title="9"><span class="co">#mean((y_pred-data_train$deg_Mg_pH10)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb644-1" title="1"><span class="co">#model = glm(deg_pH10  ~ sequence + seq_af + struct_af +</span></a>
<a class="sourceLine" id="cb644-2" title="2"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb644-3" title="3"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb644-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb644-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb644-6" title="6"><span class="co">#mean((y_pred-data_val$deg_Mg_pH10)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb644-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb644-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb644-9" title="9"><span class="co">#mean((y_pred-data_train$deg_Mg_pH10)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb645-1" title="1"><span class="co">#model = glm(deg_pH10  ~ sequence + seq_be + predicted_loop_type +</span></a>
<a class="sourceLine" id="cb645-2" title="2"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb645-3" title="3"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb645-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb645-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb645-6" title="6"><span class="co">#mean((y_pred-data_val$deg_Mg_pH10)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb645-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb645-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb645-9" title="9"><span class="co">#mean((y_pred-data_train$deg_Mg_pH10)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb646-1" title="1"><span class="co">#model = glm(deg_pH10  ~ sequence + seq_af + predicted_loop_type +</span></a>
<a class="sourceLine" id="cb646-2" title="2"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb646-3" title="3"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb646-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb646-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb646-6" title="6"><span class="co">#mean((y_pred-data_val$deg_Mg_pH10)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb646-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb646-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb646-9" title="9"><span class="co">#mean((y_pred-data_train$deg_Mg_pH10)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb647-1" title="1"><span class="co">#model = glm(deg_pH10  ~ sequence + seq_be + seq_af + predicted_loop_type +</span></a>
<a class="sourceLine" id="cb647-2" title="2"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb647-3" title="3"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb647-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb647-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb647-6" title="6"><span class="co">#mean((y_pred-data_val$deg_Mg_pH10)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb647-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb647-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb647-9" title="9"><span class="co">#mean((y_pred-data_train$deg_Mg_pH10)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb648-1" title="1"><span class="co">#model = glm(deg_pH10  ~ sequence + struct_be + predicted_loop_type +</span></a>
<a class="sourceLine" id="cb648-2" title="2"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb648-3" title="3"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb648-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb648-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb648-6" title="6"><span class="co">#mean((y_pred-data_val$deg_Mg_pH10)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb648-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb648-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb648-9" title="9"><span class="co">#mean((y_pred-data_train$deg_Mg_pH10)^2,na.rm=TRUE)</span></a></code></pre></div>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb649-1" title="1"><span class="co">#model = glm(deg_pH10  ~ sequence + struct_af + predicted_loop_type +</span></a>
<a class="sourceLine" id="cb649-2" title="2"><span class="co">#                         index_sequence + structure,</span></a>
<a class="sourceLine" id="cb649-3" title="3"><span class="co">#            family = inverse.gaussian, data = data_train)</span></a>
<a class="sourceLine" id="cb649-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb649-5" title="5"><span class="co">#y_pred=predict.glm(model,data_val,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb649-6" title="6"><span class="co">#mean((y_pred-data_val$deg_Mg_pH10)^2,na.rm=TRUE)</span></a>
<a class="sourceLine" id="cb649-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb649-8" title="8"><span class="co">#y_pred=predict.glm(model,data_train,type=&quot;response&quot;)</span></a>
<a class="sourceLine" id="cb649-9" title="9"><span class="co">#mean((y_pred-data_train$deg_Mg_pH10)^2,na.rm=TRUE)</span></a></code></pre></div>
<div id="optimisation-5" class="section level4">
<h4>Optimisation</h4>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb650-1" title="1">formula_inverse_gaussian_deg_pH10 =</a>
<a class="sourceLine" id="cb650-2" title="2"><span class="st">  &quot;deg_pH10 ~ sequence + predicted_loop_type&quot;</span></a></code></pre></div>
<p>On stocke le meilleur modèle pour la loi gamma.</p>
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb651-1" title="1">model_inverse_gaussian_deg_pH10 =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_inverse_gaussian_deg_pH10,</a>
<a class="sourceLine" id="cb651-2" title="2">                                        <span class="dt">family =</span> inverse.gaussian, <span class="dt">data =</span> data_train)</a></code></pre></div>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb652-1" title="1"><span class="kw">summary</span>(model_inverse_gaussian_deg_pH10)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = formula_inverse_gaussian_deg_pH10, family = inverse.gaussian, 
##     data = data_train)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1e+06   0e+00   0e+00   0e+00   3e+00  
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           0.954815   0.016312  58.535  &lt; 2e-16 ***
## sequenceC            -0.064910   0.008962  -7.243 4.42e-13 ***
## sequenceG            -0.428994   0.005027 -85.330  &lt; 2e-16 ***
## sequenceU            -0.198201   0.008122 -24.402  &lt; 2e-16 ***
## predicted_loop_typeE -0.353711   0.016381 -21.593  &lt; 2e-16 ***
## predicted_loop_typeH  0.141224   0.017555   8.045 8.77e-16 ***
## predicted_loop_typeI  0.370511   0.018964  19.537  &lt; 2e-16 ***
## predicted_loop_typeM -0.118239   0.019544  -6.050 1.45e-09 ***
## predicted_loop_typeS  0.754155   0.016848  44.763  &lt; 2e-16 ***
## predicted_loop_typeX -0.216949   0.018094 -11.990  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for inverse.gaussian family taken to be 0.2696578)
## 
##     Null deviance: 1e+12  on 86427  degrees of freedom
## Residual deviance: 1e+12  on 86418  degrees of freedom
## AIC: 1608587
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb654-1" title="1">y_pred_inverse_gaussian_train =<span class="st"> </span><span class="kw">predict.glm</span>(model_inverse_gaussian_deg_pH10,</a>
<a class="sourceLine" id="cb654-2" title="2">                                            data_train, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb654-3" title="3">error_inverse_gaussian_train &lt;-</a>
<a class="sourceLine" id="cb654-4" title="4"><span class="st">  </span><span class="kw">mean</span>((y_pred_inverse_gaussian_train<span class="op">-</span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb654-5" title="5"><span class="kw">print</span>(error_inverse_gaussian_train)</a></code></pre></div>
<pre><code>## [1] 0.2143404</code></pre>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb656-1" title="1">y_pred_inverse_gaussian_val =<span class="st"> </span><span class="kw">predict.glm</span>(model_inverse_gaussian_deg_pH10,</a>
<a class="sourceLine" id="cb656-2" title="2">                                          data_val, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb656-3" title="3">error_inverse_gaussian_val &lt;-</a>
<a class="sourceLine" id="cb656-4" title="4"><span class="st">  </span><span class="kw">mean</span>((y_pred_inverse_gaussian_val <span class="op">-</span><span class="st"> </span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb656-5" title="5"><span class="kw">print</span>(error_inverse_gaussian_val)</a></code></pre></div>
<pre><code>## [1] 0.1984605</code></pre>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb658-1" title="1">models_deg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_pH10, <span class="st">&quot;model_inverse_gaussian&quot;</span>)</a>
<a class="sourceLine" id="cb658-2" title="2">errors_deg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_pH10_train, error_inverse_gaussian_train)</a>
<a class="sourceLine" id="cb658-3" title="3">errors_deg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_pH10_val, error_inverse_gaussian_val)</a>
<a class="sourceLine" id="cb658-4" title="4"><span class="kw">rm</span>(error_inverse_gaussian_val, error_inverse_gaussian_train,</a>
<a class="sourceLine" id="cb658-5" title="5">   y_pred_inverse_gaussian_train, y_pred_inverse_gaussian_val)</a></code></pre></div>
<div id="stepaic-5" class="section level5">
<h5>StepAIC</h5>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb659-1" title="1">model_inverse_gaussian_deg_pH10_aic =</a>
<a class="sourceLine" id="cb659-2" title="2"><span class="st">  </span><span class="kw">stepAIC</span>(model_inverse_gaussian_deg_pH10, <span class="dt">trace =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>Pas de changement du modèle. Cela est sûrement dû au fait qu’on n’a pas assez de variables initialement.</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb660-1" title="1"><span class="kw">summary</span>(model_inverse_gaussian_deg_pH10_aic)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = deg_pH10 ~ sequence + predicted_loop_type, family = inverse.gaussian, 
##     data = data_train)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1e+06   0e+00   0e+00   0e+00   3e+00  
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           0.954815   0.016312  58.535  &lt; 2e-16 ***
## sequenceC            -0.064910   0.008962  -7.243 4.42e-13 ***
## sequenceG            -0.428994   0.005027 -85.330  &lt; 2e-16 ***
## sequenceU            -0.198201   0.008122 -24.402  &lt; 2e-16 ***
## predicted_loop_typeE -0.353711   0.016381 -21.593  &lt; 2e-16 ***
## predicted_loop_typeH  0.141224   0.017555   8.045 8.77e-16 ***
## predicted_loop_typeI  0.370511   0.018964  19.537  &lt; 2e-16 ***
## predicted_loop_typeM -0.118239   0.019544  -6.050 1.45e-09 ***
## predicted_loop_typeS  0.754155   0.016848  44.763  &lt; 2e-16 ***
## predicted_loop_typeX -0.216949   0.018094 -11.990  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for inverse.gaussian family taken to be 0.2696578)
## 
##     Null deviance: 1e+12  on 86427  degrees of freedom
## Residual deviance: 1e+12  on 86418  degrees of freedom
## AIC: 1608587
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<p>Pas de changement sur les performances de prédiction.</p>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb662-1" title="1">y_pred_inverse_gaussian_train_aic =<span class="st"> </span><span class="kw">predict.glm</span>(model_inverse_gaussian_deg_pH10_aic,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb662-2" title="2"><span class="kw">mean</span>((y_pred_inverse_gaussian_train_aic<span class="op">-</span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2143404</code></pre>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb664-1" title="1">y_pred_inverse_gaussian_val_aic=<span class="kw">predict.glm</span>(model_inverse_gaussian_deg_pH10_aic,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb664-2" title="2"><span class="kw">mean</span>((y_pred_inverse_gaussian_val_aic<span class="op">-</span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1984605</code></pre>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb666-1" title="1"><span class="kw">rm</span>(model_inverse_gaussian_deg_pH10_aic, y_pred_inverse_gaussian_train_aic, y_pred_inverse_gaussian_val_aic)</a></code></pre></div>
<p>On va maintenant tester des pénalisations ridge, lasso et elastic-net.</p>
</div>
<div id="pénalisation-ridge-et-lasso-5" class="section level5">
<h5>Pénalisation ridge et lasso</h5>
<p>On commence par calculer la matrice de design du model_inverse_gaussian_deg_pH10 sur le train et le test.</p>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb667-1" title="1"><span class="co"># Matrice de design du train</span></a>
<a class="sourceLine" id="cb667-2" title="2">data_train_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_inverse_gaussian_deg_pH10)</a>
<a class="sourceLine" id="cb667-3" title="3"><span class="co">#head(data_train_pen)</span></a></code></pre></div>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb668-1" title="1"><span class="co"># Pour faire la matrice de design de la validation</span></a>
<a class="sourceLine" id="cb668-2" title="2">model_inverse_gaussian_deg_pH10_val =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_inverse_gaussian_deg_pH10,</a>
<a class="sourceLine" id="cb668-3" title="3">                                 <span class="dt">family =</span> inverse.gaussian, <span class="dt">data =</span> data_val)</a>
<a class="sourceLine" id="cb668-4" title="4">data_val_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_inverse_gaussian_deg_pH10_val)</a>
<a class="sourceLine" id="cb668-5" title="5"><span class="co">#head(data_val_pen)</span></a>
<a class="sourceLine" id="cb668-6" title="6"></a>
<a class="sourceLine" id="cb668-7" title="7"><span class="co"># On supprime le modèle sur le test</span></a>
<a class="sourceLine" id="cb668-8" title="8"><span class="kw">rm</span>(model_inverse_gaussian_deg_pH10_val)</a></code></pre></div>
<p>On pénalise le model_inverse_gaussian_deg_pH10 avec une pénalité ridge. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb669-1" title="1"><span class="co">#model_inverse_gaussian_deg_pH10_pen_ridge = cv.glmnet(data_train_pen, data_train$deg_pH10,</span></a>
<a class="sourceLine" id="cb669-2" title="2"><span class="co">#                                             family = inverse.gaussian, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb669-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 0)</span></a>
<a class="sourceLine" id="cb669-4" title="4"><span class="co">## lambda.min est le lambda qui minimise l&#39;erreur de cross validation</span></a>
<a class="sourceLine" id="cb669-5" title="5"><span class="co">#coef(model_inverse_gaussian_deg_pH10_pen_ridge, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb670-1" title="1"><span class="co">#saveRDS(model_inverse_gaussian_deg_pH10_pen_ridge,</span></a>
<a class="sourceLine" id="cb670-2" title="2"><span class="co">#        &quot;model_inverse_gaussian_deg_pH10_pen_ridge.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb671-1" title="1">model_inverse_gaussian_deg_pH10_pen_ridge &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb671-2" title="2"><span class="st">  </span><span class="kw">readRDS</span>(<span class="st">&quot;model_inverse_gaussian_deg_pH10_pen_ridge.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation ridge.</p>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb672-1" title="1">y_pred_ridge_inverse_gaussian_train =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_pH10_pen_ridge,</a>
<a class="sourceLine" id="cb672-2" title="2">                                              data_train_pen,</a>
<a class="sourceLine" id="cb672-3" title="3">                                              <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb672-4" title="4">y_pred_ridge_inverse_gaussian_val =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_pH10_pen_ridge,</a>
<a class="sourceLine" id="cb672-5" title="5">                                            data_val_pen,</a>
<a class="sourceLine" id="cb672-6" title="6">                                            <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb672-7" title="7"></a>
<a class="sourceLine" id="cb672-8" title="8">error_ridge_inverse_gaussian_train &lt;-</a>
<a class="sourceLine" id="cb672-9" title="9"><span class="st">  </span><span class="kw">mean</span>((y_pred_ridge_inverse_gaussian_train<span class="op">-</span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb672-10" title="10"><span class="kw">print</span>(error_ridge_inverse_gaussian_train)</a></code></pre></div>
<pre><code>## [1] 0.3207168</code></pre>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb674-1" title="1">error_ridge_inverse_gaussian_val &lt;-</a>
<a class="sourceLine" id="cb674-2" title="2"><span class="st">  </span><span class="kw">mean</span>((y_pred_ridge_inverse_gaussian_val<span class="op">-</span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb674-3" title="3"><span class="kw">print</span>(error_ridge_inverse_gaussian_val)</a></code></pre></div>
<pre><code>## [1] 0.3245832</code></pre>
<p>On pénalise le model_inverse_gaussian_deg_pH10 avec une pénalité lasso. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb676-1" title="1"><span class="co">#model_inverse_gaussian_deg_pH10_pen_lasso = cv.glmnet(data_train_pen, data_train$deg_pH10,</span></a>
<a class="sourceLine" id="cb676-2" title="2"><span class="co">#                                             family = inverse.gaussian, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb676-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 1)</span></a>
<a class="sourceLine" id="cb676-4" title="4"><span class="co">#coef(model_inverse_gaussian_deg_pH10_pen_lasso, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb677-1" title="1"><span class="co">#saveRDS(model_inverse_gaussian_deg_pH10_pen_lasso,</span></a>
<a class="sourceLine" id="cb677-2" title="2"><span class="co">#        &quot;model_inverse_gaussian_deg_pH10_pen_lasso.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb678-1" title="1">model_inverse_gaussian_deg_pH10_pen_lasso &lt;-</a>
<a class="sourceLine" id="cb678-2" title="2"><span class="st">  </span><span class="kw">readRDS</span>(<span class="st">&quot;model_inverse_gaussian_deg_pH10_pen_lasso.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation lasso.</p>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb679-1" title="1">y_pred_lasso_inverse_gaussian_train =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_pH10_pen_lasso,</a>
<a class="sourceLine" id="cb679-2" title="2">                                              data_train_pen,</a>
<a class="sourceLine" id="cb679-3" title="3">                                              <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb679-4" title="4">error_lasso_inverse_gaussian_train &lt;-</a>
<a class="sourceLine" id="cb679-5" title="5"><span class="st">  </span><span class="kw">mean</span>((y_pred_lasso_inverse_gaussian_train<span class="op">-</span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb679-6" title="6"><span class="kw">print</span>(error_lasso_inverse_gaussian_train)</a></code></pre></div>
<pre><code>## [1] 0.2932353</code></pre>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb681-1" title="1">y_pred_lasso_inverse_gaussian_val =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_pH10_pen_lasso,</a>
<a class="sourceLine" id="cb681-2" title="2">                                            data_val_pen,</a>
<a class="sourceLine" id="cb681-3" title="3">                                            <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb681-4" title="4">error_lasso_inverse_gaussian_val &lt;-</a>
<a class="sourceLine" id="cb681-5" title="5"><span class="st">  </span><span class="kw">mean</span>((y_pred_lasso_inverse_gaussian_val<span class="op">-</span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb681-6" title="6"><span class="kw">print</span>(error_lasso_inverse_gaussian_val)</a></code></pre></div>
<pre><code>## [1] 0.2957803</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb683-1" title="1">models_deg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_pH10, <span class="st">&quot;model_inverse_gaussian_ridge&quot;</span>, <span class="st">&quot;model_inverse_gaussian_lasso&quot;</span>)</a>
<a class="sourceLine" id="cb683-2" title="2">errors_deg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_pH10_train, error_ridge_inverse_gaussian_train,</a>
<a class="sourceLine" id="cb683-3" title="3">                             error_lasso_inverse_gaussian_train)</a>
<a class="sourceLine" id="cb683-4" title="4">errors_deg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_pH10_val, error_ridge_inverse_gaussian_val, error_lasso_inverse_gaussian_val)</a>
<a class="sourceLine" id="cb683-5" title="5"><span class="kw">rm</span>(error_ridge_inverse_gaussian_val, error_lasso_inverse_gaussian_val,</a>
<a class="sourceLine" id="cb683-6" title="6">   error_ridge_inverse_gaussian_train, error_lasso_inverse_gaussian_train,</a>
<a class="sourceLine" id="cb683-7" title="7">   y_pred_ridge_inverse_gaussian_train, y_pred_ridge_inverse_gaussian_val,</a>
<a class="sourceLine" id="cb683-8" title="8">   y_pred_lasso_inverse_gaussian_train, y_pred_lasso_inverse_gaussian_val)</a></code></pre></div>
</div>
<div id="pénalisation-elastic-net-5" class="section level5">
<h5>Pénalisation elastic-net</h5>
<p>On choisit <span class="math inline">\(\alpha\)</span> qui minimise le MSE sur la validation.</p>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb684-1" title="1"><span class="co">#alpha_opti_enet_inverse_gaussian_deg_pH10 =</span></a>
<a class="sourceLine" id="cb684-2" title="2"><span class="co">#  alpha_opti_enet(data_train = data_train_pen, data_val = data_val_pen,</span></a>
<a class="sourceLine" id="cb684-3" title="3"><span class="co">#                  y_true_train = data_train$deg_pH10,</span></a>
<a class="sourceLine" id="cb684-4" title="4"><span class="co">#                  y_true_val = data_val$deg_pH10,</span></a>
<a class="sourceLine" id="cb684-5" title="5"><span class="co">#                  family = inverse.gaussian, cores = detectCores() - 2)</span></a></code></pre></div>
<p>Au final, le meilleur modèle est le lasso.</p>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb685-1" title="1"><span class="co">#print(alpha_opti_enet_inverse_gaussian_deg_pH10)</span></a></code></pre></div>
<p>On construit le modèle avec le choix optimal pour <span class="math inline">\(\alpha\)</span>.</p>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb686-1" title="1"><span class="co">#model_inverse_gaussian_deg_pH10_pen_enet = cv.glmnet(data_train_pen, data_train$deg_pH10,</span></a>
<a class="sourceLine" id="cb686-2" title="2"><span class="co">#                                             family = inverse.gaussian, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb686-3" title="3"><span class="co">#                                             standardize = FALSE,</span></a>
<a class="sourceLine" id="cb686-4" title="4"><span class="co">#                                             alpha = alpha_opti_enet_inverse_gaussian_deg_pH10)</span></a>
<a class="sourceLine" id="cb686-5" title="5"><span class="co">#coef(model_inverse_gaussian_deg_pH10_pen_enet, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb687-1" title="1"><span class="co">#saveRDS(model_inverse_gaussian_deg_pH10_pen_enet,</span></a>
<a class="sourceLine" id="cb687-2" title="2"><span class="co">#        &quot;model_inverse_gaussian_deg_pH10_pen_enet.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb688-1" title="1">model_inverse_gaussian_deg_pH10_pen_enet &lt;-</a>
<a class="sourceLine" id="cb688-2" title="2"><span class="st">  </span><span class="kw">readRDS</span>(<span class="st">&quot;model_inverse_gaussian_deg_pH10_pen_enet.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation elastic-net.</p>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb689-1" title="1">y_pred_enet_inverse_gaussian_train =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_pH10_pen_enet,</a>
<a class="sourceLine" id="cb689-2" title="2">                                             data_train_pen,</a>
<a class="sourceLine" id="cb689-3" title="3">                                             <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb689-4" title="4">error_enet_inverse_gaussian_train &lt;-</a>
<a class="sourceLine" id="cb689-5" title="5"><span class="st">  </span><span class="kw">mean</span>((y_pred_enet_inverse_gaussian_train <span class="op">-</span><span class="st"> </span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb689-6" title="6"><span class="kw">print</span>(error_enet_inverse_gaussian_train)</a></code></pre></div>
<pre><code>## [1] 0.2932353</code></pre>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb691-1" title="1">y_pred_enet_inverse_gaussian_val =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_pH10_pen_enet,</a>
<a class="sourceLine" id="cb691-2" title="2">                                           data_val_pen,</a>
<a class="sourceLine" id="cb691-3" title="3">                                           <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb691-4" title="4">error_enet_inverse_gaussian_val &lt;-</a>
<a class="sourceLine" id="cb691-5" title="5"><span class="st">  </span><span class="kw">mean</span>((y_pred_enet_inverse_gaussian_val <span class="op">-</span><span class="st"> </span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb691-6" title="6"><span class="kw">print</span>(error_enet_inverse_gaussian_val)</a></code></pre></div>
<pre><code>## [1] 0.2957803</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb693-1" title="1">models_deg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_pH10, <span class="st">&quot;model_inverse_gaussian_enet&quot;</span>)</a>
<a class="sourceLine" id="cb693-2" title="2">errors_deg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_pH10_train, error_enet_inverse_gaussian_train)</a>
<a class="sourceLine" id="cb693-3" title="3">errors_deg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_pH10_val, error_enet_inverse_gaussian_val)</a>
<a class="sourceLine" id="cb693-4" title="4"><span class="kw">rm</span>(error_enet_inverse_gaussian_train, error_enet_inverse_gaussian_val,</a>
<a class="sourceLine" id="cb693-5" title="5">   y_pred_enet_inverse_gaussian_train, y_pred_enet_inverse_gaussian_val)</a></code></pre></div>
</div>
</div>
</div>
<div id="récapitulatif-des-résultats-2" class="section level3">
<h3>Récapitulatif des résultats</h3>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb694-1" title="1">models_deg_pH10_errors_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(models_deg_pH10,</a>
<a class="sourceLine" id="cb694-2" title="2">                                          errors_deg_pH10_train,</a>
<a class="sourceLine" id="cb694-3" title="3">                                          errors_deg_pH10_val)</a></code></pre></div>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb695-1" title="1">models_deg_pH10_errors_df</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["models_deg_pH10"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_deg_pH10_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_deg_pH10_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma","2":"0.2001317","3":"0.1974088"},{"1":"model_gamma_ridge","2":"0.2414030","3":"0.2423041"},{"1":"model_gamma_lasso","2":"0.2007077","3":"0.1977433"},{"1":"model_gamma_enet","2":"0.2007077","3":"0.1977433"},{"1":"model_inverse_gaussian","2":"0.2143404","3":"0.1984605"},{"1":"model_inverse_gaussian_ridge","2":"0.3207168","3":"0.3245832"},{"1":"model_inverse_gaussian_lasso","2":"0.2932353","3":"0.2957803"},{"1":"model_inverse_gaussian_enet","2":"0.2932353","3":"0.2957803"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Le meilleur modèle (au sens de la minimisation du MSE sur la validation) est le <code>model_gamma</code>. Ainsi, la pénalisation n’a pas permis d’améliorer les performances ici.</p>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb696-1" title="1">models_deg_pH10_errors_df[<span class="kw">which.min</span>(errors_deg_pH10_val), ]</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["models_deg_pH10"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_deg_pH10_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_deg_pH10_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma","2":"0.2001317","3":"0.1974088","_rn_":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="deg_mg_50c" class="section level2">
<h2>deg_Mg_50C</h2>
<div id="loi-gamma-3" class="section level3">
<h3>Loi Gamma</h3>
<p>Ici on fera énormément de tests pour essayer de voir quels variables apportent des informations utiles.</p>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb697-1" title="1">model=<span class="kw">glm</span>(deg_Mg_50C<span class="op">~</span>sequence,<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb697-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb697-3" title="3"></a>
<a class="sourceLine" id="cb697-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb697-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.232091</code></pre>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb699-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb699-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2337675</code></pre>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb701-1" title="1">model=<span class="kw">glm</span>(deg_Mg_50C<span class="op">~</span>(sequence<span class="op">+</span>seq_be<span class="op">+</span>seq_af),<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb701-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb701-3" title="3"></a>
<a class="sourceLine" id="cb701-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb701-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1944598</code></pre>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb703-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb703-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1920181</code></pre>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb705-1" title="1">model=<span class="kw">glm</span>(deg_Mg_50C<span class="op">~</span>sequence<span class="op">+</span>index_sequence,<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb705-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb705-3" title="3"></a>
<a class="sourceLine" id="cb705-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb705-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2187835</code></pre>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb707-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb707-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2193339</code></pre>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb709-1" title="1">model=<span class="kw">glm</span>(deg_Mg_50C<span class="op">~</span>sequence<span class="op">+</span>predicted_loop_type<span class="op">+</span>index_sequence,<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb709-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb709-3" title="3">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb709-4" title="4"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1855697</code></pre>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb711-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb711-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1860689</code></pre>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb713-1" title="1">model=<span class="kw">glm</span>(deg_Mg_50C<span class="op">~</span>sequence<span class="op">+</span>structure<span class="op">+</span>index_sequence,<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb713-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb713-3" title="3"></a>
<a class="sourceLine" id="cb713-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb713-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1907426</code></pre>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb715-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb715-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1897129</code></pre>
<p>AUTRES ESSAIS</p>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb717-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_50C <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span></a>
<a class="sourceLine" id="cb717-2" title="2"><span class="st">              </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb717-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb717-4" title="4"></a>
<a class="sourceLine" id="cb717-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb717-6" title="6"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2417635</code></pre>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb719-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb719-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2531743</code></pre>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb721-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_50C <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span></a>
<a class="sourceLine" id="cb721-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb721-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb721-4" title="4"></a>
<a class="sourceLine" id="cb721-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb721-6" title="6"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2090931</code></pre>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb723-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb723-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2203922</code></pre>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb725-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_50C <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span></a>
<a class="sourceLine" id="cb725-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb725-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb725-4" title="4"></a>
<a class="sourceLine" id="cb725-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb725-6" title="6"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2413711</code></pre>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb727-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb727-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2516622</code></pre>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb729-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_50C  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span></a>
<a class="sourceLine" id="cb729-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb729-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb729-4" title="4"></a>
<a class="sourceLine" id="cb729-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb731-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2448834</code></pre>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb733-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb735-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.252696</code></pre>
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb737-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_50C  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span></a>
<a class="sourceLine" id="cb737-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb737-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb737-4" title="4"></a>
<a class="sourceLine" id="cb737-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb737-6" title="6"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2090397</code></pre>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb739-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb739-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2214075</code></pre>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb741-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_50C  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span></a>
<a class="sourceLine" id="cb741-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb741-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb741-4" title="4"></a>
<a class="sourceLine" id="cb741-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb743-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2107262</code></pre>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb745-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb747-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2223656</code></pre>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb749-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_50C <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>predicted_loop_type <span class="op">+</span></a>
<a class="sourceLine" id="cb749-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb749-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb749-4" title="4"></a>
<a class="sourceLine" id="cb749-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb751-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2403336</code></pre>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb753-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb755-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2496218</code></pre>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb757-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_50C  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span><span class="st"> </span>predicted_loop_type <span class="op">+</span></a>
<a class="sourceLine" id="cb757-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb757-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb757-4" title="4"></a>
<a class="sourceLine" id="cb757-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb759-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2081962</code></pre>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb761-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb763-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2207065</code></pre>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb765-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_50C <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span><span class="st"> </span>predicted_loop_type <span class="op">+</span></a>
<a class="sourceLine" id="cb765-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb765-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb765-4" title="4"></a>
<a class="sourceLine" id="cb765-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb767-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2043803</code></pre>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb769-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb771-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2169458</code></pre>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb773-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_50C  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span><span class="st"> </span>predicted_loop_type <span class="op">+</span></a>
<a class="sourceLine" id="cb773-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb773-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb773-4" title="4"></a>
<a class="sourceLine" id="cb773-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb775-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2434401</code></pre>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb777-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb779-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2526286</code></pre>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb781-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_Mg_50C  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span><span class="st"> </span>predicted_loop_type <span class="op">+</span></a>
<a class="sourceLine" id="cb781-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb781-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb781-4" title="4"></a>
<a class="sourceLine" id="cb781-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb783-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2468063</code></pre>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb785-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb787-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2562769</code></pre>
<div id="optimisation-6" class="section level4">
<h4>Optimisation</h4>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb789-1" title="1">formula_gamma_deg_Mg_50C =</a>
<a class="sourceLine" id="cb789-2" title="2"><span class="st">  &quot;deg_Mg_50C ~ sequence + predicted_loop_type + index_sequence&quot;</span></a></code></pre></div>
<p>On stocke le meilleur modèle pour la loi gamma.</p>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb790-1" title="1">model_gamma_deg_Mg_50C =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_gamma_deg_Mg_50C,</a>
<a class="sourceLine" id="cb790-2" title="2">                             <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a></code></pre></div>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb791-1" title="1"><span class="kw">summary</span>(model_gamma_deg_Mg_50C)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = formula_gamma_deg_Mg_50C, family = Gamma, data = data_train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -7.2444  -0.2946  -0.1351   0.1287   2.9735  
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           7.846e-01  1.040e-02  75.463  &lt; 2e-16 ***
## sequenceC             5.246e-02  5.158e-03  10.171  &lt; 2e-16 ***
## sequenceG            -5.093e-02  3.904e-03 -13.046  &lt; 2e-16 ***
## sequenceU            -7.154e-03  5.128e-03  -1.395 0.162985    
## predicted_loop_typeE -5.175e-02  1.033e-02  -5.009 5.48e-07 ***
## predicted_loop_typeH  4.098e-02  1.056e-02   3.881 0.000104 ***
## predicted_loop_typeI  1.826e-01  1.129e-02  16.167  &lt; 2e-16 ***
## predicted_loop_typeM -6.151e-02  1.224e-02  -5.024 5.08e-07 ***
## predicted_loop_typeS  4.389e-01  1.023e-02  42.890  &lt; 2e-16 ***
## predicted_loop_typeX -1.278e-01  1.199e-02 -10.662  &lt; 2e-16 ***
## index_sequence        4.203e-03  9.322e-05  45.084  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.1879634)
## 
##     Null deviance: 17241  on 86427  degrees of freedom
## Residual deviance: 12330  on 86417  degrees of freedom
## AIC: 45452
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb793-1" title="1">y_pred_gamma_train =<span class="st"> </span><span class="kw">predict.glm</span>(model_gamma_deg_Mg_50C,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb793-2" title="2">error_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb793-3" title="3"><span class="kw">print</span>(error_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1855697</code></pre>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb795-1" title="1">y_pred_gamma_val=<span class="kw">predict.glm</span>(model_gamma_deg_Mg_50C,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb795-2" title="2">error_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb795-3" title="3"><span class="kw">print</span>(error_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1860689</code></pre>
<div class="sourceCode" id="cb797"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb797-1" title="1">models_deg_Mg_50C &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_Mg_50C, <span class="st">&quot;model_gamma&quot;</span>)</a>
<a class="sourceLine" id="cb797-2" title="2">errors_deg_Mg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_50C_train, error_gamma_train)</a>
<a class="sourceLine" id="cb797-3" title="3">errors_deg_Mg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_50C_val, error_gamma_val)</a>
<a class="sourceLine" id="cb797-4" title="4"><span class="kw">rm</span>(error_gamma_val, error_gamma_train, y_pred_gamma_train, y_pred_gamma_val)</a></code></pre></div>
<div id="stepaic-6" class="section level5">
<h5>StepAIC</h5>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb798-1" title="1">model_gamma_deg_Mg_50C_aic =<span class="st"> </span><span class="kw">stepAIC</span>(model_gamma_deg_Mg_50C, <span class="dt">trace =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>Pas de changement du modèle. Cela est sûrement dû au fait qu’on n’a pas assez de variables initialement.</p>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb799-1" title="1"><span class="kw">summary</span>(model_gamma_deg_Mg_50C_aic)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = deg_Mg_50C ~ sequence + predicted_loop_type + index_sequence, 
##     family = Gamma, data = data_train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -7.2444  -0.2946  -0.1351   0.1287   2.9735  
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           7.846e-01  1.040e-02  75.463  &lt; 2e-16 ***
## sequenceC             5.246e-02  5.158e-03  10.171  &lt; 2e-16 ***
## sequenceG            -5.093e-02  3.904e-03 -13.046  &lt; 2e-16 ***
## sequenceU            -7.154e-03  5.128e-03  -1.395 0.162985    
## predicted_loop_typeE -5.175e-02  1.033e-02  -5.009 5.48e-07 ***
## predicted_loop_typeH  4.098e-02  1.056e-02   3.881 0.000104 ***
## predicted_loop_typeI  1.826e-01  1.129e-02  16.167  &lt; 2e-16 ***
## predicted_loop_typeM -6.151e-02  1.224e-02  -5.024 5.08e-07 ***
## predicted_loop_typeS  4.389e-01  1.023e-02  42.890  &lt; 2e-16 ***
## predicted_loop_typeX -1.278e-01  1.199e-02 -10.662  &lt; 2e-16 ***
## index_sequence        4.203e-03  9.322e-05  45.084  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.1879634)
## 
##     Null deviance: 17241  on 86427  degrees of freedom
## Residual deviance: 12330  on 86417  degrees of freedom
## AIC: 45452
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Pas de changement sur les performances de prédiction.</p>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb801-1" title="1">y_pred_gamma_train_aic =<span class="st"> </span><span class="kw">predict.glm</span>(model_gamma_deg_Mg_50C_aic,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb801-2" title="2"><span class="kw">mean</span>((y_pred_gamma_train_aic<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1855697</code></pre>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb803-1" title="1">y_pred_gamma_val_aic=<span class="kw">predict.glm</span>(model_gamma_deg_Mg_50C_aic,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb803-2" title="2"><span class="kw">mean</span>((y_pred_gamma_val_aic<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1860689</code></pre>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb805-1" title="1"><span class="kw">rm</span>(model_gamma_deg_Mg_50C_aic, y_pred_gamma_train_aic, y_pred_gamma_val_aic)</a></code></pre></div>
<p>On va maintenant tester des pénalisations ridge, lasso et elastic-net.</p>
</div>
<div id="pénalisation-ridge-et-lasso-6" class="section level5">
<h5>Pénalisation ridge et lasso</h5>
<p>On commence par calculer la matrice de design du model_gamma_deg_Mg_50C sur le train et le test.</p>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb806-1" title="1"><span class="co"># Matrice de design du train</span></a>
<a class="sourceLine" id="cb806-2" title="2">data_train_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_gamma_deg_Mg_50C)</a>
<a class="sourceLine" id="cb806-3" title="3"><span class="co">#head(data_train_pen)</span></a></code></pre></div>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb807-1" title="1"><span class="co"># Pour faire la matrice de design de la validation</span></a>
<a class="sourceLine" id="cb807-2" title="2">model_gamma_deg_Mg_50C_val =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_gamma_deg_Mg_50C,</a>
<a class="sourceLine" id="cb807-3" title="3">                                 <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_val)</a>
<a class="sourceLine" id="cb807-4" title="4">data_val_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_gamma_deg_Mg_50C_val)</a>
<a class="sourceLine" id="cb807-5" title="5"><span class="co">#head(data_val_pen)</span></a>
<a class="sourceLine" id="cb807-6" title="6"></a>
<a class="sourceLine" id="cb807-7" title="7"><span class="co"># On supprime le modèle sur le test</span></a>
<a class="sourceLine" id="cb807-8" title="8"><span class="kw">rm</span>(model_gamma_deg_Mg_50C_val)</a></code></pre></div>
<p>On pénalise le model_gamma_deg_Mg_50C avec une pénalité ridge. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb808-1" title="1"><span class="co">#model_gamma_deg_Mg_50C_pen_ridge = cv.glmnet(data_train_pen, data_train$deg_Mg_50C,</span></a>
<a class="sourceLine" id="cb808-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb808-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 0)</span></a>
<a class="sourceLine" id="cb808-4" title="4"><span class="co">## lambda.min est le lambda qui minimise l&#39;erreur de cross validation</span></a>
<a class="sourceLine" id="cb808-5" title="5"><span class="co">#coef(model_gamma_deg_Mg_50C_pen_ridge, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb809-1" title="1"><span class="co">#saveRDS(model_gamma_deg_Mg_50C_pen_ridge, &quot;model_gamma_deg_Mg_50C_pen_ridge.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb810"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb810-1" title="1">model_gamma_deg_Mg_50C_pen_ridge &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_Mg_50C_pen_ridge.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation ridge.</p>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb811-1" title="1">y_pred_ridge_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_50C_pen_ridge, data_train_pen,</a>
<a class="sourceLine" id="cb811-2" title="2">                                   <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb811-3" title="3">y_pred_ridge_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_50C_pen_ridge, data_val_pen,</a>
<a class="sourceLine" id="cb811-4" title="4">                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb811-5" title="5">error_ridge_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_ridge_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb811-6" title="6"><span class="kw">print</span>(error_ridge_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1959213</code></pre>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb813-1" title="1">error_ridge_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_ridge_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb813-2" title="2"><span class="kw">print</span>(error_ridge_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1965515</code></pre>
<p>On pénalise le model_gamma_deg_Mg_50C avec une pénalité lasso. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb815-1" title="1"><span class="co">#model_gamma_deg_Mg_50C_pen_lasso = cv.glmnet(data_train_pen, data_train$deg_Mg_50C,</span></a>
<a class="sourceLine" id="cb815-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb815-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 1)</span></a>
<a class="sourceLine" id="cb815-4" title="4"><span class="co">#coef(model_gamma_deg_Mg_50C_pen_lasso, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb816-1" title="1"><span class="co">#saveRDS(model_gamma_deg_Mg_50C_pen_lasso, &quot;model_gamma_deg_Mg_50C_pen_lasso.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb817-1" title="1">model_gamma_deg_Mg_50C_pen_lasso &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_Mg_50C_pen_lasso.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation lasso.</p>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb818-1" title="1">y_pred_lasso_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_50C_pen_lasso, data_train_pen,</a>
<a class="sourceLine" id="cb818-2" title="2">                                   <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb818-3" title="3">error_lasso_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_lasso_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb818-4" title="4"><span class="kw">print</span>(error_lasso_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1856069</code></pre>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb820-1" title="1">y_pred_lasso_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_50C_pen_lasso, data_val_pen,</a>
<a class="sourceLine" id="cb820-2" title="2">                                 <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb820-3" title="3">error_lasso_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_lasso_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb820-4" title="4"><span class="kw">print</span>(error_lasso_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1858539</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb822-1" title="1">models_deg_Mg_50C &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_Mg_50C, <span class="st">&quot;model_gamma_ridge&quot;</span>, <span class="st">&quot;model_gamma_lasso&quot;</span>)</a>
<a class="sourceLine" id="cb822-2" title="2">errors_deg_Mg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_50C_train, error_ridge_gamma_train,</a>
<a class="sourceLine" id="cb822-3" title="3">                             error_lasso_gamma_train)</a>
<a class="sourceLine" id="cb822-4" title="4">errors_deg_Mg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_50C_val, error_ridge_gamma_val, error_lasso_gamma_val)</a>
<a class="sourceLine" id="cb822-5" title="5"><span class="kw">rm</span>(error_ridge_gamma_val, error_lasso_gamma_val,</a>
<a class="sourceLine" id="cb822-6" title="6">   error_ridge_gamma_train, error_lasso_gamma_train,</a>
<a class="sourceLine" id="cb822-7" title="7">   y_pred_ridge_gamma_train, y_pred_ridge_gamma_val,</a>
<a class="sourceLine" id="cb822-8" title="8">   y_pred_lasso_gamma_train, y_pred_lasso_gamma_val)</a></code></pre></div>
</div>
<div id="pénalisation-elastic-net-6" class="section level5">
<h5>Pénalisation elastic-net</h5>
<p>On choisit <span class="math inline">\(\alpha\)</span> qui minimise le MSE sur la validation.</p>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb823-1" title="1"><span class="co">#alpha_opti_enet_gamma_deg_Mg_50C =</span></a>
<a class="sourceLine" id="cb823-2" title="2"><span class="co">#  alpha_opti_enet(data_train = data_train_pen, data_val = data_val_pen,</span></a>
<a class="sourceLine" id="cb823-3" title="3"><span class="co">#                  y_true_train = data_train$deg_Mg_50C,</span></a>
<a class="sourceLine" id="cb823-4" title="4"><span class="co">#                  y_true_val = data_val$deg_Mg_50C,</span></a>
<a class="sourceLine" id="cb823-5" title="5"><span class="co">#                  family = Gamma, cores = detectCores() - 2)</span></a></code></pre></div>
<p>Au final, le meilleur modèle est celui avec <span class="math inline">\(\alpha = 0.65\)</span>.</p>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb824-1" title="1"><span class="co">#print(alpha_opti_enet_gamma_deg_Mg_50C)</span></a></code></pre></div>
<p>On construit le modèle avec le choix optimal pour <span class="math inline">\(\alpha\)</span>.</p>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb825-1" title="1"><span class="co">#model_gamma_deg_Mg_50C_pen_enet = cv.glmnet(data_train_pen, data_train$deg_Mg_50C,</span></a>
<a class="sourceLine" id="cb825-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb825-3" title="3"><span class="co">#                                             standardize = FALSE,</span></a>
<a class="sourceLine" id="cb825-4" title="4"><span class="co">#                                             alpha = alpha_opti_enet_gamma_deg_Mg_50C)</span></a>
<a class="sourceLine" id="cb825-5" title="5"><span class="co">#coef(model_gamma_deg_Mg_50C_pen_enet, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb826-1" title="1"><span class="co">#saveRDS(model_gamma_deg_Mg_50C_pen_enet, &quot;model_gamma_deg_Mg_50C_pen_enet.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb827-1" title="1">model_gamma_deg_Mg_50C_pen_enet &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_Mg_50C_pen_enet.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation elastic-net.</p>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb828-1" title="1">y_pred_enet_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_50C_pen_enet, data_train_pen,</a>
<a class="sourceLine" id="cb828-2" title="2">                                   <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb828-3" title="3">error_enet_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_enet_gamma_train <span class="op">-</span><span class="st"> </span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb828-4" title="4"><span class="kw">print</span>(error_enet_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.185606</code></pre>
<div class="sourceCode" id="cb830"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb830-1" title="1">y_pred_enet_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_50C_pen_enet, data_val_pen,</a>
<a class="sourceLine" id="cb830-2" title="2">                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb830-3" title="3">error_enet_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_enet_gamma_val <span class="op">-</span><span class="st"> </span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb830-4" title="4"><span class="kw">print</span>(error_enet_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.18585</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb832"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb832-1" title="1">models_deg_Mg_50C &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_Mg_50C, <span class="st">&quot;model_gamma_enet&quot;</span>)</a>
<a class="sourceLine" id="cb832-2" title="2">errors_deg_Mg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_50C_train, error_enet_gamma_train)</a>
<a class="sourceLine" id="cb832-3" title="3">errors_deg_Mg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_50C_val, error_enet_gamma_val)</a>
<a class="sourceLine" id="cb832-4" title="4"><span class="kw">rm</span>(error_enet_gamma_train, error_enet_gamma_val,</a>
<a class="sourceLine" id="cb832-5" title="5">   y_pred_enet_gamma_train, y_pred_enet_gamma_val)</a></code></pre></div>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb833-1" title="1"><span class="kw">data.frame</span>(models_deg_Mg_50C, errors_deg_Mg_50C_train, errors_deg_Mg_50C_val)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["models_deg_Mg_50C"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_deg_Mg_50C_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_deg_Mg_50C_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma","2":"0.1855697","3":"0.1860689"},{"1":"model_gamma_ridge","2":"0.1959213","3":"0.1965515"},{"1":"model_gamma_lasso","2":"0.1856069","3":"0.1858539"},{"1":"model_gamma_enet","2":"0.1856060","3":"0.1858500"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<div id="inverse.gaussian-3" class="section level3">
<h3>Inverse.gaussian</h3>
<div class="sourceCode" id="cb834"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb834-1" title="1">model=<span class="kw">glm</span>(deg_Mg_50C<span class="op">~</span>sequence,<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb834-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb834-3" title="3"></a>
<a class="sourceLine" id="cb834-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb834-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2592671</code></pre>
<div class="sourceCode" id="cb836"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb836-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb836-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2597021</code></pre>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb838-1" title="1">model=<span class="kw">glm</span>(deg_Mg_50C<span class="op">~</span>(sequence<span class="op">+</span>seq_be),<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb838-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb838-3" title="3"></a>
<a class="sourceLine" id="cb838-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb838-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2488388</code></pre>
<div class="sourceCode" id="cb840"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb840-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb840-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2478963</code></pre>
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb842-1" title="1">model=<span class="kw">glm</span>(deg_Mg_50C<span class="op">~</span>sequence<span class="op">+</span>index_sequence,<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb842-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb842-3" title="3"></a>
<a class="sourceLine" id="cb842-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb842-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2283252</code></pre>
<div class="sourceCode" id="cb844"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb844-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb844-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.226901</code></pre>
<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb846-1" title="1">model=<span class="kw">glm</span>(deg_Mg_50C<span class="op">~</span>sequence<span class="op">+</span>predicted_loop_type,<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb846-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb846-3" title="3">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb846-4" title="4"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.201322</code></pre>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb848-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb848-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1934606</code></pre>
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb850-1" title="1">model=<span class="kw">glm</span>(deg_Mg_50C<span class="op">~</span>sequence<span class="op">+</span>structure<span class="op">+</span>index_sequence,<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb850-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb850-3" title="3"></a>
<a class="sourceLine" id="cb850-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb850-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1929133</code></pre>
<div class="sourceCode" id="cb852"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb852-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb852-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1946082</code></pre>
<div id="optimisation-7" class="section level4">
<h4>Optimisation</h4>
<div class="sourceCode" id="cb854"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb854-1" title="1">formula_inverse_gaussian_deg_Mg_50C =</a>
<a class="sourceLine" id="cb854-2" title="2"><span class="st">  &quot;deg_Mg_50C ~ sequence + structure + index_sequence&quot;</span></a></code></pre></div>
<p>On stocke le meilleur modèle pour la loi gamma.</p>
<div class="sourceCode" id="cb855"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb855-1" title="1">model_inverse_gaussian_deg_Mg_50C =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_inverse_gaussian_deg_Mg_50C,</a>
<a class="sourceLine" id="cb855-2" title="2">                                        <span class="dt">family =</span> inverse.gaussian, <span class="dt">data =</span> data_train)</a></code></pre></div>
<div class="sourceCode" id="cb856"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb856-1" title="1"><span class="kw">summary</span>(model_inverse_gaussian_deg_Mg_50C)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = formula_inverse_gaussian_deg_Mg_50C, family = inverse.gaussian, 
##     data = data_train)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1e+06   0e+00   0e+00   0e+00   2e+00  
## 
## Coefficients:
##                 Estimate Std. Error  t value Pr(&gt;|t|)    
## (Intercept)     1.395130   0.009726  143.438   &lt;2e-16 ***
## sequenceC       0.179265   0.009927   18.058   &lt;2e-16 ***
## sequenceG      -0.104255   0.005682  -18.349   &lt;2e-16 ***
## sequenceU      -0.012341   0.008603   -1.434    0.151    
## structure)     -0.281171   0.011574  -24.293   &lt;2e-16 ***
## structure.     -0.974676   0.008699 -112.045   &lt;2e-16 ***
## index_sequence  0.009871   0.000139   71.001   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for inverse.gaussian family taken to be 0.3068316)
## 
##     Null deviance: 1e+12  on 86427  degrees of freedom
## Residual deviance: 1e+12  on 86421  degrees of freedom
## AIC: 1600552
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<div class="sourceCode" id="cb858"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb858-1" title="1">y_pred_inverse_gaussian_train =<span class="st"> </span><span class="kw">predict.glm</span>(model_inverse_gaussian_deg_Mg_50C,</a>
<a class="sourceLine" id="cb858-2" title="2">                                            data_train, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb858-3" title="3">error_inverse_gaussian_train &lt;-</a>
<a class="sourceLine" id="cb858-4" title="4"><span class="st">  </span><span class="kw">mean</span>((y_pred_inverse_gaussian_train<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb858-5" title="5"><span class="kw">print</span>(error_inverse_gaussian_train)</a></code></pre></div>
<pre><code>## [1] 0.1946082</code></pre>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb860-1" title="1">y_pred_inverse_gaussian_val =<span class="st"> </span><span class="kw">predict.glm</span>(model_inverse_gaussian_deg_Mg_50C,</a>
<a class="sourceLine" id="cb860-2" title="2">                                          data_val, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb860-3" title="3">error_inverse_gaussian_val &lt;-</a>
<a class="sourceLine" id="cb860-4" title="4"><span class="st">  </span><span class="kw">mean</span>((y_pred_inverse_gaussian_val <span class="op">-</span><span class="st"> </span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb860-5" title="5"><span class="kw">print</span>(error_inverse_gaussian_val)</a></code></pre></div>
<pre><code>## [1] 0.1929133</code></pre>
<div class="sourceCode" id="cb862"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb862-1" title="1">models_deg_Mg_50C &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_Mg_50C, <span class="st">&quot;model_inverse_gaussian&quot;</span>)</a>
<a class="sourceLine" id="cb862-2" title="2">errors_deg_Mg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_50C_train, error_inverse_gaussian_train)</a>
<a class="sourceLine" id="cb862-3" title="3">errors_deg_Mg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_50C_val, error_inverse_gaussian_val)</a>
<a class="sourceLine" id="cb862-4" title="4"><span class="kw">rm</span>(error_inverse_gaussian_val, error_inverse_gaussian_train,</a>
<a class="sourceLine" id="cb862-5" title="5">   y_pred_inverse_gaussian_train, y_pred_inverse_gaussian_val)</a></code></pre></div>
<div id="stepaic-7" class="section level5">
<h5>StepAIC</h5>
<div class="sourceCode" id="cb863"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb863-1" title="1">model_inverse_gaussian_deg_Mg_50C_aic =</a>
<a class="sourceLine" id="cb863-2" title="2"><span class="st">  </span><span class="kw">stepAIC</span>(model_inverse_gaussian_deg_Mg_50C, <span class="dt">trace =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>Pas de changement du modèle. Cela est sûrement dû au fait qu’on n’a pas assez de variables initialement.</p>
<div class="sourceCode" id="cb864"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb864-1" title="1"><span class="kw">summary</span>(model_inverse_gaussian_deg_Mg_50C_aic)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = deg_Mg_50C ~ sequence + structure + index_sequence, 
##     family = inverse.gaussian, data = data_train)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1e+06   0e+00   0e+00   0e+00   2e+00  
## 
## Coefficients:
##                 Estimate Std. Error  t value Pr(&gt;|t|)    
## (Intercept)     1.395130   0.009726  143.438   &lt;2e-16 ***
## sequenceC       0.179265   0.009927   18.058   &lt;2e-16 ***
## sequenceG      -0.104255   0.005682  -18.349   &lt;2e-16 ***
## sequenceU      -0.012341   0.008603   -1.434    0.151    
## structure)     -0.281171   0.011574  -24.293   &lt;2e-16 ***
## structure.     -0.974676   0.008699 -112.045   &lt;2e-16 ***
## index_sequence  0.009871   0.000139   71.001   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for inverse.gaussian family taken to be 0.3068316)
## 
##     Null deviance: 1e+12  on 86427  degrees of freedom
## Residual deviance: 1e+12  on 86421  degrees of freedom
## AIC: 1600552
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<p>Pas de changement sur les performances de prédiction.</p>
<div class="sourceCode" id="cb866"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb866-1" title="1">y_pred_inverse_gaussian_train_aic =<span class="st"> </span><span class="kw">predict.glm</span>(model_inverse_gaussian_deg_Mg_50C_aic,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb866-2" title="2"><span class="kw">mean</span>((y_pred_inverse_gaussian_train_aic<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1946082</code></pre>
<div class="sourceCode" id="cb868"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb868-1" title="1">y_pred_inverse_gaussian_val_aic=<span class="kw">predict.glm</span>(model_inverse_gaussian_deg_Mg_50C_aic,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb868-2" title="2"><span class="kw">mean</span>((y_pred_inverse_gaussian_val_aic<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1929133</code></pre>
<div class="sourceCode" id="cb870"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb870-1" title="1"><span class="kw">rm</span>(model_inverse_gaussian_deg_Mg_50C_aic, y_pred_inverse_gaussian_train_aic, y_pred_inverse_gaussian_val_aic)</a></code></pre></div>
<p>On va maintenant tester des pénalisations ridge, lasso et elastic-net.</p>
</div>
<div id="pénalisation-ridge-et-lasso-7" class="section level5">
<h5>Pénalisation ridge et lasso</h5>
<p>On commence par calculer la matrice de design du model_inverse_gaussian_deg_Mg_50C sur le train et le test.</p>
<div class="sourceCode" id="cb871"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb871-1" title="1"><span class="co"># Matrice de design du train</span></a>
<a class="sourceLine" id="cb871-2" title="2">data_train_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_inverse_gaussian_deg_Mg_50C)</a>
<a class="sourceLine" id="cb871-3" title="3"><span class="co">#head(data_train_pen)</span></a></code></pre></div>
<div class="sourceCode" id="cb872"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb872-1" title="1"><span class="co"># Pour faire la matrice de design de la validation</span></a>
<a class="sourceLine" id="cb872-2" title="2">model_inverse_gaussian_deg_Mg_50C_val =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_inverse_gaussian_deg_Mg_50C,</a>
<a class="sourceLine" id="cb872-3" title="3">                                 <span class="dt">family =</span> inverse.gaussian, <span class="dt">data =</span> data_val)</a>
<a class="sourceLine" id="cb872-4" title="4">data_val_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_inverse_gaussian_deg_Mg_50C_val)</a>
<a class="sourceLine" id="cb872-5" title="5"><span class="co">#head(data_val_pen)</span></a>
<a class="sourceLine" id="cb872-6" title="6"></a>
<a class="sourceLine" id="cb872-7" title="7"><span class="co"># On supprime le modèle sur le test</span></a>
<a class="sourceLine" id="cb872-8" title="8"><span class="kw">rm</span>(model_inverse_gaussian_deg_Mg_50C_val)</a></code></pre></div>
<p>On pénalise le model_inverse_gaussian_deg_Mg_50C avec une pénalité ridge. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb873"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb873-1" title="1"><span class="co">#model_inverse_gaussian_deg_Mg_50C_pen_ridge = cv.glmnet(data_train_pen, data_train$deg_Mg_50C,</span></a>
<a class="sourceLine" id="cb873-2" title="2"><span class="co">#                                             family = inverse.gaussian, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb873-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 0)</span></a>
<a class="sourceLine" id="cb873-4" title="4"><span class="co">## lambda.min est le lambda qui minimise l&#39;erreur de cross validation</span></a>
<a class="sourceLine" id="cb873-5" title="5"><span class="co">#coef(model_inverse_gaussian_deg_Mg_50C_pen_ridge, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb874"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb874-1" title="1"><span class="co">#saveRDS(model_inverse_gaussian_deg_Mg_50C_pen_ridge,</span></a>
<a class="sourceLine" id="cb874-2" title="2"><span class="co">#        &quot;model_inverse_gaussian_deg_Mg_50C_pen_ridge.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb875"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb875-1" title="1">model_inverse_gaussian_deg_Mg_50C_pen_ridge &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb875-2" title="2"><span class="st">  </span><span class="kw">readRDS</span>(<span class="st">&quot;model_inverse_gaussian_deg_Mg_50C_pen_ridge.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation ridge.</p>
<div class="sourceCode" id="cb876"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb876-1" title="1">y_pred_ridge_inverse_gaussian_train =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_Mg_50C_pen_ridge,</a>
<a class="sourceLine" id="cb876-2" title="2">                                              data_train_pen,</a>
<a class="sourceLine" id="cb876-3" title="3">                                              <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb876-4" title="4">y_pred_ridge_inverse_gaussian_val =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_Mg_50C_pen_ridge,</a>
<a class="sourceLine" id="cb876-5" title="5">                                            data_val_pen,</a>
<a class="sourceLine" id="cb876-6" title="6">                                            <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb876-7" title="7"></a>
<a class="sourceLine" id="cb876-8" title="8">error_ridge_inverse_gaussian_train &lt;-</a>
<a class="sourceLine" id="cb876-9" title="9"><span class="st">  </span><span class="kw">mean</span>((y_pred_ridge_inverse_gaussian_train<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb876-10" title="10"><span class="kw">print</span>(error_ridge_inverse_gaussian_train)</a></code></pre></div>
<pre><code>## [1] 0.20538</code></pre>
<div class="sourceCode" id="cb878"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb878-1" title="1">error_ridge_inverse_gaussian_val &lt;-</a>
<a class="sourceLine" id="cb878-2" title="2"><span class="st">  </span><span class="kw">mean</span>((y_pred_ridge_inverse_gaussian_val<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb878-3" title="3"><span class="kw">print</span>(error_ridge_inverse_gaussian_val)</a></code></pre></div>
<pre><code>## [1] 0.2064292</code></pre>
<p>On pénalise le model_inverse_gaussian_deg_Mg_50C avec une pénalité lasso. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb880"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb880-1" title="1"><span class="co">#model_inverse_gaussian_deg_Mg_50C_pen_lasso = cv.glmnet(data_train_pen, data_train$deg_Mg_50C,</span></a>
<a class="sourceLine" id="cb880-2" title="2"><span class="co">#                                             family = inverse.gaussian, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb880-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 1)</span></a>
<a class="sourceLine" id="cb880-4" title="4"><span class="co">#coef(model_inverse_gaussian_deg_Mg_50C_pen_lasso, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb881"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb881-1" title="1"><span class="co">#saveRDS(model_inverse_gaussian_deg_Mg_50C_pen_lasso,</span></a>
<a class="sourceLine" id="cb881-2" title="2"><span class="co">#        &quot;model_inverse_gaussian_deg_Mg_50C_pen_lasso.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb882"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb882-1" title="1">model_inverse_gaussian_deg_Mg_50C_pen_lasso &lt;-</a>
<a class="sourceLine" id="cb882-2" title="2"><span class="st">  </span><span class="kw">readRDS</span>(<span class="st">&quot;model_inverse_gaussian_deg_Mg_50C_pen_lasso.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation lasso.</p>
<div class="sourceCode" id="cb883"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb883-1" title="1">y_pred_lasso_inverse_gaussian_train =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_Mg_50C_pen_lasso,</a>
<a class="sourceLine" id="cb883-2" title="2">                                              data_train_pen,</a>
<a class="sourceLine" id="cb883-3" title="3">                                              <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb883-4" title="4">error_lasso_inverse_gaussian_train &lt;-</a>
<a class="sourceLine" id="cb883-5" title="5"><span class="st">  </span><span class="kw">mean</span>((y_pred_lasso_inverse_gaussian_train<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb883-6" title="6"><span class="kw">print</span>(error_lasso_inverse_gaussian_train)</a></code></pre></div>
<pre><code>## [1] 0.1879238</code></pre>
<div class="sourceCode" id="cb885"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb885-1" title="1">y_pred_lasso_inverse_gaussian_val =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_Mg_50C_pen_lasso,</a>
<a class="sourceLine" id="cb885-2" title="2">                                            data_val_pen,</a>
<a class="sourceLine" id="cb885-3" title="3">                                            <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb885-4" title="4">error_lasso_inverse_gaussian_val &lt;-</a>
<a class="sourceLine" id="cb885-5" title="5"><span class="st">  </span><span class="kw">mean</span>((y_pred_lasso_inverse_gaussian_val<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb885-6" title="6"><span class="kw">print</span>(error_lasso_inverse_gaussian_val)</a></code></pre></div>
<pre><code>## [1] 0.1887155</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb887-1" title="1">models_deg_Mg_50C &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_Mg_50C, <span class="st">&quot;model_inverse_gaussian_ridge&quot;</span>, <span class="st">&quot;model_inverse_gaussian_lasso&quot;</span>)</a>
<a class="sourceLine" id="cb887-2" title="2">errors_deg_Mg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_50C_train, error_ridge_inverse_gaussian_train,</a>
<a class="sourceLine" id="cb887-3" title="3">                             error_lasso_inverse_gaussian_train)</a>
<a class="sourceLine" id="cb887-4" title="4">errors_deg_Mg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_50C_val, error_ridge_inverse_gaussian_val, error_lasso_inverse_gaussian_val)</a>
<a class="sourceLine" id="cb887-5" title="5"><span class="kw">rm</span>(error_ridge_inverse_gaussian_val, error_lasso_inverse_gaussian_val,</a>
<a class="sourceLine" id="cb887-6" title="6">   error_ridge_inverse_gaussian_train, error_lasso_inverse_gaussian_train,</a>
<a class="sourceLine" id="cb887-7" title="7">   y_pred_ridge_inverse_gaussian_train, y_pred_ridge_inverse_gaussian_val,</a>
<a class="sourceLine" id="cb887-8" title="8">   y_pred_lasso_inverse_gaussian_train, y_pred_lasso_inverse_gaussian_val)</a></code></pre></div>
</div>
<div id="pénalisation-elastic-net-7" class="section level5">
<h5>Pénalisation elastic-net</h5>
<p>On choisit <span class="math inline">\(\alpha\)</span> qui minimise le MSE sur la validation.</p>
<div class="sourceCode" id="cb888"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb888-1" title="1"><span class="co">#alpha_opti_enet_inverse_gaussian_deg_Mg_50C =</span></a>
<a class="sourceLine" id="cb888-2" title="2"><span class="co">#  alpha_opti_enet(data_train = data_train_pen, data_val = data_val_pen,</span></a>
<a class="sourceLine" id="cb888-3" title="3"><span class="co">#                  y_true_train = data_train$deg_Mg_50C,</span></a>
<a class="sourceLine" id="cb888-4" title="4"><span class="co">#                  y_true_val = data_val$deg_Mg_50C,</span></a>
<a class="sourceLine" id="cb888-5" title="5"><span class="co">#                  family = inverse.gaussian, cores = detectCores() - 2)</span></a></code></pre></div>
<p>Au final, le meilleur modèle est celui avec <span class="math inline">\(\alpha = 0.55\)</span>.</p>
<div class="sourceCode" id="cb889"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb889-1" title="1"><span class="co">#print(alpha_opti_enet_inverse_gaussian_deg_Mg_50C)</span></a></code></pre></div>
<p>On construit le modèle avec le choix optimal pour <span class="math inline">\(\alpha\)</span>.</p>
<div class="sourceCode" id="cb890"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb890-1" title="1"><span class="co">#model_inverse_gaussian_deg_Mg_50C_pen_enet = cv.glmnet(data_train_pen, data_train$deg_Mg_50C,</span></a>
<a class="sourceLine" id="cb890-2" title="2"><span class="co">#                                             family = inverse.gaussian, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb890-3" title="3"><span class="co">#                                             standardize = FALSE,</span></a>
<a class="sourceLine" id="cb890-4" title="4"><span class="co">#                                             alpha = alpha_opti_enet_inverse_gaussian_deg_Mg_50C)</span></a>
<a class="sourceLine" id="cb890-5" title="5"><span class="co">#coef(model_inverse_gaussian_deg_Mg_50C_pen_enet, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb891"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb891-1" title="1"><span class="co">#saveRDS(model_inverse_gaussian_deg_Mg_50C_pen_enet,</span></a>
<a class="sourceLine" id="cb891-2" title="2"><span class="co">#        &quot;model_inverse_gaussian_deg_Mg_50C_pen_enet.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb892"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb892-1" title="1">model_inverse_gaussian_deg_Mg_50C_pen_enet &lt;-</a>
<a class="sourceLine" id="cb892-2" title="2"><span class="st">  </span><span class="kw">readRDS</span>(<span class="st">&quot;model_inverse_gaussian_deg_Mg_50C_pen_enet.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation elastic-net.</p>
<div class="sourceCode" id="cb893"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb893-1" title="1">y_pred_enet_inverse_gaussian_train =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_Mg_50C_pen_enet,</a>
<a class="sourceLine" id="cb893-2" title="2">                                             data_train_pen,</a>
<a class="sourceLine" id="cb893-3" title="3">                                             <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb893-4" title="4">error_enet_inverse_gaussian_train &lt;-</a>
<a class="sourceLine" id="cb893-5" title="5"><span class="st">  </span><span class="kw">mean</span>((y_pred_enet_inverse_gaussian_train <span class="op">-</span><span class="st"> </span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb893-6" title="6"><span class="kw">print</span>(error_enet_inverse_gaussian_train)</a></code></pre></div>
<pre><code>## [1] 0.1879195</code></pre>
<div class="sourceCode" id="cb895"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb895-1" title="1">y_pred_enet_inverse_gaussian_val =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_Mg_50C_pen_enet,</a>
<a class="sourceLine" id="cb895-2" title="2">                                           data_val_pen,</a>
<a class="sourceLine" id="cb895-3" title="3">                                           <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb895-4" title="4">error_enet_inverse_gaussian_val &lt;-</a>
<a class="sourceLine" id="cb895-5" title="5"><span class="st">  </span><span class="kw">mean</span>((y_pred_enet_inverse_gaussian_val <span class="op">-</span><span class="st"> </span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb895-6" title="6"><span class="kw">print</span>(error_enet_inverse_gaussian_val)</a></code></pre></div>
<pre><code>## [1] 0.1887095</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb897"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb897-1" title="1">models_deg_Mg_50C &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_Mg_50C, <span class="st">&quot;model_inverse_gaussian_enet&quot;</span>)</a>
<a class="sourceLine" id="cb897-2" title="2">errors_deg_Mg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_50C_train, error_enet_inverse_gaussian_train)</a>
<a class="sourceLine" id="cb897-3" title="3">errors_deg_Mg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_50C_val, error_enet_inverse_gaussian_val)</a>
<a class="sourceLine" id="cb897-4" title="4"><span class="kw">rm</span>(error_enet_inverse_gaussian_train, error_enet_inverse_gaussian_val,</a>
<a class="sourceLine" id="cb897-5" title="5">   y_pred_enet_inverse_gaussian_train, y_pred_enet_inverse_gaussian_val)</a></code></pre></div>
</div>
</div>
</div>
<div id="récapitulatif-des-résultats-3" class="section level3">
<h3>Récapitulatif des résultats</h3>
<div class="sourceCode" id="cb898"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb898-1" title="1">models_deg_Mg_50C_errors_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(models_deg_Mg_50C,</a>
<a class="sourceLine" id="cb898-2" title="2">                                          errors_deg_Mg_50C_train,</a>
<a class="sourceLine" id="cb898-3" title="3">                                          errors_deg_Mg_50C_val)</a></code></pre></div>
<div class="sourceCode" id="cb899"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb899-1" title="1">models_deg_Mg_50C_errors_df</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["models_deg_Mg_50C"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_deg_Mg_50C_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_deg_Mg_50C_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma","2":"0.1855697","3":"0.1860689"},{"1":"model_gamma_ridge","2":"0.1959213","3":"0.1965515"},{"1":"model_gamma_lasso","2":"0.1856069","3":"0.1858539"},{"1":"model_gamma_enet","2":"0.1856060","3":"0.1858500"},{"1":"model_inverse_gaussian","2":"0.1946082","3":"0.1929133"},{"1":"model_inverse_gaussian_ridge","2":"0.2053800","3":"0.2064292"},{"1":"model_inverse_gaussian_lasso","2":"0.1879238","3":"0.1887155"},{"1":"model_inverse_gaussian_enet","2":"0.1879195","3":"0.1887095"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Le meilleur modèle (au sens de la minimisation du MSE sur la validation) est le <code>model_gamma</code>. Ainsi, la pénalisation n’a pas permis d’améliorer les performances ici.</p>
<div class="sourceCode" id="cb900"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb900-1" title="1">models_deg_Mg_50C_errors_df[<span class="kw">which.min</span>(errors_deg_Mg_50C_val), ]</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["models_deg_Mg_50C"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_deg_Mg_50C_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_deg_Mg_50C_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma_enet","2":"0.185606","3":"0.18585","_rn_":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="deg_50c" class="section level2">
<h2>deg_50C</h2>
<div id="loi-gamma-4" class="section level3">
<h3>Loi Gamma</h3>
<p>Ici on fera énormément de tests pour essayer de voir quels variables apportent des informations utiles.</p>
<div class="sourceCode" id="cb901"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb901-1" title="1">model=<span class="kw">glm</span>(deg_50C<span class="op">~</span>sequence,<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb901-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb901-3" title="3"></a>
<a class="sourceLine" id="cb901-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb901-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1730893</code></pre>
<div class="sourceCode" id="cb903"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb903-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb903-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1772408</code></pre>
<div class="sourceCode" id="cb905"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb905-1" title="1">model=<span class="kw">glm</span>(deg_50C<span class="op">~</span>(sequence<span class="op">+</span>seq_be<span class="op">+</span>seq_af),<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb905-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb905-3" title="3"></a>
<a class="sourceLine" id="cb905-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb905-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1396356</code></pre>
<div class="sourceCode" id="cb907"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb907-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb907-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1411544</code></pre>
<div class="sourceCode" id="cb909"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb909-1" title="1">model=<span class="kw">glm</span>(deg_50C<span class="op">~</span>sequence<span class="op">+</span>index_sequence,<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb909-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb909-3" title="3"></a>
<a class="sourceLine" id="cb909-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb909-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1591999</code></pre>
<div class="sourceCode" id="cb911"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb911-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb911-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1619995</code></pre>
<div class="sourceCode" id="cb913"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb913-1" title="1">model=<span class="kw">glm</span>(deg_50C<span class="op">~</span>sequence<span class="op">+</span>predicted_loop_type<span class="op">+</span>index_sequence,<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb913-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb913-3" title="3">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb913-4" title="4"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1320828</code></pre>
<div class="sourceCode" id="cb915"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb915-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb915-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1333443</code></pre>
<div class="sourceCode" id="cb917"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb917-1" title="1">model=<span class="kw">glm</span>(deg_50C<span class="op">~</span>sequence<span class="op">+</span>structure<span class="op">+</span>index_sequence,<span class="dt">family =</span> Gamma,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb917-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb917-3" title="3"></a>
<a class="sourceLine" id="cb917-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb917-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1374069</code></pre>
<div class="sourceCode" id="cb919"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb919-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb919-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1354089</code></pre>
<p>AUTRES ESSAIS</p>
<div class="sourceCode" id="cb921"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb921-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_50C <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span></a>
<a class="sourceLine" id="cb921-2" title="2"><span class="st">              </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb921-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb921-4" title="4"></a>
<a class="sourceLine" id="cb921-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb921-6" title="6"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2453833</code></pre>
<div class="sourceCode" id="cb923"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb923-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb923-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2555524</code></pre>
<div class="sourceCode" id="cb925"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb925-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_50C <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span></a>
<a class="sourceLine" id="cb925-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb925-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb925-4" title="4"></a>
<a class="sourceLine" id="cb925-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb925-6" title="6"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.220341</code></pre>
<div class="sourceCode" id="cb927"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb927-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb927-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.231462</code></pre>
<div class="sourceCode" id="cb929"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb929-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_50C <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span></a>
<a class="sourceLine" id="cb929-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb929-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb929-4" title="4"></a>
<a class="sourceLine" id="cb929-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb929-6" title="6"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.245631</code></pre>
<div class="sourceCode" id="cb931"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb931-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb931-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2549125</code></pre>
<div class="sourceCode" id="cb933"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb933-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_50C  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span></a>
<a class="sourceLine" id="cb933-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb933-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb933-4" title="4"></a>
<a class="sourceLine" id="cb933-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb935"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb935-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2498609</code></pre>
<div class="sourceCode" id="cb937"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb937-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb939"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb939-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2570512</code></pre>
<div class="sourceCode" id="cb941"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb941-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_50C  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span></a>
<a class="sourceLine" id="cb941-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb941-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb941-4" title="4"></a>
<a class="sourceLine" id="cb941-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb941-6" title="6"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2194804</code></pre>
<div class="sourceCode" id="cb943"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb943-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb943-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2315469</code></pre>
<div class="sourceCode" id="cb945"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb945-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_50C  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span></a>
<a class="sourceLine" id="cb945-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb945-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb945-4" title="4"></a>
<a class="sourceLine" id="cb945-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb947"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb947-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2209513</code></pre>
<div class="sourceCode" id="cb949"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb949-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb951"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb951-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2322129</code></pre>
<div class="sourceCode" id="cb953"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb953-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_50C <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>predicted_loop_type <span class="op">+</span></a>
<a class="sourceLine" id="cb953-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb953-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb953-4" title="4"></a>
<a class="sourceLine" id="cb953-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb955"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb955-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2456706</code></pre>
<div class="sourceCode" id="cb957"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb957-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb959"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb959-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2548212</code></pre>
<div class="sourceCode" id="cb961"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb961-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_50C  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span><span class="st"> </span>predicted_loop_type <span class="op">+</span></a>
<a class="sourceLine" id="cb961-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb961-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb961-4" title="4"></a>
<a class="sourceLine" id="cb961-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb963"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb963-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2185976</code></pre>
<div class="sourceCode" id="cb965"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb965-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb967"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb967-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2309993</code></pre>
<div class="sourceCode" id="cb969"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb969-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_50C <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>seq_be <span class="op">+</span><span class="st"> </span>seq_af <span class="op">+</span><span class="st"> </span>predicted_loop_type <span class="op">+</span></a>
<a class="sourceLine" id="cb969-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb969-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb969-4" title="4"></a>
<a class="sourceLine" id="cb969-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb971"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb971-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2160258</code></pre>
<div class="sourceCode" id="cb973"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb973-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb975"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb975-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2285372</code></pre>
<div class="sourceCode" id="cb977"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb977-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_50C  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>struct_be <span class="op">+</span><span class="st"> </span>predicted_loop_type <span class="op">+</span></a>
<a class="sourceLine" id="cb977-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb977-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb977-4" title="4"></a>
<a class="sourceLine" id="cb977-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb979"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb979-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.247861</code></pre>
<div class="sourceCode" id="cb981"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb981-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb983"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb983-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2569171</code></pre>
<div class="sourceCode" id="cb985"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb985-1" title="1">model =<span class="st"> </span><span class="kw">glm</span>(deg_50C  <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>struct_af <span class="op">+</span><span class="st"> </span>predicted_loop_type <span class="op">+</span></a>
<a class="sourceLine" id="cb985-2" title="2"><span class="st">                         </span>index_sequence <span class="op">+</span><span class="st"> </span>structure,</a>
<a class="sourceLine" id="cb985-3" title="3">            <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb985-4" title="4"></a>
<a class="sourceLine" id="cb985-5" title="5">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb987"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb987-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2499118</code></pre>
<div class="sourceCode" id="cb989"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb989-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb991"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb991-1" title="1"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2592943</code></pre>
<div id="optimisation-8" class="section level4">
<h4>Optimisation</h4>
<div class="sourceCode" id="cb993"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb993-1" title="1">formula_gamma_deg_50C =</a>
<a class="sourceLine" id="cb993-2" title="2"><span class="st">  &quot;deg_50C ~ sequence + predicted_loop_type + index_sequence&quot;</span></a></code></pre></div>
<p>On stocke le meilleur modèle pour la loi gamma.</p>
<div class="sourceCode" id="cb994"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb994-1" title="1">model_gamma_deg_50C =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_gamma_deg_50C,</a>
<a class="sourceLine" id="cb994-2" title="2">                             <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a></code></pre></div>
<div class="sourceCode" id="cb995"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb995-1" title="1"><span class="kw">summary</span>(model_gamma_deg_50C)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = formula_gamma_deg_50C, family = Gamma, data = data_train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.2469  -0.2857  -0.1004   0.1579   2.2475  
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           8.701e-01  9.618e-03  90.471  &lt; 2e-16 ***
## sequenceC             4.006e-02  4.376e-03   9.152  &lt; 2e-16 ***
## sequenceG            -6.763e-02  3.327e-03 -20.326  &lt; 2e-16 ***
## sequenceU            -2.525e-02  4.347e-03  -5.807 6.36e-09 ***
## predicted_loop_typeE -1.308e-01  9.567e-03 -13.677  &lt; 2e-16 ***
## predicted_loop_typeH -3.722e-02  9.749e-03  -3.818 0.000135 ***
## predicted_loop_typeI  8.267e-02  1.029e-02   8.031 9.80e-16 ***
## predicted_loop_typeM -9.747e-02  1.129e-02  -8.630  &lt; 2e-16 ***
## predicted_loop_typeS  3.103e-01  9.462e-03  32.793  &lt; 2e-16 ***
## predicted_loop_typeX -1.660e-01  1.104e-02 -15.029  &lt; 2e-16 ***
## index_sequence        4.189e-03  7.929e-05  52.836  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.1393188)
## 
##     Null deviance: 14399  on 86427  degrees of freedom
## Residual deviance: 10301  on 86417  degrees of freedom
## AIC: 34973
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb997"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb997-1" title="1">y_pred_gamma_train =<span class="st"> </span><span class="kw">predict.glm</span>(model_gamma_deg_50C,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb997-2" title="2">error_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb997-3" title="3"><span class="kw">print</span>(error_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1320828</code></pre>
<div class="sourceCode" id="cb999"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb999-1" title="1">y_pred_gamma_val=<span class="kw">predict.glm</span>(model_gamma_deg_50C,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb999-2" title="2">error_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb999-3" title="3"><span class="kw">print</span>(error_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1333443</code></pre>
<div class="sourceCode" id="cb1001"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1001-1" title="1">models_deg_50C &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_50C, <span class="st">&quot;model_gamma&quot;</span>)</a>
<a class="sourceLine" id="cb1001-2" title="2">errors_deg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_50C_train, error_gamma_train)</a>
<a class="sourceLine" id="cb1001-3" title="3">errors_deg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_50C_val, error_gamma_val)</a>
<a class="sourceLine" id="cb1001-4" title="4"><span class="kw">rm</span>(error_gamma_val, error_gamma_train, y_pred_gamma_train, y_pred_gamma_val)</a></code></pre></div>
<div id="stepaic-8" class="section level5">
<h5>StepAIC</h5>
<div class="sourceCode" id="cb1002"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1002-1" title="1">model_gamma_deg_50C_aic =<span class="st"> </span><span class="kw">stepAIC</span>(model_gamma_deg_50C, <span class="dt">trace =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>Pas de changement du modèle. Cela est sûrement dû au fait qu’on n’a pas assez de variables initialement.</p>
<div class="sourceCode" id="cb1003"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1003-1" title="1"><span class="kw">summary</span>(model_gamma_deg_50C_aic)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = deg_50C ~ sequence + predicted_loop_type + index_sequence, 
##     family = Gamma, data = data_train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.2469  -0.2857  -0.1004   0.1579   2.2475  
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           8.701e-01  9.618e-03  90.471  &lt; 2e-16 ***
## sequenceC             4.006e-02  4.376e-03   9.152  &lt; 2e-16 ***
## sequenceG            -6.763e-02  3.327e-03 -20.326  &lt; 2e-16 ***
## sequenceU            -2.525e-02  4.347e-03  -5.807 6.36e-09 ***
## predicted_loop_typeE -1.308e-01  9.567e-03 -13.677  &lt; 2e-16 ***
## predicted_loop_typeH -3.722e-02  9.749e-03  -3.818 0.000135 ***
## predicted_loop_typeI  8.267e-02  1.029e-02   8.031 9.80e-16 ***
## predicted_loop_typeM -9.747e-02  1.129e-02  -8.630  &lt; 2e-16 ***
## predicted_loop_typeS  3.103e-01  9.462e-03  32.793  &lt; 2e-16 ***
## predicted_loop_typeX -1.660e-01  1.104e-02 -15.029  &lt; 2e-16 ***
## index_sequence        4.189e-03  7.929e-05  52.836  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.1393188)
## 
##     Null deviance: 14399  on 86427  degrees of freedom
## Residual deviance: 10301  on 86417  degrees of freedom
## AIC: 34973
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Pas de changement sur les performances de prédiction.</p>
<div class="sourceCode" id="cb1005"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1005-1" title="1">y_pred_gamma_train_aic =<span class="st"> </span><span class="kw">predict.glm</span>(model_gamma_deg_50C_aic,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb1005-2" title="2"><span class="kw">mean</span>((y_pred_gamma_train_aic<span class="op">-</span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1320828</code></pre>
<div class="sourceCode" id="cb1007"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1007-1" title="1">y_pred_gamma_val_aic=<span class="kw">predict.glm</span>(model_gamma_deg_50C_aic,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb1007-2" title="2"><span class="kw">mean</span>((y_pred_gamma_val_aic<span class="op">-</span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1333443</code></pre>
<div class="sourceCode" id="cb1009"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1009-1" title="1"><span class="kw">rm</span>(model_gamma_deg_50C_aic, y_pred_gamma_train_aic, y_pred_gamma_val_aic)</a></code></pre></div>
<p>On va maintenant tester des pénalisations ridge, lasso et elastic-net.</p>
</div>
<div id="pénalisation-ridge-et-lasso-8" class="section level5">
<h5>Pénalisation ridge et lasso</h5>
<p>On commence par calculer la matrice de design du model_gamma_deg_50C sur le train et le test.</p>
<div class="sourceCode" id="cb1010"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1010-1" title="1"><span class="co"># Matrice de design du train</span></a>
<a class="sourceLine" id="cb1010-2" title="2">data_train_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_gamma_deg_50C)</a>
<a class="sourceLine" id="cb1010-3" title="3"><span class="co">#head(data_train_pen)</span></a></code></pre></div>
<div class="sourceCode" id="cb1011"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1011-1" title="1"><span class="co"># Pour faire la matrice de design de la validation</span></a>
<a class="sourceLine" id="cb1011-2" title="2">model_gamma_deg_50C_val =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_gamma_deg_50C,</a>
<a class="sourceLine" id="cb1011-3" title="3">                                 <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_val)</a>
<a class="sourceLine" id="cb1011-4" title="4">data_val_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_gamma_deg_50C_val)</a>
<a class="sourceLine" id="cb1011-5" title="5"><span class="co">#head(data_val_pen)</span></a>
<a class="sourceLine" id="cb1011-6" title="6"></a>
<a class="sourceLine" id="cb1011-7" title="7"><span class="co"># On supprime le modèle sur le test</span></a>
<a class="sourceLine" id="cb1011-8" title="8"><span class="kw">rm</span>(model_gamma_deg_50C_val)</a></code></pre></div>
<p>On pénalise le model_gamma_deg_50C avec une pénalité ridge. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb1012"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1012-1" title="1"><span class="co">#model_gamma_deg_50C_pen_ridge = cv.glmnet(data_train_pen, data_train$deg_50C,</span></a>
<a class="sourceLine" id="cb1012-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb1012-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 0)</span></a>
<a class="sourceLine" id="cb1012-4" title="4"><span class="co">## lambda.min est le lambda qui minimise l&#39;erreur de cross validation</span></a>
<a class="sourceLine" id="cb1012-5" title="5"><span class="co">#coef(model_gamma_deg_50C_pen_ridge, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb1013"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1013-1" title="1"><span class="co">#saveRDS(model_gamma_deg_50C_pen_ridge, &quot;model_gamma_deg_50C_pen_ridge.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb1014"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1014-1" title="1">model_gamma_deg_50C_pen_ridge &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_50C_pen_ridge.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation ridge.</p>
<div class="sourceCode" id="cb1015"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1015-1" title="1">y_pred_ridge_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_50C_pen_ridge, data_train_pen,</a>
<a class="sourceLine" id="cb1015-2" title="2">                                   <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb1015-3" title="3">y_pred_ridge_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_50C_pen_ridge, data_val_pen,</a>
<a class="sourceLine" id="cb1015-4" title="4">                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb1015-5" title="5">error_ridge_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_ridge_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1015-6" title="6"><span class="kw">print</span>(error_ridge_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1400484</code></pre>
<div class="sourceCode" id="cb1017"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1017-1" title="1">error_ridge_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_ridge_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1017-2" title="2"><span class="kw">print</span>(error_ridge_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1423509</code></pre>
<p>On pénalise le model_gamma_deg_50C avec une pénalité lasso. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb1019"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1019-1" title="1"><span class="co">#model_gamma_deg_50C_pen_lasso = cv.glmnet(data_train_pen, data_train$deg_50C,</span></a>
<a class="sourceLine" id="cb1019-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb1019-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 1)</span></a>
<a class="sourceLine" id="cb1019-4" title="4"><span class="co">#coef(model_gamma_deg_50C_pen_lasso, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb1020"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1020-1" title="1"><span class="co">#saveRDS(model_gamma_deg_50C_pen_lasso, &quot;model_gamma_deg_50C_pen_lasso.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb1021"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1021-1" title="1">model_gamma_deg_50C_pen_lasso &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_50C_pen_lasso.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation lasso.</p>
<div class="sourceCode" id="cb1022"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1022-1" title="1">y_pred_lasso_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_50C_pen_lasso, data_train_pen,</a>
<a class="sourceLine" id="cb1022-2" title="2">                                   <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb1022-3" title="3">error_lasso_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_lasso_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1022-4" title="4"><span class="kw">print</span>(error_lasso_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1321074</code></pre>
<div class="sourceCode" id="cb1024"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1024-1" title="1">y_pred_lasso_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_50C_pen_lasso, data_val_pen,</a>
<a class="sourceLine" id="cb1024-2" title="2">                                 <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb1024-3" title="3">error_lasso_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_lasso_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1024-4" title="4"><span class="kw">print</span>(error_lasso_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1332212</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb1026"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1026-1" title="1">models_deg_50C &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_50C, <span class="st">&quot;model_gamma_ridge&quot;</span>, <span class="st">&quot;model_gamma_lasso&quot;</span>)</a>
<a class="sourceLine" id="cb1026-2" title="2">errors_deg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_50C_train, error_ridge_gamma_train,</a>
<a class="sourceLine" id="cb1026-3" title="3">                             error_lasso_gamma_train)</a>
<a class="sourceLine" id="cb1026-4" title="4">errors_deg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_50C_val, error_ridge_gamma_val, error_lasso_gamma_val)</a>
<a class="sourceLine" id="cb1026-5" title="5"><span class="kw">rm</span>(error_ridge_gamma_val, error_lasso_gamma_val,</a>
<a class="sourceLine" id="cb1026-6" title="6">   error_ridge_gamma_train, error_lasso_gamma_train,</a>
<a class="sourceLine" id="cb1026-7" title="7">   y_pred_ridge_gamma_train, y_pred_ridge_gamma_val,</a>
<a class="sourceLine" id="cb1026-8" title="8">   y_pred_lasso_gamma_train, y_pred_lasso_gamma_val)</a></code></pre></div>
</div>
<div id="pénalisation-elastic-net-8" class="section level5">
<h5>Pénalisation elastic-net</h5>
<p>On choisit <span class="math inline">\(\alpha\)</span> qui minimise le MSE sur la validation.</p>
<div class="sourceCode" id="cb1027"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1027-1" title="1"><span class="co">#alpha_opti_enet_gamma_deg_50C =</span></a>
<a class="sourceLine" id="cb1027-2" title="2"><span class="co">#  alpha_opti_enet(data_train = data_train_pen, data_val = data_val_pen,</span></a>
<a class="sourceLine" id="cb1027-3" title="3"><span class="co">#                  y_true_train = data_train$deg_50C,</span></a>
<a class="sourceLine" id="cb1027-4" title="4"><span class="co">#                  y_true_val = data_val$deg_50C,</span></a>
<a class="sourceLine" id="cb1027-5" title="5"><span class="co">#                  family = Gamma, cores = detectCores() - 2)</span></a></code></pre></div>
<p>Au final, le meilleur modèle est le lasso.</p>
<div class="sourceCode" id="cb1028"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1028-1" title="1"><span class="co">#print(alpha_opti_enet_gamma_deg_50C)</span></a></code></pre></div>
<p>On construit le modèle avec le choix optimal pour <span class="math inline">\(\alpha\)</span>.</p>
<div class="sourceCode" id="cb1029"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1029-1" title="1"><span class="co">#model_gamma_deg_50C_pen_enet = cv.glmnet(data_train_pen, data_train$deg_50C,</span></a>
<a class="sourceLine" id="cb1029-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb1029-3" title="3"><span class="co">#                                             standardize = FALSE,</span></a>
<a class="sourceLine" id="cb1029-4" title="4"><span class="co">#                                             alpha = alpha_opti_enet_gamma_deg_50C)</span></a>
<a class="sourceLine" id="cb1029-5" title="5"><span class="co">#coef(model_gamma_deg_50C_pen_enet, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb1030"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1030-1" title="1"><span class="co">#saveRDS(model_gamma_deg_50C_pen_enet, &quot;model_gamma_deg_50C_pen_enet.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb1031"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1031-1" title="1">model_gamma_deg_50C_pen_enet &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_50C_pen_enet.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation elastic-net.</p>
<div class="sourceCode" id="cb1032"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1032-1" title="1">y_pred_enet_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_50C_pen_enet, data_train_pen,</a>
<a class="sourceLine" id="cb1032-2" title="2">                                   <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb1032-3" title="3">error_enet_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_enet_gamma_train <span class="op">-</span><span class="st"> </span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1032-4" title="4"><span class="kw">print</span>(error_enet_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1321074</code></pre>
<div class="sourceCode" id="cb1034"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1034-1" title="1">y_pred_enet_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_50C_pen_enet, data_val_pen,</a>
<a class="sourceLine" id="cb1034-2" title="2">                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb1034-3" title="3">error_enet_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_enet_gamma_val <span class="op">-</span><span class="st"> </span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1034-4" title="4"><span class="kw">print</span>(error_enet_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1332212</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb1036"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1036-1" title="1">models_deg_50C &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_50C, <span class="st">&quot;model_gamma_enet&quot;</span>)</a>
<a class="sourceLine" id="cb1036-2" title="2">errors_deg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_50C_train, error_enet_gamma_train)</a>
<a class="sourceLine" id="cb1036-3" title="3">errors_deg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_50C_val, error_enet_gamma_val)</a>
<a class="sourceLine" id="cb1036-4" title="4"><span class="kw">rm</span>(error_enet_gamma_train, error_enet_gamma_val,</a>
<a class="sourceLine" id="cb1036-5" title="5">   y_pred_enet_gamma_train, y_pred_enet_gamma_val)</a></code></pre></div>
<div class="sourceCode" id="cb1037"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1037-1" title="1"><span class="kw">data.frame</span>(models_deg_50C, errors_deg_50C_train, errors_deg_50C_val)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["models_deg_50C"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_deg_50C_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_deg_50C_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma","2":"0.1320828","3":"0.1333443"},{"1":"model_gamma_ridge","2":"0.1400484","3":"0.1423509"},{"1":"model_gamma_lasso","2":"0.1321074","3":"0.1332212"},{"1":"model_gamma_enet","2":"0.1321074","3":"0.1332212"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<div id="inverse.gaussian-4" class="section level3">
<h3>Inverse.gaussian</h3>
<div class="sourceCode" id="cb1038"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1038-1" title="1">model=<span class="kw">glm</span>(deg_50C<span class="op">~</span>sequence,<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb1038-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb1038-3" title="3"></a>
<a class="sourceLine" id="cb1038-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb1038-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1730893</code></pre>
<div class="sourceCode" id="cb1040"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1040-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb1040-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1772408</code></pre>
<div class="sourceCode" id="cb1042"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1042-1" title="1">model=<span class="kw">glm</span>(deg_50C<span class="op">~</span>(sequence<span class="op">+</span>seq_be<span class="op">+</span>seq_af),<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb1042-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb1042-3" title="3"></a>
<a class="sourceLine" id="cb1042-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb1042-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1400217</code></pre>
<div class="sourceCode" id="cb1044"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1044-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb1044-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1414089</code></pre>
<div class="sourceCode" id="cb1046"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1046-1" title="1">model=<span class="kw">glm</span>(deg_50C<span class="op">~</span>sequence<span class="op">+</span>index_sequence,<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb1046-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb1046-3" title="3"></a>
<a class="sourceLine" id="cb1046-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb1046-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1576319</code></pre>
<div class="sourceCode" id="cb1048"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1048-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb1048-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1602935</code></pre>
<div class="sourceCode" id="cb1050"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1050-1" title="1">model=<span class="kw">glm</span>(deg_50C<span class="op">~</span>sequence<span class="op">+</span>predicted_loop_type<span class="op">+</span>index_sequence,<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb1050-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb1050-3" title="3">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb1050-4" title="4"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1304168</code></pre>
<div class="sourceCode" id="cb1052"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1052-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb1052-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1316306</code></pre>
<div class="sourceCode" id="cb1054"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1054-1" title="1">model=<span class="kw">glm</span>(deg_50C<span class="op">~</span>sequence<span class="op">+</span>structure<span class="op">+</span>index_sequence,<span class="dt">family =</span> inverse.gaussian,<span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb1054-2" title="2"><span class="co">#summary(model)</span></a>
<a class="sourceLine" id="cb1054-3" title="3"></a>
<a class="sourceLine" id="cb1054-4" title="4">y_pred=<span class="kw">predict.glm</span>(model,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb1054-5" title="5"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1354908</code></pre>
<div class="sourceCode" id="cb1056"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1056-1" title="1">y_pred=<span class="kw">predict.glm</span>(model,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb1056-2" title="2"><span class="kw">mean</span>((y_pred<span class="op">-</span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1337462</code></pre>
<div id="optimisation-9" class="section level4">
<h4>Optimisation</h4>
<div class="sourceCode" id="cb1058"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1058-1" title="1">formula_inverse_gaussian_deg_50C =</a>
<a class="sourceLine" id="cb1058-2" title="2"><span class="st">  &quot;deg_50C ~ sequence + predicted_loop_type + index_sequence&quot;</span></a></code></pre></div>
<p>On stocke le meilleur modèle pour la loi gamma.</p>
<div class="sourceCode" id="cb1059"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1059-1" title="1">model_inverse_gaussian_deg_50C =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_inverse_gaussian_deg_50C,</a>
<a class="sourceLine" id="cb1059-2" title="2">                                        <span class="dt">family =</span> inverse.gaussian, <span class="dt">data =</span> data_train)</a></code></pre></div>
<div class="sourceCode" id="cb1060"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1060-1" title="1"><span class="kw">summary</span>(model_inverse_gaussian_deg_50C)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = formula_inverse_gaussian_deg_50C, family = inverse.gaussian, 
##     data = data_train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -6.4807  -0.3241  -0.1086   0.1602   2.1305  
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           0.7339868  0.0202339  36.275  &lt; 2e-16 ***
## sequenceC             0.1054331  0.0097512  10.812  &lt; 2e-16 ***
## sequenceG            -0.1186869  0.0066361 -17.885  &lt; 2e-16 ***
## sequenceU            -0.0453541  0.0092933  -4.880 1.06e-06 ***
## predicted_loop_typeE -0.2034794  0.0200323 -10.158  &lt; 2e-16 ***
## predicted_loop_typeH -0.0752706  0.0204517  -3.680 0.000233 ***
## predicted_loop_typeI  0.1685831  0.0218130   7.729 1.10e-14 ***
## predicted_loop_typeM -0.1873054  0.0234025  -8.004 1.22e-15 ***
## predicted_loop_typeS  0.7069573  0.0200728  35.220  &lt; 2e-16 ***
## predicted_loop_typeX -0.3291884  0.0229480 -14.345  &lt; 2e-16 ***
## index_sequence        0.0085471  0.0001729  49.427  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for inverse.gaussian family taken to be 0.1543282)
## 
##     Null deviance: 15787  on 86427  degrees of freedom
## Residual deviance: 11462  on 86417  degrees of freedom
## AIC: 28388
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb1062"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1062-1" title="1">y_pred_inverse_gaussian_train =<span class="st"> </span><span class="kw">predict.glm</span>(model_inverse_gaussian_deg_50C,</a>
<a class="sourceLine" id="cb1062-2" title="2">                                            data_train, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb1062-3" title="3">error_inverse_gaussian_train &lt;-</a>
<a class="sourceLine" id="cb1062-4" title="4"><span class="st">  </span><span class="kw">mean</span>((y_pred_inverse_gaussian_train<span class="op">-</span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1062-5" title="5"><span class="kw">print</span>(error_inverse_gaussian_train)</a></code></pre></div>
<pre><code>## [1] 0.1304168</code></pre>
<div class="sourceCode" id="cb1064"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1064-1" title="1">y_pred_inverse_gaussian_val =<span class="st"> </span><span class="kw">predict.glm</span>(model_inverse_gaussian_deg_50C,</a>
<a class="sourceLine" id="cb1064-2" title="2">                                          data_val, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb1064-3" title="3">error_inverse_gaussian_val &lt;-</a>
<a class="sourceLine" id="cb1064-4" title="4"><span class="st">  </span><span class="kw">mean</span>((y_pred_inverse_gaussian_val <span class="op">-</span><span class="st"> </span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1064-5" title="5"><span class="kw">print</span>(error_inverse_gaussian_val)</a></code></pre></div>
<pre><code>## [1] 0.1316306</code></pre>
<div class="sourceCode" id="cb1066"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1066-1" title="1">models_deg_50C &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_50C, <span class="st">&quot;model_inverse_gaussian&quot;</span>)</a>
<a class="sourceLine" id="cb1066-2" title="2">errors_deg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_50C_train, error_inverse_gaussian_train)</a>
<a class="sourceLine" id="cb1066-3" title="3">errors_deg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_50C_val, error_inverse_gaussian_val)</a>
<a class="sourceLine" id="cb1066-4" title="4"><span class="kw">rm</span>(error_inverse_gaussian_val, error_inverse_gaussian_train,</a>
<a class="sourceLine" id="cb1066-5" title="5">   y_pred_inverse_gaussian_train, y_pred_inverse_gaussian_val)</a></code></pre></div>
<div id="stepaic-9" class="section level5">
<h5>StepAIC</h5>
<div class="sourceCode" id="cb1067"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1067-1" title="1">model_inverse_gaussian_deg_50C_aic =</a>
<a class="sourceLine" id="cb1067-2" title="2"><span class="st">  </span><span class="kw">stepAIC</span>(model_inverse_gaussian_deg_50C, <span class="dt">trace =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>Pas de changement du modèle. Cela est sûrement dû au fait qu’on n’a pas assez de variables initialement.</p>
<div class="sourceCode" id="cb1068"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1068-1" title="1"><span class="kw">summary</span>(model_inverse_gaussian_deg_50C_aic)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = deg_50C ~ sequence + predicted_loop_type + index_sequence, 
##     family = inverse.gaussian, data = data_train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -6.4807  -0.3241  -0.1086   0.1602   2.1305  
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           0.7339868  0.0202339  36.275  &lt; 2e-16 ***
## sequenceC             0.1054331  0.0097512  10.812  &lt; 2e-16 ***
## sequenceG            -0.1186869  0.0066361 -17.885  &lt; 2e-16 ***
## sequenceU            -0.0453541  0.0092933  -4.880 1.06e-06 ***
## predicted_loop_typeE -0.2034794  0.0200323 -10.158  &lt; 2e-16 ***
## predicted_loop_typeH -0.0752706  0.0204517  -3.680 0.000233 ***
## predicted_loop_typeI  0.1685831  0.0218130   7.729 1.10e-14 ***
## predicted_loop_typeM -0.1873054  0.0234025  -8.004 1.22e-15 ***
## predicted_loop_typeS  0.7069573  0.0200728  35.220  &lt; 2e-16 ***
## predicted_loop_typeX -0.3291884  0.0229480 -14.345  &lt; 2e-16 ***
## index_sequence        0.0085471  0.0001729  49.427  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for inverse.gaussian family taken to be 0.1543282)
## 
##     Null deviance: 15787  on 86427  degrees of freedom
## Residual deviance: 11462  on 86417  degrees of freedom
## AIC: 28388
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>Pas de changement sur les performances de prédiction.</p>
<div class="sourceCode" id="cb1070"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1070-1" title="1">y_pred_inverse_gaussian_train_aic =<span class="st"> </span><span class="kw">predict.glm</span>(model_inverse_gaussian_deg_50C_aic,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb1070-2" title="2"><span class="kw">mean</span>((y_pred_inverse_gaussian_train_aic<span class="op">-</span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1304168</code></pre>
<div class="sourceCode" id="cb1072"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1072-1" title="1">y_pred_inverse_gaussian_val_aic=<span class="kw">predict.glm</span>(model_inverse_gaussian_deg_50C_aic,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb1072-2" title="2"><span class="kw">mean</span>((y_pred_inverse_gaussian_val_aic<span class="op">-</span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1316306</code></pre>
<div class="sourceCode" id="cb1074"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1074-1" title="1"><span class="kw">rm</span>(model_inverse_gaussian_deg_50C_aic, y_pred_inverse_gaussian_train_aic, y_pred_inverse_gaussian_val_aic)</a></code></pre></div>
<p>On va maintenant tester des pénalisations ridge, lasso et elastic-net.</p>
</div>
<div id="pénalisation-ridge-et-lasso-9" class="section level5">
<h5>Pénalisation ridge et lasso</h5>
<p>On commence par calculer la matrice de design du model_inverse_gaussian_deg_50C sur le train et le test.</p>
<div class="sourceCode" id="cb1075"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1075-1" title="1"><span class="co"># Matrice de design du train</span></a>
<a class="sourceLine" id="cb1075-2" title="2">data_train_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_inverse_gaussian_deg_50C)</a>
<a class="sourceLine" id="cb1075-3" title="3"><span class="co">#head(data_train_pen)</span></a></code></pre></div>
<div class="sourceCode" id="cb1076"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1076-1" title="1"><span class="co"># Pour faire la matrice de design de la validation</span></a>
<a class="sourceLine" id="cb1076-2" title="2">model_inverse_gaussian_deg_50C_val =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_inverse_gaussian_deg_50C,</a>
<a class="sourceLine" id="cb1076-3" title="3">                                 <span class="dt">family =</span> inverse.gaussian, <span class="dt">data =</span> data_val)</a>
<a class="sourceLine" id="cb1076-4" title="4">data_val_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_inverse_gaussian_deg_50C_val)</a>
<a class="sourceLine" id="cb1076-5" title="5"><span class="co">#head(data_val_pen)</span></a>
<a class="sourceLine" id="cb1076-6" title="6"></a>
<a class="sourceLine" id="cb1076-7" title="7"><span class="co"># On supprime le modèle sur le test</span></a>
<a class="sourceLine" id="cb1076-8" title="8"><span class="kw">rm</span>(model_inverse_gaussian_deg_50C_val)</a></code></pre></div>
<p>On pénalise le model_inverse_gaussian_deg_50C avec une pénalité ridge. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb1077"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1077-1" title="1"><span class="co">#model_inverse_gaussian_deg_50C_pen_ridge = cv.glmnet(data_train_pen, data_train$deg_50C,</span></a>
<a class="sourceLine" id="cb1077-2" title="2"><span class="co">#                                             family = inverse.gaussian, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb1077-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 0)</span></a>
<a class="sourceLine" id="cb1077-4" title="4"><span class="co">## lambda.min est le lambda qui minimise l&#39;erreur de cross validation</span></a>
<a class="sourceLine" id="cb1077-5" title="5"><span class="co">#coef(model_inverse_gaussian_deg_50C_pen_ridge, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb1078"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1078-1" title="1"><span class="co">#saveRDS(model_inverse_gaussian_deg_50C_pen_ridge,</span></a>
<a class="sourceLine" id="cb1078-2" title="2"><span class="co">#        &quot;model_inverse_gaussian_deg_50C_pen_ridge.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb1079"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1079-1" title="1">model_inverse_gaussian_deg_50C_pen_ridge &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1079-2" title="2"><span class="st">  </span><span class="kw">readRDS</span>(<span class="st">&quot;model_inverse_gaussian_deg_50C_pen_ridge.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation ridge.</p>
<div class="sourceCode" id="cb1080"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1080-1" title="1">y_pred_ridge_inverse_gaussian_train =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_50C_pen_ridge,</a>
<a class="sourceLine" id="cb1080-2" title="2">                                              data_train_pen,</a>
<a class="sourceLine" id="cb1080-3" title="3">                                              <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb1080-4" title="4">y_pred_ridge_inverse_gaussian_val =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_50C_pen_ridge,</a>
<a class="sourceLine" id="cb1080-5" title="5">                                            data_val_pen,</a>
<a class="sourceLine" id="cb1080-6" title="6">                                            <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb1080-7" title="7"></a>
<a class="sourceLine" id="cb1080-8" title="8">error_ridge_inverse_gaussian_train &lt;-</a>
<a class="sourceLine" id="cb1080-9" title="9"><span class="st">  </span><span class="kw">mean</span>((y_pred_ridge_inverse_gaussian_train<span class="op">-</span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1080-10" title="10"><span class="kw">print</span>(error_ridge_inverse_gaussian_train)</a></code></pre></div>
<pre><code>## [1] 0.1773207</code></pre>
<div class="sourceCode" id="cb1082"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1082-1" title="1">error_ridge_inverse_gaussian_val &lt;-</a>
<a class="sourceLine" id="cb1082-2" title="2"><span class="st">  </span><span class="kw">mean</span>((y_pred_ridge_inverse_gaussian_val<span class="op">-</span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1082-3" title="3"><span class="kw">print</span>(error_ridge_inverse_gaussian_val)</a></code></pre></div>
<pre><code>## [1] 0.1820173</code></pre>
<p>On pénalise le model_inverse_gaussian_deg_50C avec une pénalité lasso. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb1084"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1084-1" title="1"><span class="co">#model_inverse_gaussian_deg_50C_pen_lasso = cv.glmnet(data_train_pen, data_train$deg_50C,</span></a>
<a class="sourceLine" id="cb1084-2" title="2"><span class="co">#                                             family = inverse.gaussian, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb1084-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 1)</span></a>
<a class="sourceLine" id="cb1084-4" title="4"><span class="co">#coef(model_inverse_gaussian_deg_50C_pen_lasso, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb1085"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1085-1" title="1"><span class="co">#saveRDS(model_inverse_gaussian_deg_50C_pen_lasso,</span></a>
<a class="sourceLine" id="cb1085-2" title="2"><span class="co">#        &quot;model_inverse_gaussian_deg_50C_pen_lasso.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb1086"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1086-1" title="1">model_inverse_gaussian_deg_50C_pen_lasso &lt;-</a>
<a class="sourceLine" id="cb1086-2" title="2"><span class="st">  </span><span class="kw">readRDS</span>(<span class="st">&quot;model_inverse_gaussian_deg_50C_pen_lasso.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation lasso.</p>
<div class="sourceCode" id="cb1087"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1087-1" title="1">y_pred_lasso_inverse_gaussian_train =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_50C_pen_lasso,</a>
<a class="sourceLine" id="cb1087-2" title="2">                                              data_train_pen,</a>
<a class="sourceLine" id="cb1087-3" title="3">                                              <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb1087-4" title="4">error_lasso_inverse_gaussian_train &lt;-</a>
<a class="sourceLine" id="cb1087-5" title="5"><span class="st">  </span><span class="kw">mean</span>((y_pred_lasso_inverse_gaussian_train<span class="op">-</span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1087-6" title="6"><span class="kw">print</span>(error_lasso_inverse_gaussian_train)</a></code></pre></div>
<pre><code>## [1] 0.1727285</code></pre>
<div class="sourceCode" id="cb1089"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1089-1" title="1">y_pred_lasso_inverse_gaussian_val =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_50C_pen_lasso,</a>
<a class="sourceLine" id="cb1089-2" title="2">                                            data_val_pen,</a>
<a class="sourceLine" id="cb1089-3" title="3">                                            <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb1089-4" title="4">error_lasso_inverse_gaussian_val &lt;-</a>
<a class="sourceLine" id="cb1089-5" title="5"><span class="st">  </span><span class="kw">mean</span>((y_pred_lasso_inverse_gaussian_val<span class="op">-</span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1089-6" title="6"><span class="kw">print</span>(error_lasso_inverse_gaussian_val)</a></code></pre></div>
<pre><code>## [1] 0.1771532</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb1091"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1091-1" title="1">models_deg_50C &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_50C, <span class="st">&quot;model_inverse_gaussian_ridge&quot;</span>, <span class="st">&quot;model_inverse_gaussian_lasso&quot;</span>)</a>
<a class="sourceLine" id="cb1091-2" title="2">errors_deg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_50C_train, error_ridge_inverse_gaussian_train,</a>
<a class="sourceLine" id="cb1091-3" title="3">                             error_lasso_inverse_gaussian_train)</a>
<a class="sourceLine" id="cb1091-4" title="4">errors_deg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_50C_val, error_ridge_inverse_gaussian_val, error_lasso_inverse_gaussian_val)</a>
<a class="sourceLine" id="cb1091-5" title="5"><span class="kw">rm</span>(error_ridge_inverse_gaussian_val, error_lasso_inverse_gaussian_val,</a>
<a class="sourceLine" id="cb1091-6" title="6">   error_ridge_inverse_gaussian_train, error_lasso_inverse_gaussian_train,</a>
<a class="sourceLine" id="cb1091-7" title="7">   y_pred_ridge_inverse_gaussian_train, y_pred_ridge_inverse_gaussian_val,</a>
<a class="sourceLine" id="cb1091-8" title="8">   y_pred_lasso_inverse_gaussian_train, y_pred_lasso_inverse_gaussian_val)</a></code></pre></div>
</div>
<div id="pénalisation-elastic-net-9" class="section level5">
<h5>Pénalisation elastic-net</h5>
<p>On choisit <span class="math inline">\(\alpha\)</span> qui minimise le MSE sur la validation.</p>
<div class="sourceCode" id="cb1092"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1092-1" title="1"><span class="co">#alpha_opti_enet_inverse_gaussian_deg_50C =</span></a>
<a class="sourceLine" id="cb1092-2" title="2"><span class="co">#  alpha_opti_enet(data_train = data_train_pen, data_val = data_val_pen,</span></a>
<a class="sourceLine" id="cb1092-3" title="3"><span class="co">#                  y_true_train = data_train$deg_50C,</span></a>
<a class="sourceLine" id="cb1092-4" title="4"><span class="co">#                  y_true_val = data_val$deg_50C,</span></a>
<a class="sourceLine" id="cb1092-5" title="5"><span class="co">#                  family = inverse.gaussian, cores = detectCores() - 2)</span></a></code></pre></div>
<p>Au final, le meilleur modèle est le lasso.</p>
<div class="sourceCode" id="cb1093"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1093-1" title="1"><span class="co">#print(alpha_opti_enet_inverse_gaussian_deg_50C)</span></a></code></pre></div>
<p>On construit le modèle avec le choix optimal pour <span class="math inline">\(\alpha\)</span>.</p>
<div class="sourceCode" id="cb1094"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1094-1" title="1"><span class="co">#model_inverse_gaussian_deg_50C_pen_enet = cv.glmnet(data_train_pen, data_train$deg_50C,</span></a>
<a class="sourceLine" id="cb1094-2" title="2"><span class="co">#                                             family = inverse.gaussian, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb1094-3" title="3"><span class="co">#                                             standardize = FALSE,</span></a>
<a class="sourceLine" id="cb1094-4" title="4"><span class="co">#                                             alpha = alpha_opti_enet_inverse_gaussian_deg_50C)</span></a>
<a class="sourceLine" id="cb1094-5" title="5"><span class="co">#coef(model_inverse_gaussian_deg_50C_pen_enet, s = &quot;lambda.min&quot;)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb1095"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1095-1" title="1"><span class="co">#saveRDS(model_inverse_gaussian_deg_50C_pen_enet,</span></a>
<a class="sourceLine" id="cb1095-2" title="2"><span class="co">#        &quot;model_inverse_gaussian_deg_50C_pen_enet.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb1096"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1096-1" title="1">model_inverse_gaussian_deg_50C_pen_enet &lt;-</a>
<a class="sourceLine" id="cb1096-2" title="2"><span class="st">  </span><span class="kw">readRDS</span>(<span class="st">&quot;model_inverse_gaussian_deg_50C_pen_enet.rds&quot;</span>)</a></code></pre></div>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation elastic-net.</p>
<div class="sourceCode" id="cb1097"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1097-1" title="1">y_pred_enet_inverse_gaussian_train =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_50C_pen_enet,</a>
<a class="sourceLine" id="cb1097-2" title="2">                                             data_train_pen,</a>
<a class="sourceLine" id="cb1097-3" title="3">                                             <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb1097-4" title="4">error_enet_inverse_gaussian_train &lt;-</a>
<a class="sourceLine" id="cb1097-5" title="5"><span class="st">  </span><span class="kw">mean</span>((y_pred_enet_inverse_gaussian_train <span class="op">-</span><span class="st"> </span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1097-6" title="6"><span class="kw">print</span>(error_enet_inverse_gaussian_train)</a></code></pre></div>
<pre><code>## [1] 0.1727285</code></pre>
<div class="sourceCode" id="cb1099"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1099-1" title="1">y_pred_enet_inverse_gaussian_val =<span class="st"> </span><span class="kw">predict</span>(model_inverse_gaussian_deg_50C_pen_enet,</a>
<a class="sourceLine" id="cb1099-2" title="2">                                           data_val_pen,</a>
<a class="sourceLine" id="cb1099-3" title="3">                                           <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb1099-4" title="4">error_enet_inverse_gaussian_val &lt;-</a>
<a class="sourceLine" id="cb1099-5" title="5"><span class="st">  </span><span class="kw">mean</span>((y_pred_enet_inverse_gaussian_val <span class="op">-</span><span class="st"> </span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1099-6" title="6"><span class="kw">print</span>(error_enet_inverse_gaussian_val)</a></code></pre></div>
<pre><code>## [1] 0.1771532</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb1101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1101-1" title="1">models_deg_50C &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_50C, <span class="st">&quot;model_inverse_gaussian_enet&quot;</span>)</a>
<a class="sourceLine" id="cb1101-2" title="2">errors_deg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_50C_train, error_enet_inverse_gaussian_train)</a>
<a class="sourceLine" id="cb1101-3" title="3">errors_deg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_50C_val, error_enet_inverse_gaussian_val)</a>
<a class="sourceLine" id="cb1101-4" title="4"><span class="kw">rm</span>(error_enet_inverse_gaussian_train, error_enet_inverse_gaussian_val,</a>
<a class="sourceLine" id="cb1101-5" title="5">   y_pred_enet_inverse_gaussian_train, y_pred_enet_inverse_gaussian_val)</a></code></pre></div>
</div>
</div>
</div>
<div id="récapitulatif-des-résultats-4" class="section level3">
<h3>Récapitulatif des résultats</h3>
<div class="sourceCode" id="cb1102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1102-1" title="1">models_deg_50C_errors_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(models_deg_50C,</a>
<a class="sourceLine" id="cb1102-2" title="2">                                          errors_deg_50C_train,</a>
<a class="sourceLine" id="cb1102-3" title="3">                                          errors_deg_50C_val)</a></code></pre></div>
<div class="sourceCode" id="cb1103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1103-1" title="1">models_deg_50C_errors_df</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["models_deg_50C"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_deg_50C_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_deg_50C_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma","2":"0.1320828","3":"0.1333443"},{"1":"model_gamma_ridge","2":"0.1400484","3":"0.1423509"},{"1":"model_gamma_lasso","2":"0.1321074","3":"0.1332212"},{"1":"model_gamma_enet","2":"0.1321074","3":"0.1332212"},{"1":"model_inverse_gaussian","2":"0.1304168","3":"0.1316306"},{"1":"model_inverse_gaussian_ridge","2":"0.1773207","3":"0.1820173"},{"1":"model_inverse_gaussian_lasso","2":"0.1727285","3":"0.1771532"},{"1":"model_inverse_gaussian_enet","2":"0.1727285","3":"0.1771532"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Le meilleur modèle (au sens de la minimisation du MSE sur la validation) est le <code>model_inverse_gaussian</code>. Ainsi, la pénalisation n’a pas permis d’améliorer les performances ici.</p>
<div class="sourceCode" id="cb1104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1104-1" title="1">models_deg_50C_errors_df[<span class="kw">which.min</span>(errors_deg_50C_val), ]</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["models_deg_50C"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_deg_50C_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_deg_50C_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_inverse_gaussian","2":"0.1304168","3":"0.1316306","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Sauvegarde des résultats.</p>
<div class="sourceCode" id="cb1105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1105-1" title="1"><span class="co">#save.image(file = &quot;GLM_optimization.Rdata&quot;)</span></a></code></pre></div>
<p>Chargement des résultats.</p>
<div class="sourceCode" id="cb1106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1106-1" title="1"><span class="co">#load(file = &quot;GLM_optimization.Rdata&quot;)</span></a></code></pre></div>
</div>
</div>
</div>
</section>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
