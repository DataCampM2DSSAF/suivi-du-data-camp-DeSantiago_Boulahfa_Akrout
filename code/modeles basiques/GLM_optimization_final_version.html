<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="AKROUT Leyth, BOULAHFA Jawad, DE SANTIAGO Kylliann" />


<title>GLM optimization</title>

<style type="text/css">.pagedtable {
overflow: auto;
padding-left: 8px;
padding-right: 8px;
}
.pagedtable-wrapper {
border: 1px solid #ccc;
border-radius: 4px;
margin-bottom: 10px;
}
.pagedtable table {
width: 100%;
max-width: 100%;
margin: 0;
}
.pagedtable th {
padding: 0 5px 0 5px;
border: none;
border-bottom: 2px solid #dddddd;
min-width: 45px;
}
.pagedtable-empty th {
display: none;
}
.pagedtable td {
padding: 0 4px 0 4px;
}
.pagedtable .even {
background-color: rgba(140, 140, 140, 0.1);
}
.pagedtable-padding-col {
display: none;
}
.pagedtable a {
-webkit-touch-callout: none;
-webkit-user-select: none;
-khtml-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.pagedtable-index-nav {
cursor: pointer;
padding: 0 5px 0 5px;
float: right;
border: 0;
}
.pagedtable-index-nav-disabled {
cursor: default;
text-decoration: none;
color: #999;
}
a.pagedtable-index-nav-disabled:hover {
text-decoration: none;
color: #999;
}
.pagedtable-indexes {
cursor: pointer;
float: right;
border: 0;
}
.pagedtable-index-current {
cursor: default;
text-decoration: none;
font-weight: bold;
color: #333;
border: 0;
}
a.pagedtable-index-current:hover {
text-decoration: none;
font-weight: bold;
color: #333;
}
.pagedtable-index {
width: 30px;
display: inline-block;
text-align: center;
border: 0;
}
.pagedtable-index-separator-left {
display: inline-block;
color: #333;
font-size: 9px;
padding: 0 0 0 0;
cursor: default;
}
.pagedtable-index-separator-right {
display: inline-block;
color: #333;
font-size: 9px;
padding: 0 4px 0 0;
cursor: default;
}
.pagedtable-footer {
padding-top: 4px;
padding-bottom: 5px;
}
.pagedtable-not-empty .pagedtable-footer {
border-top: 2px solid #dddddd;
}
.pagedtable-info {
overflow: hidden;
color: #999;
white-space: nowrap;
text-overflow: ellipsis;
}
.pagedtable-header-name {
overflow: hidden;
text-overflow: ellipsis;
}
.pagedtable-header-type {
color: #999;
font-weight: 400;
}
.pagedtable-na-cell {
font-style: italic;
opacity: 0.3;
}
</style>
<script>// Production steps of ECMA-262, Edition 5, 15.4.4.18
// Reference: http://es5.github.io/#x15.4.4.18
if (!Array.prototype.forEach) {

  Array.prototype.forEach = function(callback, thisArg) {

    var T, k;

    if (this === null) {
      throw new TypeError(' this is null or not defined');
    }

    // 1. Let O be the result of calling toObject() passing the
    // |this| value as the argument.
    var O = Object(this);

    // 2. Let lenValue be the result of calling the Get() internal
    // method of O with the argument "length".
    // 3. Let len be toUint32(lenValue).
    var len = O.length >>> 0;

    // 4. If isCallable(callback) is false, throw a TypeError exception.
    // See: http://es5.github.com/#x9.11
    if (typeof callback !== "function") {
      throw new TypeError(callback + ' is not a function');
    }

    // 5. If thisArg was supplied, let T be thisArg; else let
    // T be undefined.
    if (arguments.length > 1) {
      T = thisArg;
    }

    // 6. Let k be 0
    k = 0;

    // 7. Repeat, while k < len
    while (k < len) {

      var kValue;

      // a. Let Pk be ToString(k).
      //    This is implicit for LHS operands of the in operator
      // b. Let kPresent be the result of calling the HasProperty
      //    internal method of O with argument Pk.
      //    This step can be combined with c
      // c. If kPresent is true, then
      if (k in O) {

        // i. Let kValue be the result of calling the Get internal
        // method of O with argument Pk.
        kValue = O[k];

        // ii. Call the Call internal method of callback with T as
        // the this value and argument list containing kValue, k, and O.
        callback.call(T, kValue, k, O);
      }
      // d. Increase k by 1.
      k++;
    }
    // 8. return undefined
  };
}

// Production steps of ECMA-262, Edition 5, 15.4.4.19
// Reference: http://es5.github.io/#x15.4.4.19
if (!Array.prototype.map) {

  Array.prototype.map = function(callback, thisArg) {

    var T, A, k;

    if (this == null) {
      throw new TypeError(' this is null or not defined');
    }

    // 1. Let O be the result of calling ToObject passing the |this|
    //    value as the argument.
    var O = Object(this);

    // 2. Let lenValue be the result of calling the Get internal
    //    method of O with the argument "length".
    // 3. Let len be ToUint32(lenValue).
    var len = O.length >>> 0;

    // 4. If IsCallable(callback) is false, throw a TypeError exception.
    // See: http://es5.github.com/#x9.11
    if (typeof callback !== 'function') {
      throw new TypeError(callback + ' is not a function');
    }

    // 5. If thisArg was supplied, let T be thisArg; else let T be undefined.
    if (arguments.length > 1) {
      T = thisArg;
    }

    // 6. Let A be a new array created as if by the expression new Array(len)
    //    where Array is the standard built-in constructor with that name and
    //    len is the value of len.
    A = new Array(len);

    // 7. Let k be 0
    k = 0;

    // 8. Repeat, while k < len
    while (k < len) {

      var kValue, mappedValue;

      // a. Let Pk be ToString(k).
      //   This is implicit for LHS operands of the in operator
      // b. Let kPresent be the result of calling the HasProperty internal
      //    method of O with argument Pk.
      //   This step can be combined with c
      // c. If kPresent is true, then
      if (k in O) {

        // i. Let kValue be the result of calling the Get internal
        //    method of O with argument Pk.
        kValue = O[k];

        // ii. Let mappedValue be the result of calling the Call internal
        //     method of callback with T as the this value and argument
        //     list containing kValue, k, and O.
        mappedValue = callback.call(T, kValue, k, O);

        // iii. Call the DefineOwnProperty internal method of A with arguments
        // Pk, Property Descriptor
        // { Value: mappedValue,
        //   Writable: true,
        //   Enumerable: true,
        //   Configurable: true },
        // and false.

        // In browsers that support Object.defineProperty, use the following:
        // Object.defineProperty(A, k, {
        //   value: mappedValue,
        //   writable: true,
        //   enumerable: true,
        //   configurable: true
        // });

        // For best browser support, use the following:
        A[k] = mappedValue;
      }
      // d. Increase k by 1.
      k++;
    }

    // 9. return A
    return A;
  };
}

var PagedTable = function (pagedTable) {
  var me = this;

  var source = function(pagedTable) {
    var sourceElems = [].slice.call(pagedTable.children).filter(function(e) {
      return e.hasAttribute("data-pagedtable-source");
    });

    if (sourceElems === null || sourceElems.length !== 1) {
      throw("A single data-pagedtable-source was not found");
    }

    return JSON.parse(sourceElems[0].innerHTML);
  }(pagedTable);

  var options = function(source) {
    var options = typeof(source.options) !== "undefined" &&
      source.options !== null ? source.options : {};

    var columns = typeof(options.columns) !== "undefined" ? options.columns : {};
    var rows = typeof(options.rows) !== "undefined" ? options.rows : {};

    var positiveIntOrNull = function(value) {
      return parseInt(value) >= 0 ? parseInt(value) : null;
    };

    return {
      pages: positiveIntOrNull(options.pages),
      rows: {
        min: positiveIntOrNull(rows.min),
        max: positiveIntOrNull(rows.max),
        total: positiveIntOrNull(rows.total)
      },
      columns: {
        min: positiveIntOrNull(columns.min),
        max: positiveIntOrNull(columns.max),
        total: positiveIntOrNull(columns.total)
      }
    };
  }(source);

  var Measurer = function() {

    // set some default initial values that will get adjusted in runtime
    me.measures = {
      padding: 12,
      character: 8,
      height: 15,
      defaults: true
    };

    me.calculate = function(measuresCell) {
      if (!me.measures.defaults)
        return;

      var measuresCellStyle = window.getComputedStyle(measuresCell, null);

      var newPadding = parsePadding(measuresCellStyle.paddingLeft) +
            parsePadding(measuresCellStyle.paddingRight);

      var sampleString = "ABCDEFGHIJ0123456789";
      var newCharacter = Math.ceil(measuresCell.clientWidth / sampleString.length);

      if (newPadding <= 0 || newCharacter <= 0)
        return;

      me.measures.padding = newPadding;
      me.measures.character = newCharacter;
      me.measures.height = measuresCell.clientHeight;
      me.measures.defaults = false;
    };

    return me;
  };

  var Page = function(data, options) {
    var me = this;

    var defaults = {
      max: 7,
      rows: 10
    };

    var totalPages = function() {
      return Math.ceil(data.length / me.rows);
    };

    me.number = 0;
    me.max = options.pages !== null ? options.pages : defaults.max;
    me.visible = me.max;
    me.rows = options.rows.min !== null ? options.rows.min : defaults.rows;
    me.total = totalPages();

    me.setRows = function(newRows) {
      me.rows = newRows;
      me.total = totalPages();
    };

    me.setPageNumber = function(newPageNumber) {
      if (newPageNumber < 0) newPageNumber = 0;
      if (newPageNumber >= me.total) newPageNumber = me.total - 1;

      me.number = newPageNumber;
    };

    me.setVisiblePages = function(visiblePages) {
      me.visible = Math.min(me.max, visiblePages);
      me.setPageNumber(me.number);
    };

    me.getVisiblePageRange = function() {
      var start = me.number - Math.max(Math.floor((me.visible - 1) / 2), 0);
      var end = me.number + Math.floor(me.visible / 2) + 1;
      var pageCount = me.total;

      if (start < 0) {
        var diffToStart = 0 - start;
        start += diffToStart;
        end += diffToStart;
      }

      if (end > pageCount) {
        var diffToEnd = end - pageCount;
        start -= diffToEnd;
        end -= diffToEnd;
      }

      start = start < 0 ? 0 : start;
      end = end >= pageCount ? pageCount : end;

      var first = false;
      var last = false;

      if (start > 0 && me.visible > 1) {
        start = start + 1;
        first = true;
      }

      if (end < pageCount && me.visible > 2) {
        end = end - 1;
        last = true;
      }

      return {
        first: first,
        start: start,
        end: end,
        last: last
      };
    };

    me.getRowStart = function() {
      var rowStart = page.number * page.rows;
      if (rowStart < 0)
        rowStart = 0;

      return rowStart;
    };

    me.getRowEnd = function() {
      var rowStart = me.getRowStart();
      return Math.min(rowStart + me.rows, data.length);
    };

    me.getPaddingRows = function() {
      var rowStart = me.getRowStart();
      var rowEnd = me.getRowEnd();
      return data.length > me.rows ? me.rows - (rowEnd - rowStart) : 0;
    };
  };

  var Columns = function(data, columns, options) {
    var me = this;

    me.defaults = {
      min: 5
    };

    me.number = 0;
    me.visible = 0;
    me.total = columns.length;
    me.subset = [];
    me.padding = 0;
    me.min = options.columns.min !== null ? options.columns.min : me.defaults.min;
    me.max = options.columns.max !== null ? options.columns.max : null;
    me.widths = {};

    var widthsLookAhead = Math.max(100, options.rows.min);
    var paddingColChars = 10;

    me.emptyNames = function() {
      columns.forEach(function(column) {
        if (columns.label !== null && columns.label !== "")
          return false;
      });

      return true;
    };

    var parsePadding = function(value) {
      return parseInt(value) >= 0 ? parseInt(value) : 0;
    };

    me.calculateWidths = function(measures) {
      columns.forEach(function(column) {
        var maxChars = Math.max(
          column.label.toString().length,
          column.type.toString().length
        );

        for (var idxRow = 0; idxRow < Math.min(widthsLookAhead, data.length); idxRow++) {
          maxChars = Math.max(maxChars, data[idxRow][column.name.toString()].length);
        }

        me.widths[column.name] = {
          // width in characters
          chars: maxChars,
          // width for the inner html columns
          inner: maxChars * measures.character,
          // width adding outer styles like padding
          outer: maxChars * measures.character + measures.padding
        };
      });
    };

    me.getWidth = function() {
      var widthOuter = 0;
      for (var idxCol = 0; idxCol < me.subset.length; idxCol++) {
        var columnName = me.subset[idxCol].name;
        widthOuter = widthOuter + me.widths[columnName].outer;
      }

      widthOuter = widthOuter + me.padding * paddingColChars * measurer.measures.character;

      if (me.hasMoreLeftColumns()) {
        widthOuter = widthOuter + columnNavigationWidthPX + measurer.measures.padding;
      }

      if (me.hasMoreRightColumns()) {
        widthOuter = widthOuter + columnNavigationWidthPX + measurer.measures.padding;
      }

      return widthOuter;
    };

    me.updateSlice = function() {
      if (me.number + me.visible >= me.total)
        me.number = me.total - me.visible;

      if (me.number < 0) me.number = 0;

      me.subset = columns.slice(me.number, Math.min(me.number + me.visible, me.total));

      me.subset = me.subset.map(function(column) {
        Object.keys(column).forEach(function(colKey) {
          column[colKey] = column[colKey] === null ? "" : column[colKey].toString();
        });

        column.width = null;
        return column;
      });
    };

    me.setVisibleColumns = function(columnNumber, newVisibleColumns, paddingCount) {
      me.number = columnNumber;
      me.visible = newVisibleColumns;
      me.padding = paddingCount;

      me.updateSlice();
    };

    me.incColumnNumber = function(increment) {
      me.number = me.number + increment;
    };

    me.setColumnNumber = function(newNumber) {
      me.number = newNumber;
    };

    me.setPaddingCount = function(newPadding) {
      me.padding = newPadding;
    };

    me.getPaddingCount = function() {
      return me.padding;
    };

    me.hasMoreLeftColumns = function() {
      return me.number > 0;
    };

    me.hasMoreRightColumns = function() {
      return me.number + me.visible < me.total;
    };

    me.updateSlice(0);
    return me;
  };

  var data = source.data;
  var page = new Page(data, options);
  var measurer = new Measurer(data, options);
  var columns = new Columns(data, source.columns, options);

  var table = null;
  var tableDiv = null;
  var header = null;
  var footer = null;
  var tbody = null;

  // Caches pagedTable.clientWidth, specially for webkit
  var cachedPagedTableClientWidth = null;

  var onChangeCallbacks = [];

  var clearSelection = function() {
    if(document.selection && document.selection.empty) {
      document.selection.empty();
    } else if(window.getSelection) {
      var sel = window.getSelection();
      sel.removeAllRanges();
    }
  };

  var columnNavigationWidthPX = 5;

  var renderColumnNavigation = function(increment, backwards) {
    var arrow = document.createElement("div");
    arrow.setAttribute("style",
      "border-top: " + columnNavigationWidthPX + "px solid transparent;" +
      "border-bottom: " + columnNavigationWidthPX + "px solid transparent;" +
      "border-" + (backwards ? "right" : "left") + ": " + columnNavigationWidthPX + "px solid;");

    var header = document.createElement("th");
    header.appendChild(arrow);
    header.setAttribute("style",
      "cursor: pointer;" +
      "vertical-align: middle;" +
      "min-width: " + columnNavigationWidthPX + "px;" +
      "width: " + columnNavigationWidthPX + "px;");

    header.onclick = function() {
      columns.incColumnNumber(backwards ? -1 : increment);

      me.animateColumns(backwards);
      renderFooter();

      clearSelection();
      triggerOnChange();
    };

    return header;
  };

  var maxColumnWidth = function(width) {
    var padding = 80;
    var columnMax = Math.max(cachedPagedTableClientWidth - padding, 0);

    return parseInt(width) > 0 ?
      Math.min(columnMax, parseInt(width)) + "px" :
      columnMax + "px";
  };

  var clearHeader = function() {
    var thead = pagedTable.querySelectorAll("thead")[0];
    thead.innerHTML = "";
  };

  var renderHeader = function(clear) {
    cachedPagedTableClientWidth = pagedTable.clientWidth;

    var fragment = document.createDocumentFragment();

    header = document.createElement("tr");
    fragment.appendChild(header);

    if (columns.number > 0)
      header.appendChild(renderColumnNavigation(-columns.visible, true));

    columns.subset = columns.subset.map(function(columnData) {
      var column = document.createElement("th");
      column.setAttribute("align", columnData.align);
      column.style.textAlign = columnData.align;

      column.style.maxWidth = maxColumnWidth(null);
      if (columnData.width) {
        column.style.minWidth =
          column.style.maxWidth = maxColumnWidth(columnData.width);
      }

      var columnName = document.createElement("div");
      columnName.setAttribute("class", "pagedtable-header-name");
      if (columnData.label === "") {
        columnName.innerHTML = "&nbsp;";
      }
      else {
        columnName.appendChild(document.createTextNode(columnData.label));
      }
      column.appendChild(columnName);

      var columnType = document.createElement("div");
      columnType.setAttribute("class", "pagedtable-header-type");
      if (columnData.type === "") {
        columnType.innerHTML = "&nbsp;";
      }
      else {
        columnType.appendChild(document.createTextNode("<" + columnData.type + ">"));
      }
      column.appendChild(columnType);

      header.appendChild(column);

      columnData.element = column;

      return columnData;
    });

    for (var idx = 0; idx < columns.getPaddingCount(); idx++) {
      var paddingCol = document.createElement("th");
      paddingCol.setAttribute("class", "pagedtable-padding-col");
      header.appendChild(paddingCol);
    }

    if (columns.number + columns.visible < columns.total)
      header.appendChild(renderColumnNavigation(columns.visible, false));

    if (typeof(clear) == "undefined" || clear) clearHeader();
    var thead = pagedTable.querySelectorAll("thead")[0];
    thead.appendChild(fragment);
  };

  me.animateColumns = function(backwards) {
    var thead = pagedTable.querySelectorAll("thead")[0];

    var headerOld = thead.querySelectorAll("tr")[0];
    var tbodyOld = table.querySelectorAll("tbody")[0];

    me.fitColumns(backwards);

    renderHeader(false);

    header.style.opacity = "0";
    header.style.transform = backwards ? "translateX(-30px)" : "translateX(30px)";
    header.style.transition = "transform 200ms linear, opacity 200ms";
    header.style.transitionDelay = "0";

    renderBody(false);

    if (headerOld) {
      headerOld.style.position = "absolute";
      headerOld.style.transform = "translateX(0px)";
      headerOld.style.opacity = "1";
      headerOld.style.transition = "transform 100ms linear, opacity 100ms";
      headerOld.setAttribute("class", "pagedtable-remove-head");
      if (headerOld.style.transitionEnd) {
        headerOld.addEventListener("transitionend", function() {
          var headerOldByClass = thead.querySelector(".pagedtable-remove-head");
          if (headerOldByClass) thead.removeChild(headerOldByClass);
        });
      }
      else {
        thead.removeChild(headerOld);
      }
    }

    if (tbodyOld) table.removeChild(tbodyOld);

    tbody.style.opacity = "0";
    tbody.style.transition = "transform 200ms linear, opacity 200ms";
    tbody.style.transitionDelay = "0ms";

    // force relayout
    window.getComputedStyle(header).opacity;
    window.getComputedStyle(tbody).opacity;

    if (headerOld) {
      headerOld.style.transform = backwards ? "translateX(20px)" : "translateX(-30px)";
      headerOld.style.opacity = "0";
    }

    header.style.transform = "translateX(0px)";
    header.style.opacity = "1";

    tbody.style.opacity = "1";
  }

  me.onChange = function(callback) {
    onChangeCallbacks.push(callback);
  };

  var triggerOnChange = function() {
    onChangeCallbacks.forEach(function(onChange) {
      onChange();
    });
  };

  var clearBody = function() {
    if (tbody) {
      table.removeChild(tbody);
      tbody = null;
    }
  };

  var renderBody = function(clear) {
    cachedPagedTableClientWidth = pagedTable.clientWidth

    var fragment = document.createDocumentFragment();

    var pageData = data.slice(page.getRowStart(), page.getRowEnd());

    pageData.forEach(function(dataRow, idxRow) {
      var htmlRow = document.createElement("tr");
      htmlRow.setAttribute("class", (idxRow % 2 !==0) ? "even" : "odd");

      if (columns.hasMoreLeftColumns())
        htmlRow.appendChild(document.createElement("td"));

      columns.subset.forEach(function(columnData) {
        var cellName = columnData.name;
        var dataCell = dataRow[cellName];
        var htmlCell = document.createElement("td");

        if (dataCell === "NA") htmlCell.setAttribute("class", "pagedtable-na-cell");
        if (dataCell === "__NA__") dataCell = "NA";

        var cellText = document.createTextNode(dataCell);
        htmlCell.appendChild(cellText);
        if (dataCell.length > 50) {
          htmlCell.setAttribute("title", dataCell);
        }
        htmlCell.setAttribute("align", columnData.align);
        htmlCell.style.textAlign = columnData.align;
        htmlCell.style.maxWidth = maxColumnWidth(null);
        if (columnData.width) {
          htmlCell.style.minWidth = htmlCell.style.maxWidth = maxColumnWidth(columnData.width);
        }
        htmlRow.appendChild(htmlCell);
      });

      for (var idx = 0; idx < columns.getPaddingCount(); idx++) {
        var paddingCol = document.createElement("td");
        paddingCol.setAttribute("class", "pagedtable-padding-col");
        htmlRow.appendChild(paddingCol);
      }

      if (columns.hasMoreRightColumns())
        htmlRow.appendChild(document.createElement("td"));

      fragment.appendChild(htmlRow);
    });

    for (var idxPadding = 0; idxPadding < page.getPaddingRows(); idxPadding++) {
      var paddingRow = document.createElement("tr");

      var paddingCellRow = document.createElement("td");
      paddingCellRow.innerHTML = "&nbsp;";
      paddingCellRow.setAttribute("colspan", "100%");
      paddingRow.appendChild(paddingCellRow);

      fragment.appendChild(paddingRow);
    }

    if (typeof(clear) == "undefined" || clear) clearBody();
    tbody = document.createElement("tbody");
    tbody.appendChild(fragment);

    table.appendChild(tbody);
  };

  var getLabelInfo = function() {
    var pageStart = page.getRowStart();
    var pageEnd = page.getRowEnd();
    var totalRows = data.length;

    var totalRowsLabel = options.rows.total ? options.rows.total : totalRows;
    var totalRowsLabelFormat = totalRowsLabel.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, '$1,');

    var infoText = (pageStart + 1) + "-" + pageEnd + " of " + totalRowsLabelFormat + " rows";
    if (totalRows < page.rows) {
      infoText = totalRowsLabel + " row" + (totalRows != 1 ? "s" : "");
    }
    if (columns.total > columns.visible) {
      var totalColumnsLabel = options.columns.total ? options.columns.total : columns.total;

      infoText = infoText + " | " + (columns.number + 1) + "-" +
        (Math.min(columns.number + columns.visible, columns.total)) +
        " of " + totalColumnsLabel + " columns";
    }

    return infoText;
  };

  var clearFooter = function() {
    footer = pagedTable.querySelectorAll("div.pagedtable-footer")[0];
    footer.innerHTML = "";

    return footer;
  };

  var createPageLink = function(idxPage) {
    var pageLink = document.createElement("a");
    pageLinkClass = idxPage === page.number ? "pagedtable-index pagedtable-index-current" : "pagedtable-index";
    pageLink.setAttribute("class", pageLinkClass);
    pageLink.setAttribute("data-page-index", idxPage);
    pageLink.onclick = function() {
      page.setPageNumber(parseInt(this.getAttribute("data-page-index")));
      renderBody();
      renderFooter();

      triggerOnChange();
    };

    pageLink.appendChild(document.createTextNode(idxPage + 1));

    return pageLink;
  }

  var renderFooter = function() {
    footer = clearFooter();

    var next = document.createElement("a");
    next.appendChild(document.createTextNode("Next"));
    next.onclick = function() {
      page.setPageNumber(page.number + 1);
      renderBody();
      renderFooter();

      triggerOnChange();
    };
    if (data.length > page.rows) footer.appendChild(next);

    var pageNumbers = document.createElement("div");
    pageNumbers.setAttribute("class", "pagedtable-indexes");

    var pageRange = page.getVisiblePageRange();

    if (pageRange.first) {
      var pageLink = createPageLink(0);
      pageNumbers.appendChild(pageLink);

      var pageSeparator = document.createElement("div");
      pageSeparator.setAttribute("class", "pagedtable-index-separator-left");
      pageSeparator.appendChild(document.createTextNode("..."))
      pageNumbers.appendChild(pageSeparator);
    }

    for (var idxPage = pageRange.start; idxPage < pageRange.end; idxPage++) {
      var pageLink = createPageLink(idxPage);

      pageNumbers.appendChild(pageLink);
    }

    if (pageRange.last) {
      var pageSeparator = document.createElement("div");
      pageSeparator.setAttribute("class", "pagedtable-index-separator-right");
      pageSeparator.appendChild(document.createTextNode("..."))
      pageNumbers.appendChild(pageSeparator);

      var pageLink = createPageLink(page.total - 1);
      pageNumbers.appendChild(pageLink);
    }

    if (data.length > page.rows) footer.appendChild(pageNumbers);

    var previous = document.createElement("a");
    previous.appendChild(document.createTextNode("Previous"));
    previous.onclick = function() {
      page.setPageNumber(page.number - 1);
      renderBody();
      renderFooter();

      triggerOnChange();
    };
    if (data.length > page.rows) footer.appendChild(previous);

    var infoLabel = document.createElement("div");
    infoLabel.setAttribute("class", "pagedtable-info");
    infoLabel.setAttribute("title", getLabelInfo());
    infoLabel.appendChild(document.createTextNode(getLabelInfo()));
    footer.appendChild(infoLabel);

    var enabledClass = "pagedtable-index-nav";
    var disabledClass = "pagedtable-index-nav pagedtable-index-nav-disabled";
    previous.setAttribute("class", page.number <= 0 ? disabledClass : enabledClass);
    next.setAttribute("class", (page.number + 1) * page.rows >= data.length ? disabledClass : enabledClass);
  };

  var measuresCell = null;

  var renderMeasures = function() {
    var measuresTable = document.createElement("table");
    measuresTable.style.visibility = "hidden";
    measuresTable.style.position = "absolute";
    measuresTable.style.whiteSpace = "nowrap";
    measuresTable.style.height = "auto";
    measuresTable.style.width = "auto";

    var measuresRow = document.createElement("tr");
    measuresTable.appendChild(measuresRow);

    measuresCell = document.createElement("td");
    var sampleString = "ABCDEFGHIJ0123456789";
    measuresCell.appendChild(document.createTextNode(sampleString));

    measuresRow.appendChild(measuresCell);

    tableDiv.appendChild(measuresTable);
  }

  me.init = function() {
    tableDiv = document.createElement("div");
    pagedTable.appendChild(tableDiv);
    var pagedTableClass = data.length > 0 ?
      "pagedtable pagedtable-not-empty" :
      "pagedtable pagedtable-empty";

    if (columns.total == 0 || (columns.emptyNames() && data.length == 0)) {
      pagedTableClass = pagedTableClass + " pagedtable-empty-columns";
    }

    tableDiv.setAttribute("class", pagedTableClass);

    renderMeasures();
    measurer.calculate(measuresCell);
    columns.calculateWidths(measurer.measures);

    table = document.createElement("table");
    table.setAttribute("cellspacing", "0");
    table.setAttribute("class", "table table-condensed");
    tableDiv.appendChild(table);

    table.appendChild(document.createElement("thead"));

    var footerDiv = document.createElement("div");
    footerDiv.setAttribute("class", "pagedtable-footer");
    tableDiv.appendChild(footerDiv);

    // if the host has not yet provided horizontal space, render hidden
    if (tableDiv.clientWidth <= 0) {
      tableDiv.style.opacity = "0";
    }

    me.render();

    // retry seizing columns later if the host has not provided space
    function retryFit() {
      if (tableDiv.clientWidth <= 0) {
        setTimeout(retryFit, 100);
      } else {
        me.render();
        triggerOnChange();
      }
    }
    if (tableDiv.clientWidth <= 0) {
      retryFit();
    }
  };

  var registerWidths = function() {
    columns.subset = columns.subset.map(function(column) {
      column.width = columns.widths[column.name].inner;
      return column;
    });
  };

  var parsePadding = function(value) {
    return parseInt(value) >= 0 ? parseInt(value) : 0;
  };

  me.fixedHeight = function() {
    return options.rows.max != null;
  }

  me.fitRows = function() {
    if (me.fixedHeight())
      return;

    measurer.calculate(measuresCell);

    var rows = options.rows.min !== null ? options.rows.min : 0;
    var headerHeight = header !== null && header.offsetHeight > 0 ? header.offsetHeight : 0;
    var footerHeight = footer !== null && footer.offsetHeight > 0 ? footer.offsetHeight : 0;

    if (pagedTable.offsetHeight > 0) {
      var availableHeight = pagedTable.offsetHeight - headerHeight - footerHeight;
      rows = Math.floor((availableHeight) / measurer.measures.height);
    }

    rows = options.rows.min !== null ? Math.max(options.rows.min, rows) : rows;

    page.setRows(rows);
  }

  // The goal of this function is to add as many columns as possible
  // starting from left-to-right, when the right most limit is reached
  // it tries to add columns from the left as well.
  //
  // When startBackwards is true columns are added from right-to-left
  me.fitColumns = function(startBackwards) {
    measurer.calculate(measuresCell);
    columns.calculateWidths(measurer.measures);

    if (tableDiv.clientWidth > 0) {
      tableDiv.style.opacity = 1;
    }

    var visibleColumns = tableDiv.clientWidth <= 0 ? Math.max(columns.min, 1) : 1;
    var columnNumber = columns.number;
    var paddingCount = 0;

    // track a list of added columns as we build the visible ones to allow us
    // to remove columns when they don't fit anymore.
    var columnHistory = [];

    var lastTableHeight = 0;
    var backwards = startBackwards;

    var tableDivStyle = window.getComputedStyle(tableDiv, null);
    var tableDivPadding = parsePadding(tableDivStyle.paddingLeft) +
      parsePadding(tableDivStyle.paddingRight);

    var addPaddingCol = false;
    var currentWidth = 0;

    while (true) {
      columns.setVisibleColumns(columnNumber, visibleColumns, paddingCount);
      currentWidth = columns.getWidth();

      if (tableDiv.clientWidth - tableDivPadding < currentWidth) {
        break;
      }

      columnHistory.push({
        columnNumber: columnNumber,
        visibleColumns: visibleColumns,
        paddingCount: paddingCount
      });

      if (columnHistory.length > 100) {
        console.error("More than 100 tries to fit columns, aborting");
        break;
      }

      if (columns.max !== null &&
        columns.visible + columns.getPaddingCount() >= columns.max) {
        break;
      }

      // if we run out of right-columns
      if (!backwards && columnNumber + columns.visible >= columns.total) {
        // if we started adding right-columns, try adding left-columns
        if (!startBackwards && columnNumber > 0) {
          backwards = true;
        }
        else if (columns.min === null || visibleColumns + columns.getPaddingCount() >= columns.min) {
          break;
        }
        else {
          paddingCount = paddingCount + 1;
        }
      }

      // if we run out of left-columns
      if (backwards && columnNumber == 0) {
        // if we started adding left-columns, try adding right-columns
        if (startBackwards && columnNumber + columns.visible < columns.total) {
          backwards = false;
        }
        else if (columns.min === null || visibleColumns + columns.getPaddingCount() >= columns.min) {
          break;
        }
        else {
          paddingCount = paddingCount + 1;
        }
      }

      // when moving backwards try fitting left columns first
      if (backwards && columnNumber > 0) {
        columnNumber = columnNumber - 1;
      }

      if (columnNumber + visibleColumns < columns.total) {
        visibleColumns = visibleColumns + 1;
      }
    }

    var lastRenderableColumn = {
        columnNumber: columnNumber,
        visibleColumns: visibleColumns,
        paddingCount: paddingCount
    };

    if (columnHistory.length > 0) {
      lastRenderableColumn = columnHistory[columnHistory.length - 1];
    }

    columns.setVisibleColumns(
      lastRenderableColumn.columnNumber,
      lastRenderableColumn.visibleColumns,
      lastRenderableColumn.paddingCount);

    if (pagedTable.offsetWidth > 0) {
      page.setVisiblePages(Math.max(Math.ceil(1.0 * (pagedTable.offsetWidth - 250) / 40), 2));
    }

    registerWidths();
  };

  me.fit = function(startBackwards) {
    me.fitRows();
    me.fitColumns(startBackwards);
  }

  me.render = function() {
    me.fitColumns(false);

    // render header/footer to measure height accurately
    renderHeader();
    renderFooter();

    me.fitRows();
    renderBody();

    // re-render footer to match new rows
    renderFooter();
  }

  var resizeLastWidth = -1;
  var resizeLastHeight = -1;
  var resizeNewWidth = -1;
  var resizeNewHeight = -1;
  var resizePending = false;

  me.resize = function(newWidth, newHeight) {

    function resizeDelayed() {
      resizePending = false;

      if (
        (resizeNewWidth !== resizeLastWidth) ||
        (!me.fixedHeight() && resizeNewHeight !== resizeLastHeight)
      ) {
        resizeLastWidth = resizeNewWidth;
        resizeLastHeight = resizeNewHeight;

        setTimeout(resizeDelayed, 200);
        resizePending = true;
      } else {
        me.render();
        triggerOnChange();

        resizeLastWidth = -1;
        resizeLastHeight = -1;
      }
    }

    resizeNewWidth = newWidth;
    resizeNewHeight = newHeight;

    if (!resizePending) resizeDelayed();
  };
};

var PagedTableDoc;
(function (PagedTableDoc) {
  var allPagedTables = [];

  PagedTableDoc.initAll = function() {
    allPagedTables = [];

    var pagedTables = [].slice.call(document.querySelectorAll('[data-pagedtable="false"],[data-pagedtable=""]'));
    pagedTables.forEach(function(pagedTable, idx) {
      pagedTable.setAttribute("data-pagedtable", "true");
      pagedTable.setAttribute("pagedtable-page", 0);
      pagedTable.setAttribute("class", "pagedtable-wrapper");

      var pagedTableInstance = new PagedTable(pagedTable);
      pagedTableInstance.init();

      allPagedTables.push(pagedTableInstance);
    });
  };

  PagedTableDoc.resizeAll = function() {
    allPagedTables.forEach(function(pagedTable) {
      pagedTable.render();
    });
  };

  window.addEventListener("resize", PagedTableDoc.resizeAll);

  return PagedTableDoc;
})(PagedTableDoc || (PagedTableDoc = {}));

window.onload = function() {
  PagedTableDoc.initAll();
};
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

/* A workaround for https://github.com/jgm/pandoc/issues/4278 */
a.sourceLine {
  pointer-events: auto;
}

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">@font-face{font-family:"Open Sans";font-style:normal;font-weight:400;src:local("Open Sans"),local("OpenSans"),url(data:application/font-woff;base64,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) format("woff")}@font-face{font-family:"Open Sans";font-style:normal;font-weight:700;src:local("Open Sans Bold"),local("OpenSans-Bold"),url(data:application/font-woff;base64,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) format("woff")}*{box-sizing:border-box}body{padding:0;margin:0;font-family:"Open Sans","Helvetica Neue",Helvetica,Arial,sans-serif;font-size:16px;line-height:1.5;color:#606c71}a{color:#1e6bb8;text-decoration:none}a:hover{text-decoration:underline}.page-header{color:#fff;text-align:center;background-color:#159957;background-image:linear-gradient(120deg,#155799,#159957);padding:1.5rem 2rem}.page-header :last-child{margin-bottom:.5rem}@media screen and (max-width:42em){.page-header{padding:1rem 1rem}}.project-name{margin-top:0;margin-bottom:.1rem;font-size:2rem}@media screen and (max-width:42em){.project-name{font-size:1.75rem}}.project-tagline{margin-bottom:2rem;font-weight:400;opacity:.7;font-size:1.5rem}@media screen and (max-width:42em){.project-tagline{font-size:1.2rem}}.project-author,.project-date{font-weight:400;opacity:.7;font-size:1.2rem}@media screen and (max-width:42em){.project-author,.project-date{font-size:1rem}}.main-content,.toc{max-width:64rem;padding:2rem 4rem;margin:0 auto;font-size:1.1rem}.toc{padding-bottom:0}.toc .toc-box{padding:1.5rem;background-color:#f3f6fa;border:solid 1px #dce6f0;border-radius:.3rem}.toc .toc-box .toc-title{margin:0 0 .5rem;text-align:center}.toc .toc-box>ul{margin:0;padding-left:1.5rem}@media screen and (min-width:42em) and (max-width:64em){.toc{padding:2rem 2rem 0}}@media screen and (max-width:42em){.toc{padding:2rem 1rem 0;font-size:1rem}}.main-content :first-child{margin-top:0}@media screen and (min-width:42em) and (max-width:64em){.main-content{padding:2rem}}@media screen and (max-width:42em){.main-content{padding:2rem 1rem;font-size:1rem}}.main-content img{max-width:100%}.main-content h1,.main-content h2,.main-content h3,.main-content h4,.main-content h5,.main-content h6{margin-top:2rem;margin-bottom:1rem;font-weight:400;color:#159957}.main-content p{margin-bottom:1em}.main-content code{padding:2px 4px;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;color:#567482;background-color:#f3f6fa;border-radius:.3rem}.main-content pre{padding:.8rem;margin-top:0;margin-bottom:1rem;font:1rem Consolas,"Liberation Mono",Menlo,Courier,monospace;color:#567482;word-wrap:normal;background-color:#f3f6fa;border:solid 1px #dce6f0;border-radius:.3rem;line-height:1.45;overflow:auto}@media screen and (max-width:42em){.main-content pre{font-size:.9rem}}.main-content pre>code{padding:0;margin:0;color:#567482;word-break:normal;white-space:pre;background:0 0;border:0}@media screen and (max-width:42em){.main-content pre>code{font-size:.9rem}}.main-content pre code,.main-content pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.main-content pre code:after,.main-content pre code:before,.main-content pre tt:after,.main-content pre tt:before{content:normal}.main-content ol,.main-content ul{margin-top:0}.main-content blockquote{padding:0 1rem;margin-left:0;color:#819198;border-left:.3rem solid #dce6f0;font-size:1.2rem}.main-content blockquote>:first-child{margin-top:0}.main-content blockquote>:last-child{margin-bottom:0}@media screen and (max-width:42em){.main-content blockquote{font-size:1.1rem}}.main-content table{width:100%;overflow:auto;word-break:normal;word-break:keep-all;-webkit-overflow-scrolling:touch;border-collapse:collapse;border-spacing:0;margin:1rem 0}.main-content table th{font-weight:700;background-color:#159957;color:#fff}.main-content table td,.main-content table th{padding:.5rem 1rem;border-bottom:1px solid #e9ebec;text-align:left}.main-content table tr:nth-child(odd){background-color:#f2f2f2}.main-content dl{padding:0}.main-content dl dt{padding:0;margin-top:1rem;font-size:1rem;font-weight:700}.main-content dl dd{padding:0;margin-bottom:1rem}.main-content hr{height:2px;padding:0;margin:1rem 0;background-color:#eff0f1;border:0}code span.kw { color: #a71d5d; font-weight: normal; } 
code span.dt { color: #795da3; } 
code span.dv { color: #0086b3; } 
code span.bn { color: #0086b3; } 
code span.fl { color: #0086b3; } 
code span.ch { color: #4070a0; } 
code span.st { color: #183691; } 
code span.co { color: #969896; font-style: italic; } 
code span.ot { color: #007020; } 
</style>





</head>

<body>




<section class="page-header">
<h1 class="title toc-ignore project-name">GLM optimization</h1>
<h4 class="author project-author">AKROUT Leyth, BOULAHFA Jawad, DE SANTIAGO Kylliann</h4>
<h4 class="date project-date">22 février 2021</h4>
</section>


<div id="TOC" class="toc">
<div class="toc-box">
<ul>
<li><a href="#chargement-et-réorganisation-des-données">Chargement et réorganisation des données</a></li>
<li><a href="#création-de-la-base-trainvalidation">Création de la base train/validation</a></li>
<li><a href="#glm-loi-gamma">GLM : loi Gamma</a><ul>
<li><a href="#reactivity">Reactivity</a><ul>
<li><a href="#premier-modèle">Premier modèle</a></li>
<li><a href="#pénalisation-ridge-et-lasso">Pénalisation ridge et lasso</a></li>
<li><a href="#pénalisation-elastic-net">Pénalisation elastic-net</a></li>
<li><a href="#récapitulatif-des-résultats">Récapitulatif des résultats</a></li>
</ul></li>
<li><a href="#deg_mg_ph10">deg_Mg_pH10</a><ul>
<li><a href="#premier-modèle-1">Premier modèle</a></li>
<li><a href="#pénalisation-ridge-et-lasso-1">Pénalisation ridge et lasso</a></li>
<li><a href="#pénalisation-elastic-net-1">Pénalisation elastic-net</a></li>
<li><a href="#récapitulatif-des-résultats-1">Récapitulatif des résultats</a></li>
</ul></li>
<li><a href="#deg_ph10">deg_pH10</a><ul>
<li><a href="#premier-modèle-2">Premier modèle</a></li>
<li><a href="#pénalisation-ridge-et-lasso-2">Pénalisation ridge et lasso</a></li>
<li><a href="#pénalisation-elastic-net-2">Pénalisation elastic-net</a></li>
<li><a href="#récapitulatif-des-résultats-2">Récapitulatif des résultats</a></li>
</ul></li>
<li><a href="#deg_mg_50c">deg_Mg_50C</a><ul>
<li><a href="#premier-modèle-3">Premier modèle</a></li>
<li><a href="#pénalisation-ridge-et-lasso-3">Pénalisation ridge et lasso</a></li>
<li><a href="#pénalisation-elastic-net-3">Pénalisation elastic-net</a></li>
<li><a href="#récapitulatif-des-résultats-3">Récapitulatif des résultats</a></li>
</ul></li>
<li><a href="#deg_50c">deg_50C</a><ul>
<li><a href="#premier-modèle-4">Premier modèle</a></li>
<li><a href="#pénalisation-ridge-et-lasso-4">Pénalisation ridge et lasso</a></li>
<li><a href="#pénalisation-elastic-net-4">Pénalisation elastic-net</a></li>
<li><a href="#récapitulatif-des-résultats-4">Récapitulatif des résultats</a></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>

<section class="main-content">
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a></code></pre></div>
<div id="chargement-et-réorganisation-des-données" class="section level1">
<h1>Chargement et réorganisation des données</h1>
<p>Chargement du jeu de données.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># data = read.csv(&quot;~/suivi-du-data-camp-DeSantiago_Boulahfa_Akrout/code/data_train.csv&quot;)</span></a>
<a class="sourceLine" id="cb2-2" title="2">data =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data_train.csv&quot;</span>)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw">head</span>(data) <span class="co"># une colonne en trop</span></a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["X"],"name":[1],"type":["int"],"align":["right"]},{"label":["id"],"name":[2],"type":["fct"],"align":["left"]},{"label":["sequence"],"name":[3],"type":["fct"],"align":["left"]},{"label":["index_sequence"],"name":[4],"type":["int"],"align":["right"]},{"label":["seq_be"],"name":[5],"type":["fct"],"align":["left"]},{"label":["seq_af"],"name":[6],"type":["fct"],"align":["left"]},{"label":["structure"],"name":[7],"type":["fct"],"align":["left"]},{"label":["struct_be"],"name":[8],"type":["fct"],"align":["left"]},{"label":["struct_af"],"name":[9],"type":["fct"],"align":["left"]},{"label":["predicted_loop_type"],"name":[10],"type":["fct"],"align":["left"]},{"label":["loop_type_be"],"name":[11],"type":["fct"],"align":["left"]},{"label":["loop_type_af"],"name":[12],"type":["fct"],"align":["left"]},{"label":["bpps_0"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["bpps_1"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["bpps_2"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["bpps_3"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["bpps_4"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["bpps_5"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["bpps_6"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["bpps_7"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["bpps_8"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["bpps_9"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["bpps_10"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["bpps_11"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["bpps_12"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["bpps_13"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["bpps_14"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["bpps_15"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["bpps_16"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["bpps_17"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["bpps_18"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["bpps_19"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["bpps_20"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["bpps_21"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["bpps_22"],"name":[35],"type":["dbl"],"align":["right"]},{"label":["bpps_23"],"name":[36],"type":["dbl"],"align":["right"]},{"label":["bpps_24"],"name":[37],"type":["dbl"],"align":["right"]},{"label":["bpps_25"],"name":[38],"type":["dbl"],"align":["right"]},{"label":["bpps_26"],"name":[39],"type":["dbl"],"align":["right"]},{"label":["bpps_27"],"name":[40],"type":["dbl"],"align":["right"]},{"label":["bpps_28"],"name":[41],"type":["dbl"],"align":["right"]},{"label":["bpps_29"],"name":[42],"type":["dbl"],"align":["right"]},{"label":["bpps_30"],"name":[43],"type":["dbl"],"align":["right"]},{"label":["bpps_31"],"name":[44],"type":["dbl"],"align":["right"]},{"label":["bpps_32"],"name":[45],"type":["dbl"],"align":["right"]},{"label":["bpps_33"],"name":[46],"type":["dbl"],"align":["right"]},{"label":["bpps_34"],"name":[47],"type":["dbl"],"align":["right"]},{"label":["bpps_35"],"name":[48],"type":["dbl"],"align":["right"]},{"label":["bpps_36"],"name":[49],"type":["dbl"],"align":["right"]},{"label":["bpps_37"],"name":[50],"type":["dbl"],"align":["right"]},{"label":["bpps_38"],"name":[51],"type":["dbl"],"align":["right"]},{"label":["bpps_39"],"name":[52],"type":["dbl"],"align":["right"]},{"label":["bpps_40"],"name":[53],"type":["dbl"],"align":["right"]},{"label":["bpps_41"],"name":[54],"type":["dbl"],"align":["right"]},{"label":["bpps_42"],"name":[55],"type":["dbl"],"align":["right"]},{"label":["bpps_43"],"name":[56],"type":["dbl"],"align":["right"]},{"label":["bpps_44"],"name":[57],"type":["dbl"],"align":["right"]},{"label":["bpps_45"],"name":[58],"type":["dbl"],"align":["right"]},{"label":["bpps_46"],"name":[59],"type":["dbl"],"align":["right"]},{"label":["bpps_47"],"name":[60],"type":["dbl"],"align":["right"]},{"label":["bpps_48"],"name":[61],"type":["dbl"],"align":["right"]},{"label":["bpps_49"],"name":[62],"type":["dbl"],"align":["right"]},{"label":["bpps_50"],"name":[63],"type":["dbl"],"align":["right"]},{"label":["bpps_51"],"name":[64],"type":["dbl"],"align":["right"]},{"label":["bpps_52"],"name":[65],"type":["dbl"],"align":["right"]},{"label":["bpps_53"],"name":[66],"type":["dbl"],"align":["right"]},{"label":["bpps_54"],"name":[67],"type":["dbl"],"align":["right"]},{"label":["bpps_55"],"name":[68],"type":["dbl"],"align":["right"]},{"label":["bpps_56"],"name":[69],"type":["dbl"],"align":["right"]},{"label":["bpps_57"],"name":[70],"type":["dbl"],"align":["right"]},{"label":["bpps_58"],"name":[71],"type":["dbl"],"align":["right"]},{"label":["bpps_59"],"name":[72],"type":["dbl"],"align":["right"]},{"label":["bpps_60"],"name":[73],"type":["dbl"],"align":["right"]},{"label":["bpps_61"],"name":[74],"type":["dbl"],"align":["right"]},{"label":["bpps_62"],"name":[75],"type":["dbl"],"align":["right"]},{"label":["bpps_63"],"name":[76],"type":["dbl"],"align":["right"]},{"label":["bpps_64"],"name":[77],"type":["dbl"],"align":["right"]},{"label":["bpps_65"],"name":[78],"type":["dbl"],"align":["right"]},{"label":["bpps_66"],"name":[79],"type":["dbl"],"align":["right"]},{"label":["bpps_67"],"name":[80],"type":["dbl"],"align":["right"]},{"label":["bpps_68"],"name":[81],"type":["dbl"],"align":["right"]},{"label":["bpps_69"],"name":[82],"type":["dbl"],"align":["right"]},{"label":["bpps_70"],"name":[83],"type":["dbl"],"align":["right"]},{"label":["bpps_71"],"name":[84],"type":["dbl"],"align":["right"]},{"label":["bpps_72"],"name":[85],"type":["dbl"],"align":["right"]},{"label":["bpps_73"],"name":[86],"type":["dbl"],"align":["right"]},{"label":["bpps_74"],"name":[87],"type":["dbl"],"align":["right"]},{"label":["bpps_75"],"name":[88],"type":["dbl"],"align":["right"]},{"label":["bpps_76"],"name":[89],"type":["dbl"],"align":["right"]},{"label":["bpps_77"],"name":[90],"type":["dbl"],"align":["right"]},{"label":["bpps_78"],"name":[91],"type":["dbl"],"align":["right"]},{"label":["bpps_79"],"name":[92],"type":["dbl"],"align":["right"]},{"label":["bpps_80"],"name":[93],"type":["dbl"],"align":["right"]},{"label":["bpps_81"],"name":[94],"type":["dbl"],"align":["right"]},{"label":["bpps_82"],"name":[95],"type":["dbl"],"align":["right"]},{"label":["bpps_83"],"name":[96],"type":["dbl"],"align":["right"]},{"label":["bpps_84"],"name":[97],"type":["dbl"],"align":["right"]},{"label":["bpps_85"],"name":[98],"type":["dbl"],"align":["right"]},{"label":["bpps_86"],"name":[99],"type":["dbl"],"align":["right"]},{"label":["bpps_87"],"name":[100],"type":["dbl"],"align":["right"]},{"label":["bpps_88"],"name":[101],"type":["dbl"],"align":["right"]},{"label":["bpps_89"],"name":[102],"type":["dbl"],"align":["right"]},{"label":["bpps_90"],"name":[103],"type":["dbl"],"align":["right"]},{"label":["bpps_91"],"name":[104],"type":["dbl"],"align":["right"]},{"label":["bpps_92"],"name":[105],"type":["dbl"],"align":["right"]},{"label":["bpps_93"],"name":[106],"type":["dbl"],"align":["right"]},{"label":["bpps_94"],"name":[107],"type":["dbl"],"align":["right"]},{"label":["bpps_95"],"name":[108],"type":["dbl"],"align":["right"]},{"label":["bpps_96"],"name":[109],"type":["dbl"],"align":["right"]},{"label":["bpps_97"],"name":[110],"type":["dbl"],"align":["right"]},{"label":["bpps_98"],"name":[111],"type":["dbl"],"align":["right"]},{"label":["bpps_99"],"name":[112],"type":["dbl"],"align":["right"]},{"label":["bpps_100"],"name":[113],"type":["dbl"],"align":["right"]},{"label":["bpps_101"],"name":[114],"type":["dbl"],"align":["right"]},{"label":["bpps_102"],"name":[115],"type":["dbl"],"align":["right"]},{"label":["bpps_103"],"name":[116],"type":["dbl"],"align":["right"]},{"label":["bpps_104"],"name":[117],"type":["dbl"],"align":["right"]},{"label":["bpps_105"],"name":[118],"type":["dbl"],"align":["right"]},{"label":["bpps_106"],"name":[119],"type":["dbl"],"align":["right"]},{"label":["signal_to_noise"],"name":[120],"type":["dbl"],"align":["right"]},{"label":["SN_filter"],"name":[121],"type":["int"],"align":["right"]},{"label":["reactivity"],"name":[122],"type":["dbl"],"align":["right"]},{"label":["deg_Mg_pH10"],"name":[123],"type":["dbl"],"align":["right"]},{"label":["deg_pH10"],"name":[124],"type":["dbl"],"align":["right"]},{"label":["deg_Mg_50C"],"name":[125],"type":["dbl"],"align":["right"]},{"label":["deg_50C"],"name":[126],"type":["dbl"],"align":["right"]}],"data":[{"1":"0","2":"id_001f94081_0","3":"G","4":"1","5":"O","6":"G","7":".","8":"O","9":".","10":"E","11":"O","12":"E","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0.00655413","21":"0.00922102","22":"0.00809437","23":"0.02178570","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0.00112002","30":"0","31":"0","32":"0","33":"0","34":"0","35":"0","36":"0.00465301","37":"0.00241507","38":"0","39":"0","40":"0","41":"0","42":"0.01146960","43":"0.00492862","44":"0","45":"0.00353196","46":"0","47":"0","48":"0","49":"0.00000000","50":"0.00000000","51":"0.00000000","52":"0.00159406","53":"0.00629747","54":"0","55":"0","56":"0","57":"0","58":"0","59":"0","60":"0","61":"0","62":"0","63":"0","64":"0","65":"0","66":"0","67":"0","68":"0","69":"0.00000000","70":"0.00529590","71":"0.00605378","72":"0","73":"0.00000000","74":"0","75":"0.0012753","76":"0.0136668","77":"0","78":"0","79":"0.00152313","80":"0","81":"0","82":"0","83":"0","84":"0","85":"0","86":"0","87":"0","88":"0","89":"0.00000000","90":"0.00141133","91":"0","92":"0.00275790","93":"0.00598010","94":"0.00597894","95":"0.0138868","96":"0","97":"0","98":"0.00152801","99":"0","100":"0","101":"0","102":"0","103":"0","104":"0","105":"0","106":"0","107":"0.00952557","108":"0","109":"0","110":"0.01114590","111":"0","112":"0","113":"0.01163650","114":"0","115":"0","116":"0.01053770","117":"0","118":"0","119":"0.01467360","120":"6.894","121":"1","122":"0.3297","123":"0.7556","124":"2.3375","125":"0.3581","126":"0.6382","_rn_":"1"},{"1":"1","2":"id_001f94081_1","3":"G","4":"2","5":"G","6":"A","7":".","8":".","9":".","10":"E","11":"E","12":"E","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0.01820530","21":"0.00511209","22":"0.03865270","23":"0.00000000","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0.00000000","30":"0","31":"0","32":"0","33":"0","34":"0","35":"0","36":"0.00432340","37":"0.00000000","38":"0","39":"0","40":"0","41":"0","42":"0.00856126","43":"0.00000000","44":"0","45":"0.00113814","46":"0","47":"0","48":"0","49":"0.00000000","50":"0.00000000","51":"0.00144827","52":"0.01117350","53":"0.00000000","54":"0","55":"0","56":"0","57":"0","58":"0","59":"0","60":"0","61":"0","62":"0","63":"0","64":"0","65":"0","66":"0","67":"0","68":"0","69":"0.00515096","70":"0.00579555","71":"0.00000000","72":"0","73":"0.00000000","74":"0","75":"0.0133479","76":"0.0000000","77":"0","78":"0","79":"0.00000000","80":"0","81":"0","82":"0","83":"0","84":"0","85":"0","86":"0","87":"0","88":"0","89":"0.00000000","90":"0.00443669","91":"0","92":"0.00969451","93":"0.00376965","94":"0.02291480","95":"0.0000000","96":"0","97":"0","98":"0.00000000","99":"0","100":"0","101":"0","102":"0","103":"0","104":"0","105":"0","106":"0","107":"0.00578259","108":"0","109":"0","110":"0.00633638","111":"0","112":"0","113":"0.00603195","114":"0","115":"0","116":"0.00563282","117":"0","118":"0","119":"0.00620374","120":"6.894","121":"1","122":"1.5693","123":"2.9830","124":"3.5060","125":"2.9683","126":"3.4773","_rn_":"2"},{"1":"2","2":"id_001f94081_2","3":"A","4":"3","5":"G","6":"A","7":".","8":".","9":".","10":"E","11":"E","12":"E","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0.00000000","21":"0.02759040","22":"0.00000000","23":"0.00000000","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0.00000000","30":"0","31":"0","32":"0","33":"0","34":"0","35":"0","36":"0.00000000","37":"0.00000000","38":"0","39":"0","40":"0","41":"0","42":"0.00000000","43":"0.00000000","44":"0","45":"0.00000000","46":"0","47":"0","48":"0","49":"0.00000000","50":"0.00132569","51":"0.01070460","52":"0.00000000","53":"0.00000000","54":"0","55":"0","56":"0","57":"0","58":"0","59":"0","60":"0","61":"0","62":"0","63":"0","64":"0","65":"0","66":"0","67":"0","68":"0","69":"0.00000000","70":"0.00000000","71":"0.00000000","72":"0","73":"0.00000000","74":"0","75":"0.0000000","76":"0.0000000","77":"0","78":"0","79":"0.00000000","80":"0","81":"0","82":"0","83":"0","84":"0","85":"0","86":"0","87":"0","88":"0","89":"0.00287931","90":"0.00000000","91":"0","92":"0.00000000","93":"0.01750240","94":"0.00000000","95":"0.0000000","96":"0","97":"0","98":"0.00000000","99":"0","100":"0","101":"0","102":"0","103":"0","104":"0","105":"0","106":"0","107":"0.00000000","108":"0","109":"0","110":"0.00000000","111":"0","112":"0","113":"0.00000000","114":"0","115":"0","116":"0.00000000","117":"0","118":"0","119":"0.00000000","120":"6.894","121":"1","122":"1.1227","123":"0.2526","124":"0.3008","125":"0.2589","126":"0.9988","_rn_":"3"},{"1":"3","2":"id_001f94081_3","3":"A","4":"4","5":"A","6":"A","7":".","8":".","9":".","10":"E","11":"E","12":"E","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0.00000000","21":"0.00000000","22":"0.00000000","23":"0.00000000","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0.00000000","30":"0","31":"0","32":"0","33":"0","34":"0","35":"0","36":"0.00000000","37":"0.00127806","38":"0","39":"0","40":"0","41":"0","42":"0.00000000","43":"0.00000000","44":"0","45":"0.00000000","46":"0","47":"0","48":"0","49":"0.00105140","50":"0.00947066","51":"0.00000000","52":"0.00000000","53":"0.00000000","54":"0","55":"0","56":"0","57":"0","58":"0","59":"0","60":"0","61":"0","62":"0","63":"0","64":"0","65":"0","66":"0","67":"0","68":"0","69":"0.00000000","70":"0.00000000","71":"0.00000000","72":"0","73":"0.00132209","74":"0","75":"0.0000000","76":"0.0000000","77":"0","78":"0","79":"0.00000000","80":"0","81":"0","82":"0","83":"0","84":"0","85":"0","86":"0","87":"0","88":"0","89":"0.00000000","90":"0.00000000","91":"0","92":"0.00000000","93":"0.00000000","94":"0.00000000","95":"0.0000000","96":"0","97":"0","98":"0.00000000","99":"0","100":"0","101":"0","102":"0","103":"0","104":"0","105":"0","106":"0","107":"0.00000000","108":"0","109":"0","110":"0.00000000","111":"0","112":"0","113":"0.00000000","114":"0","115":"0","116":"0.00000000","117":"0","118":"0","119":"0.00000000","120":"6.894","121":"1","122":"0.8686","123":"1.3789","124":"1.0108","125":"1.4552","126":"1.3228","_rn_":"4"},{"1":"4","2":"id_001f94081_4","3":"A","4":"5","5":"A","6":"A","7":".","8":".","9":"(","10":"E","11":"E","12":"S","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0.00000000","21":"0.00000000","22":"0.00000000","23":"0.00000000","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0.00000000","30":"0","31":"0","32":"0","33":"0","34":"0","35":"0","36":"0.00000000","37":"0.00284297","38":"0","39":"0","40":"0","41":"0","42":"0.00000000","43":"0.00000000","44":"0","45":"0.00000000","46":"0","47":"0","48":"0","49":"0.00702873","50":"0.00000000","51":"0.00000000","52":"0.00000000","53":"0.00000000","54":"0","55":"0","56":"0","57":"0","58":"0","59":"0","60":"0","61":"0","62":"0","63":"0","64":"0","65":"0","66":"0","67":"0","68":"0","69":"0.00000000","70":"0.00000000","71":"0.00000000","72":"0","73":"0.00000000","74":"0","75":"0.0000000","76":"0.0000000","77":"0","78":"0","79":"0.00000000","80":"0","81":"0","82":"0","83":"0","84":"0","85":"0","86":"0","87":"0","88":"0","89":"0.00140816","90":"0.00000000","91":"0","92":"0.00000000","93":"0.00000000","94":"0.00000000","95":"0.0000000","96":"0","97":"0","98":"0.00000000","99":"0","100":"0","101":"0","102":"0","103":"0","104":"0","105":"0","106":"0","107":"0.00000000","108":"0","109":"0","110":"0.00000000","111":"0","112":"0","113":"0.00000000","114":"0","115":"0","116":"0.00000000","117":"0","118":"0","119":"0.00000000","120":"6.894","121":"1","122":"0.7217","123":"0.6376","124":"0.2635","125":"0.7244","126":"0.7877","_rn_":"5"},{"1":"5","2":"id_001f94081_5","3":"A","4":"6","5":"A","6":"G","7":"(","8":".","9":"(","10":"S","11":"E","12":"S","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0.00000000","21":"0.00310716","22":"0.00000000","23":"0.00117008","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0.00000000","30":"0","31":"0","32":"0","33":"0","34":"0","35":"0","36":"0.00000000","37":"0.06989900","38":"0","39":"0","40":"0","41":"0","42":"0.00000000","43":"0.00685149","44":"0","45":"0.00000000","46":"0","47":"0","48":"0","49":"0.00000000","50":"0.00000000","51":"0.00000000","52":"0.00000000","53":"0.00000000","54":"0","55":"0","56":"0","57":"0","58":"0","59":"0","60":"0","61":"0","62":"0","63":"0","64":"0","65":"0","66":"0","67":"0","68":"0","69":"0.00000000","70":"0.00000000","71":"0.00000000","72":"0","73":"0.00000000","74":"0","75":"0.0000000","76":"0.0000000","77":"0","78":"0","79":"0.00000000","80":"0","81":"0","82":"0","83":"0","84":"0","85":"0","86":"0","87":"0","88":"0","89":"0.04401610","90":"0.00000000","91":"0","92":"0.00000000","93":"0.00235197","94":"0.00000000","95":"0.0000000","96":"0","97":"0","98":"0.00000000","99":"0","100":"0","101":"0","102":"0","103":"0","104":"0","105":"0","106":"0","107":"0.00000000","108":"0","109":"0","110":"0.00000000","111":"0","112":"0","113":"0.00000000","114":"0","115":"0","116":"0.00000000","117":"0","118":"0","119":"0.00000000","120":"6.894","121":"1","122":"0.4384","123":"0.3313","124":"0.3403","125":"0.4971","126":"0.5890","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">data =<span class="st"> </span>data[,<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">head</span>(data)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["id"],"name":[1],"type":["fct"],"align":["left"]},{"label":["sequence"],"name":[2],"type":["fct"],"align":["left"]},{"label":["index_sequence"],"name":[3],"type":["int"],"align":["right"]},{"label":["seq_be"],"name":[4],"type":["fct"],"align":["left"]},{"label":["seq_af"],"name":[5],"type":["fct"],"align":["left"]},{"label":["structure"],"name":[6],"type":["fct"],"align":["left"]},{"label":["struct_be"],"name":[7],"type":["fct"],"align":["left"]},{"label":["struct_af"],"name":[8],"type":["fct"],"align":["left"]},{"label":["predicted_loop_type"],"name":[9],"type":["fct"],"align":["left"]},{"label":["loop_type_be"],"name":[10],"type":["fct"],"align":["left"]},{"label":["loop_type_af"],"name":[11],"type":["fct"],"align":["left"]},{"label":["bpps_0"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["bpps_1"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["bpps_2"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["bpps_3"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["bpps_4"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["bpps_5"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["bpps_6"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["bpps_7"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["bpps_8"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["bpps_9"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["bpps_10"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["bpps_11"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["bpps_12"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["bpps_13"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["bpps_14"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["bpps_15"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["bpps_16"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["bpps_17"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["bpps_18"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["bpps_19"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["bpps_20"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["bpps_21"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["bpps_22"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["bpps_23"],"name":[35],"type":["dbl"],"align":["right"]},{"label":["bpps_24"],"name":[36],"type":["dbl"],"align":["right"]},{"label":["bpps_25"],"name":[37],"type":["dbl"],"align":["right"]},{"label":["bpps_26"],"name":[38],"type":["dbl"],"align":["right"]},{"label":["bpps_27"],"name":[39],"type":["dbl"],"align":["right"]},{"label":["bpps_28"],"name":[40],"type":["dbl"],"align":["right"]},{"label":["bpps_29"],"name":[41],"type":["dbl"],"align":["right"]},{"label":["bpps_30"],"name":[42],"type":["dbl"],"align":["right"]},{"label":["bpps_31"],"name":[43],"type":["dbl"],"align":["right"]},{"label":["bpps_32"],"name":[44],"type":["dbl"],"align":["right"]},{"label":["bpps_33"],"name":[45],"type":["dbl"],"align":["right"]},{"label":["bpps_34"],"name":[46],"type":["dbl"],"align":["right"]},{"label":["bpps_35"],"name":[47],"type":["dbl"],"align":["right"]},{"label":["bpps_36"],"name":[48],"type":["dbl"],"align":["right"]},{"label":["bpps_37"],"name":[49],"type":["dbl"],"align":["right"]},{"label":["bpps_38"],"name":[50],"type":["dbl"],"align":["right"]},{"label":["bpps_39"],"name":[51],"type":["dbl"],"align":["right"]},{"label":["bpps_40"],"name":[52],"type":["dbl"],"align":["right"]},{"label":["bpps_41"],"name":[53],"type":["dbl"],"align":["right"]},{"label":["bpps_42"],"name":[54],"type":["dbl"],"align":["right"]},{"label":["bpps_43"],"name":[55],"type":["dbl"],"align":["right"]},{"label":["bpps_44"],"name":[56],"type":["dbl"],"align":["right"]},{"label":["bpps_45"],"name":[57],"type":["dbl"],"align":["right"]},{"label":["bpps_46"],"name":[58],"type":["dbl"],"align":["right"]},{"label":["bpps_47"],"name":[59],"type":["dbl"],"align":["right"]},{"label":["bpps_48"],"name":[60],"type":["dbl"],"align":["right"]},{"label":["bpps_49"],"name":[61],"type":["dbl"],"align":["right"]},{"label":["bpps_50"],"name":[62],"type":["dbl"],"align":["right"]},{"label":["bpps_51"],"name":[63],"type":["dbl"],"align":["right"]},{"label":["bpps_52"],"name":[64],"type":["dbl"],"align":["right"]},{"label":["bpps_53"],"name":[65],"type":["dbl"],"align":["right"]},{"label":["bpps_54"],"name":[66],"type":["dbl"],"align":["right"]},{"label":["bpps_55"],"name":[67],"type":["dbl"],"align":["right"]},{"label":["bpps_56"],"name":[68],"type":["dbl"],"align":["right"]},{"label":["bpps_57"],"name":[69],"type":["dbl"],"align":["right"]},{"label":["bpps_58"],"name":[70],"type":["dbl"],"align":["right"]},{"label":["bpps_59"],"name":[71],"type":["dbl"],"align":["right"]},{"label":["bpps_60"],"name":[72],"type":["dbl"],"align":["right"]},{"label":["bpps_61"],"name":[73],"type":["dbl"],"align":["right"]},{"label":["bpps_62"],"name":[74],"type":["dbl"],"align":["right"]},{"label":["bpps_63"],"name":[75],"type":["dbl"],"align":["right"]},{"label":["bpps_64"],"name":[76],"type":["dbl"],"align":["right"]},{"label":["bpps_65"],"name":[77],"type":["dbl"],"align":["right"]},{"label":["bpps_66"],"name":[78],"type":["dbl"],"align":["right"]},{"label":["bpps_67"],"name":[79],"type":["dbl"],"align":["right"]},{"label":["bpps_68"],"name":[80],"type":["dbl"],"align":["right"]},{"label":["bpps_69"],"name":[81],"type":["dbl"],"align":["right"]},{"label":["bpps_70"],"name":[82],"type":["dbl"],"align":["right"]},{"label":["bpps_71"],"name":[83],"type":["dbl"],"align":["right"]},{"label":["bpps_72"],"name":[84],"type":["dbl"],"align":["right"]},{"label":["bpps_73"],"name":[85],"type":["dbl"],"align":["right"]},{"label":["bpps_74"],"name":[86],"type":["dbl"],"align":["right"]},{"label":["bpps_75"],"name":[87],"type":["dbl"],"align":["right"]},{"label":["bpps_76"],"name":[88],"type":["dbl"],"align":["right"]},{"label":["bpps_77"],"name":[89],"type":["dbl"],"align":["right"]},{"label":["bpps_78"],"name":[90],"type":["dbl"],"align":["right"]},{"label":["bpps_79"],"name":[91],"type":["dbl"],"align":["right"]},{"label":["bpps_80"],"name":[92],"type":["dbl"],"align":["right"]},{"label":["bpps_81"],"name":[93],"type":["dbl"],"align":["right"]},{"label":["bpps_82"],"name":[94],"type":["dbl"],"align":["right"]},{"label":["bpps_83"],"name":[95],"type":["dbl"],"align":["right"]},{"label":["bpps_84"],"name":[96],"type":["dbl"],"align":["right"]},{"label":["bpps_85"],"name":[97],"type":["dbl"],"align":["right"]},{"label":["bpps_86"],"name":[98],"type":["dbl"],"align":["right"]},{"label":["bpps_87"],"name":[99],"type":["dbl"],"align":["right"]},{"label":["bpps_88"],"name":[100],"type":["dbl"],"align":["right"]},{"label":["bpps_89"],"name":[101],"type":["dbl"],"align":["right"]},{"label":["bpps_90"],"name":[102],"type":["dbl"],"align":["right"]},{"label":["bpps_91"],"name":[103],"type":["dbl"],"align":["right"]},{"label":["bpps_92"],"name":[104],"type":["dbl"],"align":["right"]},{"label":["bpps_93"],"name":[105],"type":["dbl"],"align":["right"]},{"label":["bpps_94"],"name":[106],"type":["dbl"],"align":["right"]},{"label":["bpps_95"],"name":[107],"type":["dbl"],"align":["right"]},{"label":["bpps_96"],"name":[108],"type":["dbl"],"align":["right"]},{"label":["bpps_97"],"name":[109],"type":["dbl"],"align":["right"]},{"label":["bpps_98"],"name":[110],"type":["dbl"],"align":["right"]},{"label":["bpps_99"],"name":[111],"type":["dbl"],"align":["right"]},{"label":["bpps_100"],"name":[112],"type":["dbl"],"align":["right"]},{"label":["bpps_101"],"name":[113],"type":["dbl"],"align":["right"]},{"label":["bpps_102"],"name":[114],"type":["dbl"],"align":["right"]},{"label":["bpps_103"],"name":[115],"type":["dbl"],"align":["right"]},{"label":["bpps_104"],"name":[116],"type":["dbl"],"align":["right"]},{"label":["bpps_105"],"name":[117],"type":["dbl"],"align":["right"]},{"label":["bpps_106"],"name":[118],"type":["dbl"],"align":["right"]},{"label":["signal_to_noise"],"name":[119],"type":["dbl"],"align":["right"]},{"label":["SN_filter"],"name":[120],"type":["int"],"align":["right"]},{"label":["reactivity"],"name":[121],"type":["dbl"],"align":["right"]},{"label":["deg_Mg_pH10"],"name":[122],"type":["dbl"],"align":["right"]},{"label":["deg_pH10"],"name":[123],"type":["dbl"],"align":["right"]},{"label":["deg_Mg_50C"],"name":[124],"type":["dbl"],"align":["right"]},{"label":["deg_50C"],"name":[125],"type":["dbl"],"align":["right"]}],"data":[{"1":"id_001f94081_0","2":"G","3":"1","4":"O","5":"G","6":".","7":"O","8":".","9":"E","10":"O","11":"E","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0.00655413","20":"0.00922102","21":"0.00809437","22":"0.02178570","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0.00112002","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0","35":"0.00465301","36":"0.00241507","37":"0","38":"0","39":"0","40":"0","41":"0.01146960","42":"0.00492862","43":"0","44":"0.00353196","45":"0","46":"0","47":"0","48":"0.00000000","49":"0.00000000","50":"0.00000000","51":"0.00159406","52":"0.00629747","53":"0","54":"0","55":"0","56":"0","57":"0","58":"0","59":"0","60":"0","61":"0","62":"0","63":"0","64":"0","65":"0","66":"0","67":"0","68":"0.00000000","69":"0.00529590","70":"0.00605378","71":"0","72":"0.00000000","73":"0","74":"0.0012753","75":"0.0136668","76":"0","77":"0","78":"0.00152313","79":"0","80":"0","81":"0","82":"0","83":"0","84":"0","85":"0","86":"0","87":"0","88":"0.00000000","89":"0.00141133","90":"0","91":"0.00275790","92":"0.00598010","93":"0.00597894","94":"0.0138868","95":"0","96":"0","97":"0.00152801","98":"0","99":"0","100":"0","101":"0","102":"0","103":"0","104":"0","105":"0","106":"0.00952557","107":"0","108":"0","109":"0.01114590","110":"0","111":"0","112":"0.01163650","113":"0","114":"0","115":"0.01053770","116":"0","117":"0","118":"0.01467360","119":"6.894","120":"1","121":"0.3297","122":"0.7556","123":"2.3375","124":"0.3581","125":"0.6382","_rn_":"1"},{"1":"id_001f94081_1","2":"G","3":"2","4":"G","5":"A","6":".","7":".","8":".","9":"E","10":"E","11":"E","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0.01820530","20":"0.00511209","21":"0.03865270","22":"0.00000000","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0.00000000","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0","35":"0.00432340","36":"0.00000000","37":"0","38":"0","39":"0","40":"0","41":"0.00856126","42":"0.00000000","43":"0","44":"0.00113814","45":"0","46":"0","47":"0","48":"0.00000000","49":"0.00000000","50":"0.00144827","51":"0.01117350","52":"0.00000000","53":"0","54":"0","55":"0","56":"0","57":"0","58":"0","59":"0","60":"0","61":"0","62":"0","63":"0","64":"0","65":"0","66":"0","67":"0","68":"0.00515096","69":"0.00579555","70":"0.00000000","71":"0","72":"0.00000000","73":"0","74":"0.0133479","75":"0.0000000","76":"0","77":"0","78":"0.00000000","79":"0","80":"0","81":"0","82":"0","83":"0","84":"0","85":"0","86":"0","87":"0","88":"0.00000000","89":"0.00443669","90":"0","91":"0.00969451","92":"0.00376965","93":"0.02291480","94":"0.0000000","95":"0","96":"0","97":"0.00000000","98":"0","99":"0","100":"0","101":"0","102":"0","103":"0","104":"0","105":"0","106":"0.00578259","107":"0","108":"0","109":"0.00633638","110":"0","111":"0","112":"0.00603195","113":"0","114":"0","115":"0.00563282","116":"0","117":"0","118":"0.00620374","119":"6.894","120":"1","121":"1.5693","122":"2.9830","123":"3.5060","124":"2.9683","125":"3.4773","_rn_":"2"},{"1":"id_001f94081_2","2":"A","3":"3","4":"G","5":"A","6":".","7":".","8":".","9":"E","10":"E","11":"E","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0.00000000","20":"0.02759040","21":"0.00000000","22":"0.00000000","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0.00000000","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0","35":"0.00000000","36":"0.00000000","37":"0","38":"0","39":"0","40":"0","41":"0.00000000","42":"0.00000000","43":"0","44":"0.00000000","45":"0","46":"0","47":"0","48":"0.00000000","49":"0.00132569","50":"0.01070460","51":"0.00000000","52":"0.00000000","53":"0","54":"0","55":"0","56":"0","57":"0","58":"0","59":"0","60":"0","61":"0","62":"0","63":"0","64":"0","65":"0","66":"0","67":"0","68":"0.00000000","69":"0.00000000","70":"0.00000000","71":"0","72":"0.00000000","73":"0","74":"0.0000000","75":"0.0000000","76":"0","77":"0","78":"0.00000000","79":"0","80":"0","81":"0","82":"0","83":"0","84":"0","85":"0","86":"0","87":"0","88":"0.00287931","89":"0.00000000","90":"0","91":"0.00000000","92":"0.01750240","93":"0.00000000","94":"0.0000000","95":"0","96":"0","97":"0.00000000","98":"0","99":"0","100":"0","101":"0","102":"0","103":"0","104":"0","105":"0","106":"0.00000000","107":"0","108":"0","109":"0.00000000","110":"0","111":"0","112":"0.00000000","113":"0","114":"0","115":"0.00000000","116":"0","117":"0","118":"0.00000000","119":"6.894","120":"1","121":"1.1227","122":"0.2526","123":"0.3008","124":"0.2589","125":"0.9988","_rn_":"3"},{"1":"id_001f94081_3","2":"A","3":"4","4":"A","5":"A","6":".","7":".","8":".","9":"E","10":"E","11":"E","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0.00000000","20":"0.00000000","21":"0.00000000","22":"0.00000000","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0.00000000","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0","35":"0.00000000","36":"0.00127806","37":"0","38":"0","39":"0","40":"0","41":"0.00000000","42":"0.00000000","43":"0","44":"0.00000000","45":"0","46":"0","47":"0","48":"0.00105140","49":"0.00947066","50":"0.00000000","51":"0.00000000","52":"0.00000000","53":"0","54":"0","55":"0","56":"0","57":"0","58":"0","59":"0","60":"0","61":"0","62":"0","63":"0","64":"0","65":"0","66":"0","67":"0","68":"0.00000000","69":"0.00000000","70":"0.00000000","71":"0","72":"0.00132209","73":"0","74":"0.0000000","75":"0.0000000","76":"0","77":"0","78":"0.00000000","79":"0","80":"0","81":"0","82":"0","83":"0","84":"0","85":"0","86":"0","87":"0","88":"0.00000000","89":"0.00000000","90":"0","91":"0.00000000","92":"0.00000000","93":"0.00000000","94":"0.0000000","95":"0","96":"0","97":"0.00000000","98":"0","99":"0","100":"0","101":"0","102":"0","103":"0","104":"0","105":"0","106":"0.00000000","107":"0","108":"0","109":"0.00000000","110":"0","111":"0","112":"0.00000000","113":"0","114":"0","115":"0.00000000","116":"0","117":"0","118":"0.00000000","119":"6.894","120":"1","121":"0.8686","122":"1.3789","123":"1.0108","124":"1.4552","125":"1.3228","_rn_":"4"},{"1":"id_001f94081_4","2":"A","3":"5","4":"A","5":"A","6":".","7":".","8":"(","9":"E","10":"E","11":"S","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0.00000000","20":"0.00000000","21":"0.00000000","22":"0.00000000","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0.00000000","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0","35":"0.00000000","36":"0.00284297","37":"0","38":"0","39":"0","40":"0","41":"0.00000000","42":"0.00000000","43":"0","44":"0.00000000","45":"0","46":"0","47":"0","48":"0.00702873","49":"0.00000000","50":"0.00000000","51":"0.00000000","52":"0.00000000","53":"0","54":"0","55":"0","56":"0","57":"0","58":"0","59":"0","60":"0","61":"0","62":"0","63":"0","64":"0","65":"0","66":"0","67":"0","68":"0.00000000","69":"0.00000000","70":"0.00000000","71":"0","72":"0.00000000","73":"0","74":"0.0000000","75":"0.0000000","76":"0","77":"0","78":"0.00000000","79":"0","80":"0","81":"0","82":"0","83":"0","84":"0","85":"0","86":"0","87":"0","88":"0.00140816","89":"0.00000000","90":"0","91":"0.00000000","92":"0.00000000","93":"0.00000000","94":"0.0000000","95":"0","96":"0","97":"0.00000000","98":"0","99":"0","100":"0","101":"0","102":"0","103":"0","104":"0","105":"0","106":"0.00000000","107":"0","108":"0","109":"0.00000000","110":"0","111":"0","112":"0.00000000","113":"0","114":"0","115":"0.00000000","116":"0","117":"0","118":"0.00000000","119":"6.894","120":"1","121":"0.7217","122":"0.6376","123":"0.2635","124":"0.7244","125":"0.7877","_rn_":"5"},{"1":"id_001f94081_5","2":"A","3":"6","4":"A","5":"G","6":"(","7":".","8":"(","9":"S","10":"E","11":"S","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0.00000000","20":"0.00310716","21":"0.00000000","22":"0.00117008","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0.00000000","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0","35":"0.00000000","36":"0.06989900","37":"0","38":"0","39":"0","40":"0","41":"0.00000000","42":"0.00685149","43":"0","44":"0.00000000","45":"0","46":"0","47":"0","48":"0.00000000","49":"0.00000000","50":"0.00000000","51":"0.00000000","52":"0.00000000","53":"0","54":"0","55":"0","56":"0","57":"0","58":"0","59":"0","60":"0","61":"0","62":"0","63":"0","64":"0","65":"0","66":"0","67":"0","68":"0.00000000","69":"0.00000000","70":"0.00000000","71":"0","72":"0.00000000","73":"0","74":"0.0000000","75":"0.0000000","76":"0","77":"0","78":"0.00000000","79":"0","80":"0","81":"0","82":"0","83":"0","84":"0","85":"0","86":"0","87":"0","88":"0.04401610","89":"0.00000000","90":"0","91":"0.00000000","92":"0.00235197","93":"0.00000000","94":"0.0000000","95":"0","96":"0","97":"0.00000000","98":"0","99":"0","100":"0","101":"0","102":"0","103":"0","104":"0","105":"0","106":"0.00000000","107":"0","108":"0","109":"0.00000000","110":"0","111":"0","112":"0.00000000","113":"0","114":"0","115":"0.00000000","116":"0","117":"0","118":"0.00000000","119":"6.894","120":"1","121":"0.4384","122":"0.3313","123":"0.3403","124":"0.4971","125":"0.5890","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>On change les types des variables qui sont mal codées.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">data=data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">sequence =</span> <span class="kw">as.factor</span>(sequence)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">seq_be =</span> <span class="kw">as.factor</span>(seq_be)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">seq_af =</span> <span class="kw">as.factor</span>(seq_af)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sequence =</span> <span class="kw">as.factor</span>(sequence)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">structure =</span> <span class="kw">as.factor</span>(structure)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">struct_be =</span> <span class="kw">as.factor</span>(struct_be)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">struct_af =</span> <span class="kw">as.factor</span>(struct_af)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">predicted_loop_type =</span> <span class="kw">as.factor</span>(predicted_loop_type)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">loop_type_be =</span> <span class="kw">as.factor</span>(loop_type_be)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">loop_type_af =</span> <span class="kw">as.factor</span>(loop_type_af)) </a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">length_sequence_train &lt;-<span class="st"> </span><span class="dv">68</span></a></code></pre></div>
<p>On filtre maintenant les données qui ont SN_filter=0.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">print</span>(<span class="kw">sum</span>(<span class="kw">is.na</span>(data)))</a></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">print</span>(<span class="kw">sum</span>(data<span class="op">$</span>SN_filter<span class="op">==</span><span class="dv">0</span>)<span class="op">/</span>length_sequence_train) <span class="co"># Nombre d&#39;individus dont le SN_filter=0</span></a></code></pre></div>
<pre><code>## [1] 811</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">data=data[data<span class="op">$</span>SN_filter<span class="op">==</span><span class="dv">1</span>,]</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw">rownames</span>(data)=NULL<span class="co">#1:108052</span></a></code></pre></div>
<p>Plutôt que mettre à 0 les valeurs négatives, on va effectuer une translation sur chaque label en soustrayant chacune de ses valeurs par la valeur minimale du label puis en ajoutant un bruit afin de se placer sur <span class="math inline">\(\mathbb{R}_+^*\)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">p =<span class="st"> </span><span class="kw">dim</span>(data)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb11-2" title="2">bruit =<span class="st"> </span><span class="fl">1e-12</span></a></code></pre></div>
<p>Initialement, il existe des valeurs négatives pour nos labels.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">sum</span>(data[,(p<span class="dv">-4</span>)<span class="op">:</span>p] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="co"># nb total de lignes où il existe des labels qui ont des valeurs négatives</span></a></code></pre></div>
<pre><code>## [1] 23008</code></pre>
<p>On peut aussi afficher le nombre de lignes où il y a des valeurs négatives pour chacun de nos labels. On peut remarquer que chaque label en possède.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">sum</span>(data<span class="op">$</span>reactivity <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] 7070</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">sum</span>(data<span class="op">$</span>deg_50C <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] 5512</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">sum</span>(data<span class="op">$</span>deg_Mg_50C <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] 4495</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">sum</span>(data<span class="op">$</span>deg_pH10 <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] 3937</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">sum</span>(data<span class="op">$</span>deg_Mg_pH10 <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] 1994</code></pre>
<p>On stocke une copie des labels dans un dataframe, afin de pouvoir les utiliser pour calculer les erreurs de prédiction de nos futurs modèles.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">original_data &lt;-<span class="st"> </span>data[, (p<span class="dv">-4</span>)<span class="op">:</span>p]</a></code></pre></div>
<p>On effectue une translation pour se placer sur <span class="math inline">\(\mathbb{R}_+^*\)</span>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">translation_labels &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb25-2" title="2"><span class="cf">for</span> (i <span class="cf">in</span> (p<span class="dv">-4</span>)<span class="op">:</span>p)</a>
<a class="sourceLine" id="cb25-3" title="3">{</a>
<a class="sourceLine" id="cb25-4" title="4">  <span class="co"># On stocke les valeurs utilisées lors des translations de chaque label</span></a>
<a class="sourceLine" id="cb25-5" title="5">  <span class="co"># afin de pouvoir revenir à leurs valeurs initiales</span></a>
<a class="sourceLine" id="cb25-6" title="6">  translation_labels &lt;-<span class="st"> </span><span class="kw">c</span>(translation_labels, <span class="kw">min</span>(data[,i]) <span class="op">-</span><span class="st"> </span>bruit) </a>
<a class="sourceLine" id="cb25-7" title="7">  <span class="co"># On soustrait à chaque label son minimum (qui est une valeur strictement négative)</span></a>
<a class="sourceLine" id="cb25-8" title="8">  <span class="co"># l&#39;ajout du bruit permet ensuite d&#39;éliminer les valeurs nulles.</span></a>
<a class="sourceLine" id="cb25-9" title="9">  data[,i] &lt;-<span class="st"> </span>data[,i] <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(data[,i]) <span class="op">+</span><span class="st"> </span>bruit </a>
<a class="sourceLine" id="cb25-10" title="10">}</a>
<a class="sourceLine" id="cb25-11" title="11">translation_labels &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">t</span>(translation_labels))</a>
<a class="sourceLine" id="cb25-12" title="12"><span class="kw">colnames</span>(translation_labels) &lt;-<span class="st"> </span><span class="kw">colnames</span>(data)[(p<span class="dv">-4</span>)<span class="op">:</span>p]</a></code></pre></div>
<p>On a bien retiré toutes les valeurs négatives.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">sum</span>(data[,(p<span class="dv">-4</span>)<span class="op">:</span>p] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="co"># Il n&#39;y a plus aucune valeur négative</span></a></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>Il suffira d’ajouter pour chaque label sa valeur dans ce dataframe pour revenir à ses valeurs initiales.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">translation_labels</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["reactivity"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["deg_Mg_pH10"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["deg_pH10"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["deg_Mg_50C"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["deg_50C"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"-0.3851","2":"-0.2853","3":"-0.4997","4":"-0.4982","5":"-0.4965"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="création-de-la-base-trainvalidation" class="section level1">
<h1>Création de la base train/validation</h1>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">tamp=<span class="kw">train_test_split</span>(data)</a>
<a class="sourceLine" id="cb29-2" title="2">index_train =<span class="st"> </span>tamp<span class="op">$</span>index_train</a>
<a class="sourceLine" id="cb29-3" title="3"></a>
<a class="sourceLine" id="cb29-4" title="4">data_train=tamp<span class="op">$</span>train</a>
<a class="sourceLine" id="cb29-5" title="5"><span class="kw">rownames</span>(data_train) &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb29-6" title="6"></a>
<a class="sourceLine" id="cb29-7" title="7">data_val=tamp<span class="op">$</span>val</a>
<a class="sourceLine" id="cb29-8" title="8"><span class="kw">rownames</span>(data_val) &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb29-9" title="9"></a>
<a class="sourceLine" id="cb29-10" title="10"><span class="co"># Valeurs initiales des labels pour le train</span></a>
<a class="sourceLine" id="cb29-11" title="11">original_data_train =<span class="st"> </span>original_data[index_train,]</a>
<a class="sourceLine" id="cb29-12" title="12"><span class="kw">rownames</span>(original_data_train) &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb29-13" title="13"></a>
<a class="sourceLine" id="cb29-14" title="14"><span class="co"># Valeurs initiales des labels pour la validation</span></a>
<a class="sourceLine" id="cb29-15" title="15">original_data_val =<span class="st"> </span>original_data[<span class="op">-</span>index_train,]</a>
<a class="sourceLine" id="cb29-16" title="16"><span class="kw">rownames</span>(original_data_val) &lt;-<span class="st"> </span><span class="ot">NULL</span></a></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">sum</span>(<span class="kw">is.na</span>(data_train))</a></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">sum</span>(<span class="kw">is.na</span>(data_val))</a></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="kw">dim</span>(data_train)[<span class="dv">1</span>]<span class="op">+</span><span class="kw">dim</span>(data_val)[<span class="dv">1</span>]<span class="op">-</span><span class="kw">dim</span>(data)[<span class="dv">1</span>]</a></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="co">#rm(tamp,data)</span></a></code></pre></div>
</div>
<div id="glm-loi-gamma" class="section level1">
<h1>GLM : loi Gamma</h1>
<p>Initialisation de vecteurs pour stocker nos résultats.</p>
<p>Résultats pour le label <code>reactivity</code>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">models_reactivity &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb37-2" title="2">errors_reactivity_train &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb37-3" title="3">errors_reactivity_val &lt;-<span class="st"> </span><span class="kw">c</span>()</a></code></pre></div>
<p>Résultats pour le label <code>deg_Mg_pH10</code>.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">models_deg_Mg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb38-2" title="2">errors_deg_Mg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb38-3" title="3">errors_deg_Mg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>()</a></code></pre></div>
<p>Résultats pour le label <code>deg_pH10</code>.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">models_deg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb39-2" title="2">errors_deg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb39-3" title="3">errors_deg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>()</a></code></pre></div>
<p>Résultats pour le label <code>deg_Mg_50C</code>.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">models_deg_Mg_50C &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb40-2" title="2">errors_deg_Mg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb40-3" title="3">errors_deg_Mg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>()</a></code></pre></div>
<p>Résultats pour le label <code>deg_50C</code>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">models_deg_50C &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb41-2" title="2">errors_deg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb41-3" title="3">errors_deg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>()</a></code></pre></div>
<p>Formule du modèle initial utilisé.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">formula_model_full &lt;-<span class="st"> &quot;reactivity ~ sequence + index_sequence + structure + predicted_loop_type + seq_be + seq_af + struct_be + struct_af + loop_type_be + loop_type_af&quot;</span></a>
<a class="sourceLine" id="cb42-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span><span class="dv">106</span>)</a>
<a class="sourceLine" id="cb42-3" title="3">{</a>
<a class="sourceLine" id="cb42-4" title="4">  formula_model_full &lt;-<span class="st"> </span><span class="kw">paste0</span>(formula_model_full, <span class="st">&quot; + bpps_&quot;</span>, i)</a>
<a class="sourceLine" id="cb42-5" title="5">}</a>
<a class="sourceLine" id="cb42-6" title="6"><span class="kw">print</span>(formula_model_full)</a></code></pre></div>
<pre><code>## [1] &quot;reactivity ~ sequence + index_sequence + structure + predicted_loop_type + seq_be + seq_af + struct_be + struct_af + loop_type_be + loop_type_af + bpps_0 + bpps_1 + bpps_2 + bpps_3 + bpps_4 + bpps_5 + bpps_6 + bpps_7 + bpps_8 + bpps_9 + bpps_10 + bpps_11 + bpps_12 + bpps_13 + bpps_14 + bpps_15 + bpps_16 + bpps_17 + bpps_18 + bpps_19 + bpps_20 + bpps_21 + bpps_22 + bpps_23 + bpps_24 + bpps_25 + bpps_26 + bpps_27 + bpps_28 + bpps_29 + bpps_30 + bpps_31 + bpps_32 + bpps_33 + bpps_34 + bpps_35 + bpps_36 + bpps_37 + bpps_38 + bpps_39 + bpps_40 + bpps_41 + bpps_42 + bpps_43 + bpps_44 + bpps_45 + bpps_46 + bpps_47 + bpps_48 + bpps_49 + bpps_50 + bpps_51 + bpps_52 + bpps_53 + bpps_54 + bpps_55 + bpps_56 + bpps_57 + bpps_58 + bpps_59 + bpps_60 + bpps_61 + bpps_62 + bpps_63 + bpps_64 + bpps_65 + bpps_66 + bpps_67 + bpps_68 + bpps_69 + bpps_70 + bpps_71 + bpps_72 + bpps_73 + bpps_74 + bpps_75 + bpps_76 + bpps_77 + bpps_78 + bpps_79 + bpps_80 + bpps_81 + bpps_82 + bpps_83 + bpps_84 + bpps_85 + bpps_86 + bpps_87 + bpps_88 + bpps_89 + bpps_90 + bpps_91 + bpps_92 + bpps_93 + bpps_94 + bpps_95 + bpps_96 + bpps_97 + bpps_98 + bpps_99 + bpps_100 + bpps_101 + bpps_102 + bpps_103 + bpps_104 + bpps_105 + bpps_106&quot;</code></pre>
<div id="reactivity" class="section level2">
<h2>Reactivity</h2>
<div id="premier-modèle" class="section level3">
<h3>Premier modèle</h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">formula_gamma_reactivity =<span class="st"> </span>formula_model_full</a></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">model_gamma_reactivity =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_gamma_reactivity,</a>
<a class="sourceLine" id="cb45-2" title="2">                             <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="kw">summary</span>(model_gamma_reactivity)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = formula_gamma_reactivity, family = Gamma, data = data_train)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.51817  -0.22337  -0.06782   0.12456   3.00792  
## 
## Coefficients: (7 not defined because of singularities)
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           0.7989229  0.0090485  88.294  &lt; 2e-16 ***
## sequenceC             0.2703951  0.0059384  45.533  &lt; 2e-16 ***
## sequenceG            -0.0702891  0.0037986 -18.504  &lt; 2e-16 ***
## sequenceU            -0.0788956  0.0047472 -16.619  &lt; 2e-16 ***
## index_sequence        0.0063617  0.0001042  61.046  &lt; 2e-16 ***
## structure)           -0.0002012  0.0100481  -0.020 0.984022    
## structure.           -0.1436545  0.0129620 -11.083  &lt; 2e-16 ***
## predicted_loop_typeE  0.1320690  0.0231440   5.706 1.16e-08 ***
## predicted_loop_typeH  0.1919257  0.0143698  13.356  &lt; 2e-16 ***
## predicted_loop_typeI  0.2831076  0.0128925  21.959  &lt; 2e-16 ***
## predicted_loop_typeM  0.1810543  0.0177310  10.211  &lt; 2e-16 ***
## predicted_loop_typeS         NA         NA      NA       NA    
## predicted_loop_typeX  0.1618593  0.0210956   7.673 1.70e-14 ***
## seq_beC               0.0124317  0.0047704   2.606 0.009161 ** 
## seq_beG              -0.0955972  0.0036577 -26.136  &lt; 2e-16 ***
## seq_beO              -0.1791055  0.0218148  -8.210 2.24e-16 ***
## seq_beU              -0.0957504  0.0046825 -20.448  &lt; 2e-16 ***
## seq_afC               0.3715125  0.0053188  69.849  &lt; 2e-16 ***
## seq_afG               0.4209183  0.0049139  85.658  &lt; 2e-16 ***
## seq_afO               0.0883727  0.0185190   4.772 1.83e-06 ***
## seq_afU              -0.1162642  0.0041155 -28.250  &lt; 2e-16 ***
## struct_be)            0.0055618  0.0078210   0.711 0.477004    
## struct_be.           -0.0368872  0.0121773  -3.029 0.002453 ** 
## struct_beO                   NA         NA      NA       NA    
## struct_af)           -0.1096620  0.0081422 -13.468  &lt; 2e-16 ***
## struct_af.           -0.1965876  0.0116368 -16.894  &lt; 2e-16 ***
## struct_afO                   NA         NA      NA       NA    
## loop_type_beE         0.0045766  0.0211292   0.217 0.828519    
## loop_type_beH        -0.0045547  0.0133169  -0.342 0.732331    
## loop_type_beI        -0.0479460  0.0134202  -3.573 0.000354 ***
## loop_type_beM        -0.0244848  0.0165647  -1.478 0.139376    
## loop_type_beO                NA         NA      NA       NA    
## loop_type_beS                NA         NA      NA       NA    
## loop_type_beX        -0.0037208  0.0186243  -0.200 0.841653    
## loop_type_afE         0.2034528  0.0159674  12.742  &lt; 2e-16 ***
## loop_type_afH        -0.0452086  0.0132560  -3.410 0.000649 ***
## loop_type_afI         0.0539473  0.0127563   4.229 2.35e-05 ***
## loop_type_afM        -0.0131955  0.0161361  -0.818 0.413494    
## loop_type_afO                NA         NA      NA       NA    
## loop_type_afS                NA         NA      NA       NA    
## loop_type_afX        -0.0191197  0.0185535  -1.031 0.302771    
## bpps_0                1.4307370  0.2293105   6.239 4.42e-10 ***
## bpps_1                1.8499347  0.2617513   7.068 1.59e-12 ***
## bpps_2                0.1286824  0.2637094   0.488 0.625572    
## bpps_3                1.6518813  0.3275784   5.043 4.60e-07 ***
## bpps_4                0.6703695  0.2390895   2.804 0.005051 ** 
## bpps_5                0.5965273  0.0347556  17.163  &lt; 2e-16 ***
## bpps_6                0.7495353  0.0315413  23.764  &lt; 2e-16 ***
## bpps_7                0.8469023  0.0301926  28.050  &lt; 2e-16 ***
## bpps_8                0.8343332  0.0288075  28.962  &lt; 2e-16 ***
## bpps_9                0.9561525  0.0304889  31.361  &lt; 2e-16 ***
## bpps_10               0.8859270  0.0281033  31.524  &lt; 2e-16 ***
## bpps_11               0.9495781  0.0305737  31.059  &lt; 2e-16 ***
## bpps_12               0.9178562  0.0306744  29.923  &lt; 2e-16 ***
## bpps_13               0.8835467  0.0311431  28.371  &lt; 2e-16 ***
## bpps_14               0.9808834  0.0334649  29.311  &lt; 2e-16 ***
## bpps_15               0.9007171  0.0335768  26.826  &lt; 2e-16 ***
## bpps_16               0.8892810  0.0334893  26.554  &lt; 2e-16 ***
## bpps_17               0.8645905  0.0294863  29.322  &lt; 2e-16 ***
## bpps_18               0.8409426  0.0295459  28.462  &lt; 2e-16 ***
## bpps_19               0.8832841  0.0302888  29.162  &lt; 2e-16 ***
## bpps_20               1.0106499  0.0306622  32.961  &lt; 2e-16 ***
## bpps_21               0.9558724  0.0296198  32.271  &lt; 2e-16 ***
## bpps_22               0.9746255  0.0293452  33.212  &lt; 2e-16 ***
## bpps_23               0.9054551  0.0304699  29.716  &lt; 2e-16 ***
## bpps_24               0.8627111  0.0297398  29.009  &lt; 2e-16 ***
## bpps_25               0.8879407  0.0301741  29.427  &lt; 2e-16 ***
## bpps_26               0.9125527  0.0297762  30.647  &lt; 2e-16 ***
## bpps_27               0.9274502  0.0305430  30.365  &lt; 2e-16 ***
## bpps_28               0.9156497  0.0300466  30.474  &lt; 2e-16 ***
## bpps_29               1.0297723  0.0309696  33.251  &lt; 2e-16 ***
## bpps_30               1.0505855  0.0306824  34.241  &lt; 2e-16 ***
## bpps_31               0.9810940  0.0299421  32.766  &lt; 2e-16 ***
## bpps_32               0.9641271  0.0300659  32.067  &lt; 2e-16 ***
## bpps_33               1.0015369  0.0313892  31.907  &lt; 2e-16 ***
## bpps_34               0.8401679  0.0332296  25.284  &lt; 2e-16 ***
## bpps_35               0.8023917  0.0345468  23.226  &lt; 2e-16 ***
## bpps_36               0.7106755  0.0312162  22.766  &lt; 2e-16 ***
## bpps_37               0.7249111  0.0324249  22.357  &lt; 2e-16 ***
## bpps_38               0.7685107  0.0289843  26.515  &lt; 2e-16 ***
## bpps_39               0.8087168  0.0302332  26.749  &lt; 2e-16 ***
## bpps_40               0.8937376  0.0294279  30.370  &lt; 2e-16 ***
## bpps_41               1.0141207  0.0296769  34.172  &lt; 2e-16 ***
## bpps_42               1.0398283  0.0306909  33.881  &lt; 2e-16 ***
## bpps_43               0.9601583  0.0303863  31.598  &lt; 2e-16 ***
## bpps_44               0.8926553  0.0300452  29.710  &lt; 2e-16 ***
## bpps_45               0.9216535  0.0312409  29.501  &lt; 2e-16 ***
## bpps_46               0.8993284  0.0318855  28.205  &lt; 2e-16 ***
## bpps_47               0.9218051  0.0304502  30.273  &lt; 2e-16 ***
## bpps_48               0.8318666  0.0288687  28.816  &lt; 2e-16 ***
## bpps_49               0.6766232  0.0266405  25.398  &lt; 2e-16 ***
## bpps_50               0.9046436  0.0285034  31.738  &lt; 2e-16 ***
## bpps_51               0.9236830  0.0310031  29.793  &lt; 2e-16 ***
## bpps_52               0.9244072  0.0299246  30.891  &lt; 2e-16 ***
## bpps_53               1.0837204  0.0328207  33.019  &lt; 2e-16 ***
## bpps_54               0.9873968  0.0307706  32.089  &lt; 2e-16 ***
## bpps_55               0.9644849  0.0336182  28.689  &lt; 2e-16 ***
## bpps_56               1.0482980  0.0335206  31.273  &lt; 2e-16 ***
## bpps_57               0.8845200  0.0302148  29.274  &lt; 2e-16 ***
## bpps_58               1.0230625  0.0323066  31.667  &lt; 2e-16 ***
## bpps_59               0.9707645  0.0315033  30.815  &lt; 2e-16 ***
## bpps_60               0.9413354  0.0311214  30.247  &lt; 2e-16 ***
## bpps_61               0.9781072  0.0295256  33.127  &lt; 2e-16 ***
## bpps_62               1.0464553  0.0297392  35.188  &lt; 2e-16 ***
## bpps_63               1.1061364  0.0303412  36.457  &lt; 2e-16 ***
## bpps_64               1.0387091  0.0306323  33.909  &lt; 2e-16 ***
## bpps_65               1.0358927  0.0333542  31.057  &lt; 2e-16 ***
## bpps_66               0.9458616  0.0354178  26.706  &lt; 2e-16 ***
## bpps_67               0.8462472  0.0446314  18.961  &lt; 2e-16 ***
## bpps_68               0.3798108  0.1585748   2.395 0.016616 *  
## bpps_69               0.6681696  0.1714272   3.898 9.72e-05 ***
## bpps_70               0.5908460  0.1653453   3.573 0.000353 ***
## bpps_71               0.6344805  0.1691765   3.750 0.000177 ***
## bpps_72               0.7674234  0.1862643   4.120 3.79e-05 ***
## bpps_73               0.7581880  0.1893805   4.004 6.25e-05 ***
## bpps_74               0.6916896  0.1724192   4.012 6.03e-05 ***
## bpps_75               0.6805143  0.1758890   3.869 0.000109 ***
## bpps_76               1.0547971  0.1543099   6.836 8.22e-12 ***
## bpps_77               0.8699627  0.1418368   6.134 8.63e-10 ***
## bpps_78               1.4506684  0.2721420   5.331 9.82e-08 ***
## bpps_79               1.8264153  0.2576450   7.089 1.36e-12 ***
## bpps_80               0.3398083  0.1928548   1.762 0.078075 .  
## bpps_81               1.0733204  0.2277634   4.712 2.45e-06 ***
## bpps_82               0.4352459  0.2003204   2.173 0.029802 *  
## bpps_83               0.8083729  0.2054904   3.934 8.37e-05 ***
## bpps_84               0.6411063  0.2335089   2.746 0.006043 ** 
## bpps_85               0.5180261  0.2691994   1.924 0.054318 .  
## bpps_86               0.2787287  0.2837606   0.982 0.325971    
## bpps_87               0.0660257  0.1878564   0.351 0.725238    
## bpps_88               0.6591123  0.2923211   2.255 0.024151 *  
## bpps_89               0.3902584  0.2604050   1.499 0.133966    
## bpps_90               0.9562840  0.2608179   3.666 0.000246 ***
## bpps_91               0.6834267  0.3017541   2.265 0.023525 *  
## bpps_92               0.2763969  0.3511860   0.787 0.431261    
## bpps_93               0.0020363  0.3324581   0.006 0.995113    
## bpps_94              -0.1817153  0.2192374  -0.829 0.407191    
## bpps_95              -0.9328767  0.4646679  -2.008 0.044687 *  
## bpps_96               1.4153022  0.8143840   1.738 0.082235 .  
## bpps_97               0.7196925  0.4855390   1.482 0.138276    
## bpps_98               1.1436696  1.1727836   0.975 0.329476    
## bpps_99               2.5874159  1.2813900   2.019 0.043467 *  
## bpps_100              1.0424018  0.7578113   1.376 0.168967    
## bpps_101              1.6873105  1.7068059   0.989 0.322873    
## bpps_102             -1.8255209  1.3328189  -1.370 0.170794    
## bpps_103             -1.6660246  0.6775823  -2.459 0.013943 *  
## bpps_104             -0.8962370  1.5301051  -0.586 0.558055    
## bpps_105              3.1935082  1.0489279   3.045 0.002331 ** 
## bpps_106              0.9023737  0.5005205   1.803 0.071412 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.1195312)
## 
##     Null deviance: 22756.3  on 86427  degrees of freedom
## Residual deviance:  8631.1  on 86287  degrees of freedom
## AIC: -21726
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Il est important de noter que le premier modèle n’est pas de plein rang, donc on ne peut pas se fier à ses prédictions. <br> Cependant, la pénalisation va nous aider à résoudre ce problème.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1">y_pred_gamma_train =<span class="st"> </span><span class="kw">predict.glm</span>(model_gamma_reactivity,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">error_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_gamma_train<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb50-2" title="2"><span class="kw">print</span>(error_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1003965</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">y_pred_gamma_val=<span class="kw">predict.glm</span>(model_gamma_reactivity,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">error_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_gamma_val<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb54-2" title="2"><span class="kw">print</span>(error_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.09457003</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1">models_reactivity &lt;-<span class="st"> </span><span class="kw">c</span>(models_reactivity, <span class="st">&quot;model_gamma&quot;</span>)</a>
<a class="sourceLine" id="cb56-2" title="2">errors_reactivity_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_reactivity_train, error_gamma_train)</a>
<a class="sourceLine" id="cb56-3" title="3">errors_reactivity_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_reactivity_val, error_gamma_val)</a>
<a class="sourceLine" id="cb56-4" title="4"><span class="kw">rm</span>(error_gamma_val, error_gamma_train, y_pred_gamma_train, y_pred_gamma_val)</a></code></pre></div>
</div>
<div id="pénalisation-ridge-et-lasso" class="section level3">
<h3>Pénalisation ridge et lasso</h3>
<p>On commence par calculer la matrice de design du model_gamma_reactivity sur le train et le test.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="co"># Matrice de design du train</span></a>
<a class="sourceLine" id="cb57-2" title="2">data_train_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_gamma_reactivity)</a>
<a class="sourceLine" id="cb57-3" title="3"><span class="co">#head(data_train_pen)</span></a></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="co"># Pour faire la matrice de design de la validation</span></a>
<a class="sourceLine" id="cb58-2" title="2">model_gamma_reactivity_val =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_gamma_reactivity,</a>
<a class="sourceLine" id="cb58-3" title="3">                                 <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_val)</a>
<a class="sourceLine" id="cb58-4" title="4">data_val_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_gamma_reactivity_val)</a>
<a class="sourceLine" id="cb58-5" title="5"><span class="co">#head(data_val_pen)</span></a>
<a class="sourceLine" id="cb58-6" title="6"></a>
<a class="sourceLine" id="cb58-7" title="7"><span class="co"># On supprime le modèle sur le test</span></a>
<a class="sourceLine" id="cb58-8" title="8"><span class="kw">rm</span>(model_gamma_reactivity_val)</a></code></pre></div>
<p>On pénalise le model_gamma_reactivity avec une pénalité ridge. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="co">#model_gamma_reactivity_pen_ridge = cv.glmnet(data_train_pen, data_train$reactivity,</span></a>
<a class="sourceLine" id="cb59-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb59-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 0)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="co">#saveRDS(model_gamma_reactivity_pen_ridge, &quot;model_gamma_reactivity_pen_ridge.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1">model_gamma_reactivity_pen_ridge &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_reactivity_pen_ridge.rds&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="kw">coef</span>(model_gamma_reactivity_pen_ridge, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a></code></pre></div>
<pre><code>## 149 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                                  1
## (Intercept)           1.131997e+00
## (Intercept)           .           
## sequenceC             1.092069e-01
## sequenceG            -1.251589e-02
## sequenceU            -7.764206e-03
## index_sequence        6.054725e-03
## structure)            3.433330e-02
## structure.           -1.387760e-01
## predicted_loop_typeE -1.391079e-02
## predicted_loop_typeH -5.742942e-02
## predicted_loop_typeI -8.490645e-03
## predicted_loop_typeM -1.724869e-02
## predicted_loop_typeS  1.387732e-01
## predicted_loop_typeX -1.590327e-02
## seq_beC               1.716513e-02
## seq_beG              -2.989344e-02
## seq_beO               2.107439e-03
## seq_beU              -9.141579e-03
## seq_afC               9.305379e-02
## seq_afG               1.229697e-01
## seq_afO               1.963176e-04
## seq_afU              -6.177416e-02
## struct_be)            5.926710e-03
## struct_be.           -5.322567e-02
## struct_beO            2.107565e-03
## struct_af)            1.407269e-02
## struct_af.           -9.883593e-02
## struct_afO            1.976215e-04
## loop_type_beE        -9.893403e-03
## loop_type_beH        -2.569145e-02
## loop_type_beI         4.342078e-03
## loop_type_beM        -6.200713e-03
## loop_type_beO         2.105814e-03
## loop_type_beS         5.117682e-02
## loop_type_beX        -7.936471e-03
## loop_type_afE        -1.261174e-02
## loop_type_afH        -4.761606e-02
## loop_type_afI         7.448559e-03
## loop_type_afM        -1.494188e-02
## loop_type_afO         1.984509e-04
## loop_type_afS         9.866054e-02
## loop_type_afX        -1.575323e-02
## bpps_0                6.113747e-04
## bpps_1                6.540906e-04
## bpps_2                5.681058e-05
## bpps_3               -1.323372e-05
## bpps_4               -6.073548e-05
## bpps_5               -2.359021e-04
## bpps_6                1.282908e-03
## bpps_7                1.894983e-03
## bpps_8                2.081640e-03
## bpps_9                2.350767e-03
## bpps_10               1.546999e-03
## bpps_11               2.348355e-03
## bpps_12               2.478245e-03
## bpps_13               1.581178e-03
## bpps_14               2.049435e-03
## bpps_15               1.623478e-03
## bpps_16               1.849073e-03
## bpps_17               2.753242e-03
## bpps_18               2.153050e-03
## bpps_19               2.299189e-03
## bpps_20               3.366101e-03
## bpps_21               3.169552e-03
## bpps_22               3.245854e-03
## bpps_23               2.544931e-03
## bpps_24               2.497844e-03
## bpps_25               2.194241e-03
## bpps_26               2.709063e-03
## bpps_27               3.118877e-03
## bpps_28               2.724108e-03
## bpps_29               3.265335e-03
## bpps_30               3.766411e-03
## bpps_31               3.585053e-03
## bpps_32               3.513981e-03
## bpps_33               3.232874e-03
## bpps_34               1.767102e-03
## bpps_35               1.072937e-03
## bpps_36               1.067094e-03
## bpps_37               1.418378e-03
## bpps_38               1.983115e-03
## bpps_39               2.384085e-03
## bpps_40               3.313554e-03
## bpps_41               4.137752e-03
## bpps_42               4.474343e-03
## bpps_43               3.558695e-03
## bpps_44               2.305919e-03
## bpps_45               2.662475e-03
## bpps_46               2.739209e-03
## bpps_47               3.474511e-03
## bpps_48               2.702417e-03
## bpps_49               1.399674e-03
## bpps_50               3.755902e-03
## bpps_51               3.302010e-03
## bpps_52               3.376895e-03
## bpps_53               4.195834e-03
## bpps_54               3.925328e-03
## bpps_55               3.544721e-03
## bpps_56               4.122848e-03
## bpps_57               3.286566e-03
## bpps_58               4.310278e-03
## bpps_59               4.181418e-03
## bpps_60               4.156686e-03
## bpps_61               4.467471e-03
## bpps_62               5.544370e-03
## bpps_63               5.965052e-03
## bpps_64               5.031839e-03
## bpps_65               4.539318e-03
## bpps_66               3.070369e-03
## bpps_67               1.820699e-03
## bpps_68               4.418807e-05
## bpps_69               1.258931e-04
## bpps_70               6.945698e-05
## bpps_71               6.455272e-05
## bpps_72               8.223914e-05
## bpps_73               6.280199e-05
## bpps_74               9.490309e-05
## bpps_75               1.543722e-04
## bpps_76               4.101719e-05
## bpps_77              -1.068780e-05
## bpps_78               3.467939e-04
## bpps_79               2.739750e-04
## bpps_80               5.932315e-05
## bpps_81               1.586115e-04
## bpps_82               5.150375e-05
## bpps_83               1.041495e-04
## bpps_84               7.784638e-05
## bpps_85               4.243034e-05
## bpps_86              -3.072178e-05
## bpps_87              -1.427159e-04
## bpps_88              -5.081126e-05
## bpps_89              -7.726210e-05
## bpps_90               2.513214e-04
## bpps_91               1.003522e-04
## bpps_92              -6.482203e-05
## bpps_93              -1.809083e-05
## bpps_94              -3.562111e-04
## bpps_95               2.541286e-05
## bpps_96               2.120703e-05
## bpps_97              -2.390984e-04
## bpps_98               4.511840e-05
## bpps_99               3.378565e-05
## bpps_100             -2.272094e-04
## bpps_101              4.245791e-05
## bpps_102              2.052178e-05
## bpps_103             -2.196701e-04
## bpps_104              2.504217e-05
## bpps_105             -9.801447e-06
## bpps_106             -7.905410e-05</code></pre>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation ridge.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">y_pred_ridge_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_reactivity_pen_ridge, data_train_pen,</a>
<a class="sourceLine" id="cb64-2" title="2">                                   <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb64-3" title="3">y_pred_ridge_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_reactivity_pen_ridge, data_val_pen,</a>
<a class="sourceLine" id="cb64-4" title="4">                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb64-5" title="5">error_ridge_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_ridge_gamma_train<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb64-6" title="6"><span class="kw">print</span>(error_ridge_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1305383</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">error_ridge_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_ridge_gamma_val<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb66-2" title="2"><span class="kw">print</span>(error_ridge_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1259877</code></pre>
<p>On pénalise le model_gamma_reactivity avec une pénalité lasso. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="co">#model_gamma_reactivity_pen_lasso = cv.glmnet(data_train_pen, data_train$reactivity,</span></a>
<a class="sourceLine" id="cb68-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb68-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 1)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="co">#saveRDS(model_gamma_reactivity_pen_lasso, &quot;model_gamma_reactivity_pen_lasso.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1">model_gamma_reactivity_pen_lasso &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_reactivity_pen_lasso.rds&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="kw">coef</span>(model_gamma_reactivity_pen_lasso, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a></code></pre></div>
<pre><code>## 149 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                                  1
## (Intercept)           1.2190900706
## (Intercept)           .           
## sequenceC             0.3828464426
## sequenceG            -0.0114938606
## sequenceU            -0.0159051370
## index_sequence        0.0065696401
## structure)            .           
## structure.           -0.5013744436
## predicted_loop_typeE  0.0400821223
## predicted_loop_typeH  0.0659682414
## predicted_loop_typeI  0.1935514337
## predicted_loop_typeM  0.0892727481
## predicted_loop_typeS  0.0126135466
## predicted_loop_typeX  0.0680701055
## seq_beC               0.0291748558
## seq_beG              -0.0778138772
## seq_beO              -0.1508466667
## seq_beU              -0.0779285725
## seq_afC               0.4119949848
## seq_afG               0.4398971678
## seq_afO               0.0135377587
## seq_afU              -0.0878355149
## struct_be)            0.0132672877
## struct_be.            .           
## struct_beO           -0.0027646494
## struct_af)           -0.1036611974
## struct_af.           -0.2538968960
## struct_afO            .           
## loop_type_beE         0.0017619068
## loop_type_beH         0.0243161277
## loop_type_beI        -0.0435676626
## loop_type_beM         0.0055025511
## loop_type_beO        -0.0014610557
## loop_type_beS         0.0636622008
## loop_type_beX         0.0406785149
## loop_type_afE         0.2446562373
## loop_type_afH         .           
## loop_type_afI         0.0719811309
## loop_type_afM         0.0157781289
## loop_type_afO         0.0009056162
## loop_type_afS         .           
## loop_type_afX         .           
## bpps_0                .           
## bpps_1                .           
## bpps_2                .           
## bpps_3                .           
## bpps_4                .           
## bpps_5                .           
## bpps_6                .           
## bpps_7                0.0666286459
## bpps_8                0.0815939142
## bpps_9                0.2113199833
## bpps_10               0.1452360723
## bpps_11               0.1860289784
## bpps_12               0.1638929574
## bpps_13               0.1141937023
## bpps_14               0.1913708301
## bpps_15               0.1135497024
## bpps_16               0.0918501163
## bpps_17               0.1138293275
## bpps_18               0.1009320060
## bpps_19               0.1271857990
## bpps_20               0.2572137143
## bpps_21               0.2091219539
## bpps_22               0.2294340418
## bpps_23               0.1449880127
## bpps_24               0.1096263965
## bpps_25               0.1279927306
## bpps_26               0.1570650757
## bpps_27               0.1738641394
## bpps_28               0.1661845673
## bpps_29               0.2718534772
## bpps_30               0.2987654429
## bpps_31               0.2221899823
## bpps_32               0.2017688615
## bpps_33               0.2325210144
## bpps_34               0.0625906194
## bpps_35               0.0331205738
## bpps_36               .           
## bpps_37               .           
## bpps_38               0.0278452181
## bpps_39               0.0600347186
## bpps_40               0.1685168341
## bpps_41               0.2867190408
## bpps_42               0.2882889017
## bpps_43               0.2031917940
## bpps_44               0.1381919376
## bpps_45               0.1761656451
## bpps_46               0.1522506913
## bpps_47               0.1782641429
## bpps_48               0.1009917547
## bpps_49               .           
## bpps_50               0.1750744920
## bpps_51               0.1673164426
## bpps_52               0.1875042114
## bpps_53               0.3154761385
## bpps_54               0.2390083996
## bpps_55               0.1850927298
## bpps_56               0.2837411423
## bpps_57               0.1619416764
## bpps_58               0.2612565609
## bpps_59               0.2225455625
## bpps_60               0.2098697556
## bpps_61               0.2394610514
## bpps_62               0.3075086805
## bpps_63               0.3568634625
## bpps_64               0.2985393900
## bpps_65               0.2668877198
## bpps_66               0.1373414078
## bpps_67               .           
## bpps_68               .           
## bpps_69               .           
## bpps_70               .           
## bpps_71               .           
## bpps_72               .           
## bpps_73               .           
## bpps_74               .           
## bpps_75               .           
## bpps_76               .           
## bpps_77               .           
## bpps_78               .           
## bpps_79               .           
## bpps_80               .           
## bpps_81               .           
## bpps_82               .           
## bpps_83               .           
## bpps_84               .           
## bpps_85               .           
## bpps_86               .           
## bpps_87               .           
## bpps_88               .           
## bpps_89               .           
## bpps_90               .           
## bpps_91               .           
## bpps_92               .           
## bpps_93               .           
## bpps_94               .           
## bpps_95               .           
## bpps_96               .           
## bpps_97               .           
## bpps_98               .           
## bpps_99               .           
## bpps_100              .           
## bpps_101              .           
## bpps_102              .           
## bpps_103              .           
## bpps_104              .           
## bpps_105              .           
## bpps_106              .</code></pre>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation lasso.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1">y_pred_lasso_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_reactivity_pen_lasso, data_train_pen,</a>
<a class="sourceLine" id="cb73-2" title="2">                                   <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb73-3" title="3">error_lasso_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_lasso_gamma_train<span class="op">-</span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb73-4" title="4"><span class="kw">print</span>(error_lasso_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1067232</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1">y_pred_lasso_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_reactivity_pen_lasso, data_val_pen,</a>
<a class="sourceLine" id="cb75-2" title="2">                                 <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb75-3" title="3">error_lasso_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_lasso_gamma_val<span class="op">-</span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb75-4" title="4"><span class="kw">print</span>(error_lasso_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1013946</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1">models_reactivity &lt;-<span class="st"> </span><span class="kw">c</span>(models_reactivity, <span class="st">&quot;model_gamma_ridge&quot;</span>, <span class="st">&quot;model_gamma_lasso&quot;</span>)</a>
<a class="sourceLine" id="cb77-2" title="2">errors_reactivity_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_reactivity_train, error_ridge_gamma_train,</a>
<a class="sourceLine" id="cb77-3" title="3">                             error_lasso_gamma_train)</a>
<a class="sourceLine" id="cb77-4" title="4">errors_reactivity_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_reactivity_val, error_ridge_gamma_val, error_lasso_gamma_val)</a>
<a class="sourceLine" id="cb77-5" title="5"><span class="kw">rm</span>(error_ridge_gamma_val, error_lasso_gamma_val,</a>
<a class="sourceLine" id="cb77-6" title="6">   error_ridge_gamma_train, error_lasso_gamma_train,</a>
<a class="sourceLine" id="cb77-7" title="7">   y_pred_ridge_gamma_train, y_pred_ridge_gamma_val,</a>
<a class="sourceLine" id="cb77-8" title="8">   y_pred_lasso_gamma_train, y_pred_lasso_gamma_val)</a></code></pre></div>
</div>
<div id="pénalisation-elastic-net" class="section level3">
<h3>Pénalisation elastic-net</h3>
<p>On choisit <span class="math inline">\(\alpha\)</span> qui minimise le MSE sur la validation.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="co">#alpha_opti_enet_gamma_reactivity =</span></a>
<a class="sourceLine" id="cb78-2" title="2"><span class="co">#  alpha_opti_enet(data_train = data_train_pen, data_val = data_val_pen,</span></a>
<a class="sourceLine" id="cb78-3" title="3"><span class="co">#                  y_true_train = data_train$reactivity,</span></a>
<a class="sourceLine" id="cb78-4" title="4"><span class="co">#                  y_true_val = data_val$reactivity,</span></a>
<a class="sourceLine" id="cb78-5" title="5"><span class="co">#                  family = Gamma)</span></a></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="co">#print(alpha_opti_enet_gamma_reactivity)</span></a></code></pre></div>
<p>On construit le modèle avec le choix optimal pour <span class="math inline">\(\alpha\)</span>.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="co">#model_gamma_reactivity_pen_enet = cv.glmnet(data_train_pen, data_train$reactivity,</span></a>
<a class="sourceLine" id="cb80-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb80-3" title="3"><span class="co">#                                             standardize = FALSE,</span></a>
<a class="sourceLine" id="cb80-4" title="4"><span class="co">#                                             alpha = alpha_opti_enet_gamma_reactivity)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="co">#saveRDS(model_gamma_reactivity_pen_enet, &quot;model_gamma_reactivity_pen_enet.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1">model_gamma_reactivity_pen_enet &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_reactivity_pen_enet.rds&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="kw">coef</span>(model_gamma_reactivity_pen_enet, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a></code></pre></div>
<pre><code>## 149 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                                  1
## (Intercept)           1.2190900706
## (Intercept)           .           
## sequenceC             0.3828464426
## sequenceG            -0.0114938606
## sequenceU            -0.0159051370
## index_sequence        0.0065696401
## structure)            .           
## structure.           -0.5013744436
## predicted_loop_typeE  0.0400821223
## predicted_loop_typeH  0.0659682414
## predicted_loop_typeI  0.1935514337
## predicted_loop_typeM  0.0892727481
## predicted_loop_typeS  0.0126135466
## predicted_loop_typeX  0.0680701055
## seq_beC               0.0291748558
## seq_beG              -0.0778138772
## seq_beO              -0.1508466667
## seq_beU              -0.0779285725
## seq_afC               0.4119949848
## seq_afG               0.4398971678
## seq_afO               0.0135377587
## seq_afU              -0.0878355149
## struct_be)            0.0132672877
## struct_be.            .           
## struct_beO           -0.0027646494
## struct_af)           -0.1036611974
## struct_af.           -0.2538968960
## struct_afO            .           
## loop_type_beE         0.0017619068
## loop_type_beH         0.0243161277
## loop_type_beI        -0.0435676626
## loop_type_beM         0.0055025511
## loop_type_beO        -0.0014610557
## loop_type_beS         0.0636622008
## loop_type_beX         0.0406785149
## loop_type_afE         0.2446562373
## loop_type_afH         .           
## loop_type_afI         0.0719811309
## loop_type_afM         0.0157781289
## loop_type_afO         0.0009056162
## loop_type_afS         .           
## loop_type_afX         .           
## bpps_0                .           
## bpps_1                .           
## bpps_2                .           
## bpps_3                .           
## bpps_4                .           
## bpps_5                .           
## bpps_6                .           
## bpps_7                0.0666286459
## bpps_8                0.0815939142
## bpps_9                0.2113199833
## bpps_10               0.1452360723
## bpps_11               0.1860289784
## bpps_12               0.1638929574
## bpps_13               0.1141937023
## bpps_14               0.1913708301
## bpps_15               0.1135497024
## bpps_16               0.0918501163
## bpps_17               0.1138293275
## bpps_18               0.1009320060
## bpps_19               0.1271857990
## bpps_20               0.2572137143
## bpps_21               0.2091219539
## bpps_22               0.2294340418
## bpps_23               0.1449880127
## bpps_24               0.1096263965
## bpps_25               0.1279927306
## bpps_26               0.1570650757
## bpps_27               0.1738641394
## bpps_28               0.1661845673
## bpps_29               0.2718534772
## bpps_30               0.2987654429
## bpps_31               0.2221899823
## bpps_32               0.2017688615
## bpps_33               0.2325210144
## bpps_34               0.0625906194
## bpps_35               0.0331205738
## bpps_36               .           
## bpps_37               .           
## bpps_38               0.0278452181
## bpps_39               0.0600347186
## bpps_40               0.1685168341
## bpps_41               0.2867190408
## bpps_42               0.2882889017
## bpps_43               0.2031917940
## bpps_44               0.1381919376
## bpps_45               0.1761656451
## bpps_46               0.1522506913
## bpps_47               0.1782641429
## bpps_48               0.1009917547
## bpps_49               .           
## bpps_50               0.1750744920
## bpps_51               0.1673164426
## bpps_52               0.1875042114
## bpps_53               0.3154761385
## bpps_54               0.2390083996
## bpps_55               0.1850927298
## bpps_56               0.2837411423
## bpps_57               0.1619416764
## bpps_58               0.2612565609
## bpps_59               0.2225455625
## bpps_60               0.2098697556
## bpps_61               0.2394610514
## bpps_62               0.3075086805
## bpps_63               0.3568634625
## bpps_64               0.2985393900
## bpps_65               0.2668877198
## bpps_66               0.1373414078
## bpps_67               .           
## bpps_68               .           
## bpps_69               .           
## bpps_70               .           
## bpps_71               .           
## bpps_72               .           
## bpps_73               .           
## bpps_74               .           
## bpps_75               .           
## bpps_76               .           
## bpps_77               .           
## bpps_78               .           
## bpps_79               .           
## bpps_80               .           
## bpps_81               .           
## bpps_82               .           
## bpps_83               .           
## bpps_84               .           
## bpps_85               .           
## bpps_86               .           
## bpps_87               .           
## bpps_88               .           
## bpps_89               .           
## bpps_90               .           
## bpps_91               .           
## bpps_92               .           
## bpps_93               .           
## bpps_94               .           
## bpps_95               .           
## bpps_96               .           
## bpps_97               .           
## bpps_98               .           
## bpps_99               .           
## bpps_100              .           
## bpps_101              .           
## bpps_102              .           
## bpps_103              .           
## bpps_104              .           
## bpps_105              .           
## bpps_106              .</code></pre>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation elastic-net.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1">y_pred_enet_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_reactivity_pen_enet, data_train_pen,</a>
<a class="sourceLine" id="cb85-2" title="2">                                   <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb85-3" title="3">error_enet_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_enet_gamma_train <span class="op">-</span><span class="st"> </span>data_train<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb85-4" title="4"><span class="kw">print</span>(error_enet_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1067232</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1">y_pred_enet_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_reactivity_pen_enet, data_val_pen,</a>
<a class="sourceLine" id="cb87-2" title="2">                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb87-3" title="3">error_enet_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_enet_gamma_val <span class="op">-</span><span class="st"> </span>data_val<span class="op">$</span>reactivity)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb87-4" title="4"><span class="kw">print</span>(error_enet_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1013946</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1">models_reactivity &lt;-<span class="st"> </span><span class="kw">c</span>(models_reactivity, <span class="st">&quot;model_gamma_enet&quot;</span>)</a>
<a class="sourceLine" id="cb89-2" title="2">errors_reactivity_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_reactivity_train, error_enet_gamma_train)</a>
<a class="sourceLine" id="cb89-3" title="3">errors_reactivity_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_reactivity_val, error_enet_gamma_val)</a>
<a class="sourceLine" id="cb89-4" title="4"><span class="kw">rm</span>(error_enet_gamma_train, error_enet_gamma_val,</a>
<a class="sourceLine" id="cb89-5" title="5">   y_pred_enet_gamma_train, y_pred_enet_gamma_val)</a></code></pre></div>
</div>
<div id="récapitulatif-des-résultats" class="section level3">
<h3>Récapitulatif des résultats</h3>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1">models_reactivity_errors_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(models_reactivity,</a>
<a class="sourceLine" id="cb90-2" title="2">                                          errors_reactivity_train,</a>
<a class="sourceLine" id="cb90-3" title="3">                                          errors_reactivity_val)</a></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1">models_reactivity_errors_df</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["models_reactivity"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_reactivity_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_reactivity_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma","2":"0.1003965","3":"0.09457003"},{"1":"model_gamma_ridge","2":"0.1305383","3":"0.12598769"},{"1":"model_gamma_lasso","2":"0.1067232","3":"0.10139463"},{"1":"model_gamma_enet","2":"0.1067232","3":"0.10139463"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Le meilleur modèle (au sens de la minimisation du MSE sur la validation) est le <code>model_gamma_lasso</code> (si on exclut le premier modèle qui n’était pas de plein rang).</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1">models_reactivity_errors_df[<span class="kw">which.min</span>(errors_reactivity_val[<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, ]</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["models_reactivity"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_reactivity_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_reactivity_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma_lasso","2":"0.1067232","3":"0.1013946","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="deg_mg_ph10" class="section level2">
<h2>deg_Mg_pH10</h2>
<div id="premier-modèle-1" class="section level3">
<h3>Premier modèle</h3>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">formula_gamma_deg_Mg_pH10 =<span class="st"> </span>formula_model_full</a></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1">model_gamma_deg_Mg_pH10 =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_gamma_deg_Mg_pH10,</a>
<a class="sourceLine" id="cb94-2" title="2">                             <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a></code></pre></div>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">summary</span>(model_gamma_deg_Mg_pH10)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = formula_gamma_deg_Mg_pH10, family = Gamma, data = data_train)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.51817  -0.22337  -0.06782   0.12456   3.00792  
## 
## Coefficients: (7 not defined because of singularities)
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           0.7989229  0.0090485  88.294  &lt; 2e-16 ***
## sequenceC             0.2703951  0.0059384  45.533  &lt; 2e-16 ***
## sequenceG            -0.0702891  0.0037986 -18.504  &lt; 2e-16 ***
## sequenceU            -0.0788956  0.0047472 -16.619  &lt; 2e-16 ***
## index_sequence        0.0063617  0.0001042  61.046  &lt; 2e-16 ***
## structure)           -0.0002012  0.0100481  -0.020 0.984022    
## structure.           -0.1436545  0.0129620 -11.083  &lt; 2e-16 ***
## predicted_loop_typeE  0.1320690  0.0231440   5.706 1.16e-08 ***
## predicted_loop_typeH  0.1919257  0.0143698  13.356  &lt; 2e-16 ***
## predicted_loop_typeI  0.2831076  0.0128925  21.959  &lt; 2e-16 ***
## predicted_loop_typeM  0.1810543  0.0177310  10.211  &lt; 2e-16 ***
## predicted_loop_typeS         NA         NA      NA       NA    
## predicted_loop_typeX  0.1618593  0.0210956   7.673 1.70e-14 ***
## seq_beC               0.0124317  0.0047704   2.606 0.009161 ** 
## seq_beG              -0.0955972  0.0036577 -26.136  &lt; 2e-16 ***
## seq_beO              -0.1791055  0.0218148  -8.210 2.24e-16 ***
## seq_beU              -0.0957504  0.0046825 -20.448  &lt; 2e-16 ***
## seq_afC               0.3715125  0.0053188  69.849  &lt; 2e-16 ***
## seq_afG               0.4209183  0.0049139  85.658  &lt; 2e-16 ***
## seq_afO               0.0883727  0.0185190   4.772 1.83e-06 ***
## seq_afU              -0.1162642  0.0041155 -28.250  &lt; 2e-16 ***
## struct_be)            0.0055618  0.0078210   0.711 0.477004    
## struct_be.           -0.0368872  0.0121773  -3.029 0.002453 ** 
## struct_beO                   NA         NA      NA       NA    
## struct_af)           -0.1096620  0.0081422 -13.468  &lt; 2e-16 ***
## struct_af.           -0.1965876  0.0116368 -16.894  &lt; 2e-16 ***
## struct_afO                   NA         NA      NA       NA    
## loop_type_beE         0.0045766  0.0211292   0.217 0.828519    
## loop_type_beH        -0.0045547  0.0133169  -0.342 0.732331    
## loop_type_beI        -0.0479460  0.0134202  -3.573 0.000354 ***
## loop_type_beM        -0.0244848  0.0165647  -1.478 0.139376    
## loop_type_beO                NA         NA      NA       NA    
## loop_type_beS                NA         NA      NA       NA    
## loop_type_beX        -0.0037208  0.0186243  -0.200 0.841653    
## loop_type_afE         0.2034528  0.0159674  12.742  &lt; 2e-16 ***
## loop_type_afH        -0.0452086  0.0132560  -3.410 0.000649 ***
## loop_type_afI         0.0539473  0.0127563   4.229 2.35e-05 ***
## loop_type_afM        -0.0131955  0.0161361  -0.818 0.413494    
## loop_type_afO                NA         NA      NA       NA    
## loop_type_afS                NA         NA      NA       NA    
## loop_type_afX        -0.0191197  0.0185535  -1.031 0.302771    
## bpps_0                1.4307370  0.2293105   6.239 4.42e-10 ***
## bpps_1                1.8499347  0.2617513   7.068 1.59e-12 ***
## bpps_2                0.1286824  0.2637094   0.488 0.625572    
## bpps_3                1.6518813  0.3275784   5.043 4.60e-07 ***
## bpps_4                0.6703695  0.2390895   2.804 0.005051 ** 
## bpps_5                0.5965273  0.0347556  17.163  &lt; 2e-16 ***
## bpps_6                0.7495353  0.0315413  23.764  &lt; 2e-16 ***
## bpps_7                0.8469023  0.0301926  28.050  &lt; 2e-16 ***
## bpps_8                0.8343332  0.0288075  28.962  &lt; 2e-16 ***
## bpps_9                0.9561525  0.0304889  31.361  &lt; 2e-16 ***
## bpps_10               0.8859270  0.0281033  31.524  &lt; 2e-16 ***
## bpps_11               0.9495781  0.0305737  31.059  &lt; 2e-16 ***
## bpps_12               0.9178562  0.0306744  29.923  &lt; 2e-16 ***
## bpps_13               0.8835467  0.0311431  28.371  &lt; 2e-16 ***
## bpps_14               0.9808834  0.0334649  29.311  &lt; 2e-16 ***
## bpps_15               0.9007171  0.0335768  26.826  &lt; 2e-16 ***
## bpps_16               0.8892810  0.0334893  26.554  &lt; 2e-16 ***
## bpps_17               0.8645905  0.0294863  29.322  &lt; 2e-16 ***
## bpps_18               0.8409426  0.0295459  28.462  &lt; 2e-16 ***
## bpps_19               0.8832841  0.0302888  29.162  &lt; 2e-16 ***
## bpps_20               1.0106499  0.0306622  32.961  &lt; 2e-16 ***
## bpps_21               0.9558724  0.0296198  32.271  &lt; 2e-16 ***
## bpps_22               0.9746255  0.0293452  33.212  &lt; 2e-16 ***
## bpps_23               0.9054551  0.0304699  29.716  &lt; 2e-16 ***
## bpps_24               0.8627111  0.0297398  29.009  &lt; 2e-16 ***
## bpps_25               0.8879407  0.0301741  29.427  &lt; 2e-16 ***
## bpps_26               0.9125527  0.0297762  30.647  &lt; 2e-16 ***
## bpps_27               0.9274502  0.0305430  30.365  &lt; 2e-16 ***
## bpps_28               0.9156497  0.0300466  30.474  &lt; 2e-16 ***
## bpps_29               1.0297723  0.0309696  33.251  &lt; 2e-16 ***
## bpps_30               1.0505855  0.0306824  34.241  &lt; 2e-16 ***
## bpps_31               0.9810940  0.0299421  32.766  &lt; 2e-16 ***
## bpps_32               0.9641271  0.0300659  32.067  &lt; 2e-16 ***
## bpps_33               1.0015369  0.0313892  31.907  &lt; 2e-16 ***
## bpps_34               0.8401679  0.0332296  25.284  &lt; 2e-16 ***
## bpps_35               0.8023917  0.0345468  23.226  &lt; 2e-16 ***
## bpps_36               0.7106755  0.0312162  22.766  &lt; 2e-16 ***
## bpps_37               0.7249111  0.0324249  22.357  &lt; 2e-16 ***
## bpps_38               0.7685107  0.0289843  26.515  &lt; 2e-16 ***
## bpps_39               0.8087168  0.0302332  26.749  &lt; 2e-16 ***
## bpps_40               0.8937376  0.0294279  30.370  &lt; 2e-16 ***
## bpps_41               1.0141207  0.0296769  34.172  &lt; 2e-16 ***
## bpps_42               1.0398283  0.0306909  33.881  &lt; 2e-16 ***
## bpps_43               0.9601583  0.0303863  31.598  &lt; 2e-16 ***
## bpps_44               0.8926553  0.0300452  29.710  &lt; 2e-16 ***
## bpps_45               0.9216535  0.0312409  29.501  &lt; 2e-16 ***
## bpps_46               0.8993284  0.0318855  28.205  &lt; 2e-16 ***
## bpps_47               0.9218051  0.0304502  30.273  &lt; 2e-16 ***
## bpps_48               0.8318666  0.0288687  28.816  &lt; 2e-16 ***
## bpps_49               0.6766232  0.0266405  25.398  &lt; 2e-16 ***
## bpps_50               0.9046436  0.0285034  31.738  &lt; 2e-16 ***
## bpps_51               0.9236830  0.0310031  29.793  &lt; 2e-16 ***
## bpps_52               0.9244072  0.0299246  30.891  &lt; 2e-16 ***
## bpps_53               1.0837204  0.0328207  33.019  &lt; 2e-16 ***
## bpps_54               0.9873968  0.0307706  32.089  &lt; 2e-16 ***
## bpps_55               0.9644849  0.0336182  28.689  &lt; 2e-16 ***
## bpps_56               1.0482980  0.0335206  31.273  &lt; 2e-16 ***
## bpps_57               0.8845200  0.0302148  29.274  &lt; 2e-16 ***
## bpps_58               1.0230625  0.0323066  31.667  &lt; 2e-16 ***
## bpps_59               0.9707645  0.0315033  30.815  &lt; 2e-16 ***
## bpps_60               0.9413354  0.0311214  30.247  &lt; 2e-16 ***
## bpps_61               0.9781072  0.0295256  33.127  &lt; 2e-16 ***
## bpps_62               1.0464553  0.0297392  35.188  &lt; 2e-16 ***
## bpps_63               1.1061364  0.0303412  36.457  &lt; 2e-16 ***
## bpps_64               1.0387091  0.0306323  33.909  &lt; 2e-16 ***
## bpps_65               1.0358927  0.0333542  31.057  &lt; 2e-16 ***
## bpps_66               0.9458616  0.0354178  26.706  &lt; 2e-16 ***
## bpps_67               0.8462472  0.0446314  18.961  &lt; 2e-16 ***
## bpps_68               0.3798108  0.1585748   2.395 0.016616 *  
## bpps_69               0.6681696  0.1714272   3.898 9.72e-05 ***
## bpps_70               0.5908460  0.1653453   3.573 0.000353 ***
## bpps_71               0.6344805  0.1691765   3.750 0.000177 ***
## bpps_72               0.7674234  0.1862643   4.120 3.79e-05 ***
## bpps_73               0.7581880  0.1893805   4.004 6.25e-05 ***
## bpps_74               0.6916896  0.1724192   4.012 6.03e-05 ***
## bpps_75               0.6805143  0.1758890   3.869 0.000109 ***
## bpps_76               1.0547971  0.1543099   6.836 8.22e-12 ***
## bpps_77               0.8699627  0.1418368   6.134 8.63e-10 ***
## bpps_78               1.4506684  0.2721420   5.331 9.82e-08 ***
## bpps_79               1.8264153  0.2576450   7.089 1.36e-12 ***
## bpps_80               0.3398083  0.1928548   1.762 0.078075 .  
## bpps_81               1.0733204  0.2277634   4.712 2.45e-06 ***
## bpps_82               0.4352459  0.2003204   2.173 0.029802 *  
## bpps_83               0.8083729  0.2054904   3.934 8.37e-05 ***
## bpps_84               0.6411063  0.2335089   2.746 0.006043 ** 
## bpps_85               0.5180261  0.2691994   1.924 0.054318 .  
## bpps_86               0.2787287  0.2837606   0.982 0.325971    
## bpps_87               0.0660257  0.1878564   0.351 0.725238    
## bpps_88               0.6591123  0.2923211   2.255 0.024151 *  
## bpps_89               0.3902584  0.2604050   1.499 0.133966    
## bpps_90               0.9562840  0.2608179   3.666 0.000246 ***
## bpps_91               0.6834267  0.3017541   2.265 0.023525 *  
## bpps_92               0.2763969  0.3511860   0.787 0.431261    
## bpps_93               0.0020363  0.3324581   0.006 0.995113    
## bpps_94              -0.1817153  0.2192374  -0.829 0.407191    
## bpps_95              -0.9328767  0.4646679  -2.008 0.044687 *  
## bpps_96               1.4153022  0.8143840   1.738 0.082235 .  
## bpps_97               0.7196925  0.4855390   1.482 0.138276    
## bpps_98               1.1436696  1.1727836   0.975 0.329476    
## bpps_99               2.5874159  1.2813900   2.019 0.043467 *  
## bpps_100              1.0424018  0.7578113   1.376 0.168967    
## bpps_101              1.6873105  1.7068059   0.989 0.322873    
## bpps_102             -1.8255209  1.3328189  -1.370 0.170794    
## bpps_103             -1.6660246  0.6775823  -2.459 0.013943 *  
## bpps_104             -0.8962370  1.5301051  -0.586 0.558055    
## bpps_105              3.1935082  1.0489279   3.045 0.002331 ** 
## bpps_106              0.9023737  0.5005205   1.803 0.071412 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.1195312)
## 
##     Null deviance: 22756.3  on 86427  degrees of freedom
## Residual deviance:  8631.1  on 86287  degrees of freedom
## AIC: -21726
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Il est important de noter que le premier modèle n’est pas de plein rang, donc on ne peut pas se fier à ses prédictions. <br> Cependant, la pénalisation va nous aider à résoudre ce problème.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1">y_pred_gamma_train =<span class="st"> </span><span class="kw">predict.glm</span>(model_gamma_deg_Mg_pH10,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1">error_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb99-2" title="2"><span class="kw">print</span>(error_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1984995</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1">y_pred_gamma_val=<span class="kw">predict.glm</span>(model_gamma_deg_Mg_pH10,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1">error_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb103-2" title="2"><span class="kw">print</span>(error_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.2006945</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1">models_deg_Mg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_Mg_pH10, <span class="st">&quot;model_gamma&quot;</span>)</a>
<a class="sourceLine" id="cb105-2" title="2">errors_deg_Mg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_pH10_train, error_gamma_train)</a>
<a class="sourceLine" id="cb105-3" title="3">errors_deg_Mg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_pH10_val, error_gamma_val)</a>
<a class="sourceLine" id="cb105-4" title="4"><span class="kw">rm</span>(error_gamma_val, error_gamma_train, y_pred_gamma_train, y_pred_gamma_val)</a></code></pre></div>
</div>
<div id="pénalisation-ridge-et-lasso-1" class="section level3">
<h3>Pénalisation ridge et lasso</h3>
<p>On commence par calculer la matrice de design du model_gamma_deg_Mg_pH10 sur le train et le test.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1"><span class="co"># Matrice de design du train</span></a>
<a class="sourceLine" id="cb106-2" title="2">data_train_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_gamma_deg_Mg_pH10)</a>
<a class="sourceLine" id="cb106-3" title="3"><span class="co">#head(data_train_pen)</span></a></code></pre></div>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"><span class="co"># Pour faire la matrice de design de la validation</span></a>
<a class="sourceLine" id="cb107-2" title="2">model_gamma_deg_Mg_pH10_val =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_gamma_deg_Mg_pH10,</a>
<a class="sourceLine" id="cb107-3" title="3">                                 <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_val)</a>
<a class="sourceLine" id="cb107-4" title="4">data_val_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_gamma_deg_Mg_pH10_val)</a>
<a class="sourceLine" id="cb107-5" title="5"><span class="co">#head(data_val_pen)</span></a>
<a class="sourceLine" id="cb107-6" title="6"></a>
<a class="sourceLine" id="cb107-7" title="7"><span class="co"># On supprime le modèle sur le test</span></a>
<a class="sourceLine" id="cb107-8" title="8"><span class="kw">rm</span>(model_gamma_deg_Mg_pH10_val)</a></code></pre></div>
<p>On pénalise le model_gamma_deg_Mg_pH10 avec une pénalité ridge. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1"><span class="co">#model_gamma_deg_Mg_pH10_pen_ridge = cv.glmnet(data_train_pen, data_train$deg_Mg_pH10,</span></a>
<a class="sourceLine" id="cb108-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb108-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 0)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1"><span class="co">#saveRDS(model_gamma_deg_Mg_pH10_pen_ridge, &quot;model_gamma_deg_Mg_pH10_pen_ridge.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1">model_gamma_deg_Mg_pH10_pen_ridge &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_Mg_pH10_pen_ridge.rds&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1"><span class="kw">coef</span>(model_gamma_deg_Mg_pH10_pen_ridge, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a></code></pre></div>
<pre><code>## 149 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                                  1
## (Intercept)           1.201268e+00
## (Intercept)           .           
## sequenceC             5.518306e-02
## sequenceG            -8.584922e-02
## sequenceU            -1.497388e-02
## index_sequence        5.309832e-03
## structure)           -2.123368e-03
## structure.           -1.155488e-01
## predicted_loop_typeE -1.718833e-02
## predicted_loop_typeH -1.920003e-02
## predicted_loop_typeI  1.567693e-02
## predicted_loop_typeM -2.897769e-02
## predicted_loop_typeS  1.156135e-01
## predicted_loop_typeX -3.750195e-02
## seq_beC               4.370565e-02
## seq_beG              -3.851519e-02
## seq_beO              -5.571494e-04
## seq_beU              -2.620602e-02
## seq_afC               1.283913e-01
## seq_afG               1.718547e-01
## seq_afO              -2.402464e-02
## seq_afU              -1.955863e-01
## struct_be)           -3.441963e-02
## struct_be.           -6.200072e-02
## struct_beO           -5.563948e-04
## struct_af)            1.578980e-03
## struct_af.           -6.772133e-02
## struct_afO           -2.402304e-02
## loop_type_beE        -1.221944e-02
## loop_type_beH        -1.725505e-02
## loop_type_beI         1.373002e-02
## loop_type_beM        -1.369227e-02
## loop_type_beO        -5.590590e-04
## loop_type_beS         6.258045e-02
## loop_type_beX        -2.054503e-02
## loop_type_afE        -5.296066e-03
## loop_type_afH        -1.508798e-03
## loop_type_afI         1.264509e-02
## loop_type_afM        -2.337034e-02
## loop_type_afO        -2.402273e-02
## loop_type_afS         9.169936e-02
## loop_type_afX        -2.918218e-02
## bpps_0                3.668243e-04
## bpps_1                3.955171e-04
## bpps_2                1.181320e-04
## bpps_3               -4.410168e-05
## bpps_4               -1.219581e-04
## bpps_5               -5.039599e-03
## bpps_6               -3.739566e-03
## bpps_7               -1.447318e-03
## bpps_8                8.367947e-05
## bpps_9                2.076749e-04
## bpps_10               1.277826e-03
## bpps_11               1.452944e-03
## bpps_12              -5.626370e-05
## bpps_13               5.454844e-04
## bpps_14               1.919435e-03
## bpps_15               2.121169e-03
## bpps_16               2.572767e-03
## bpps_17               2.395009e-03
## bpps_18               2.411751e-03
## bpps_19               2.811783e-03
## bpps_20               3.789148e-03
## bpps_21               4.910912e-03
## bpps_22               1.844092e-03
## bpps_23               2.998877e-03
## bpps_24               4.003298e-03
## bpps_25               1.740967e-03
## bpps_26               2.314644e-03
## bpps_27               3.432741e-03
## bpps_28               3.532745e-03
## bpps_29               3.679550e-03
## bpps_30               4.338878e-03
## bpps_31               4.543000e-03
## bpps_32               4.647174e-03
## bpps_33               3.367762e-03
## bpps_34               1.943519e-03
## bpps_35               2.008674e-03
## bpps_36               1.123085e-03
## bpps_37               1.927683e-03
## bpps_38               3.760417e-03
## bpps_39               2.759836e-03
## bpps_40               4.187985e-03
## bpps_41               3.884721e-03
## bpps_42               4.893681e-03
## bpps_43               3.741308e-03
## bpps_44               1.768770e-03
## bpps_45               2.570191e-03
## bpps_46               2.001306e-03
## bpps_47               2.125587e-03
## bpps_48               2.838298e-03
## bpps_49               3.739482e-03
## bpps_50               4.548795e-03
## bpps_51               3.020917e-03
## bpps_52               4.502726e-03
## bpps_53               3.520117e-03
## bpps_54               4.691680e-03
## bpps_55               3.941743e-03
## bpps_56               4.736144e-03
## bpps_57               4.020034e-03
## bpps_58               4.901007e-03
## bpps_59               3.516411e-03
## bpps_60               4.601570e-03
## bpps_61               4.278957e-03
## bpps_62               6.219167e-03
## bpps_63               5.141799e-03
## bpps_64               5.112717e-03
## bpps_65               3.884642e-03
## bpps_66               1.950562e-03
## bpps_67               2.309994e-04
## bpps_68              -1.790631e-04
## bpps_69              -1.327468e-05
## bpps_70               5.988083e-06
## bpps_71               4.242944e-05
## bpps_72               1.681317e-06
## bpps_73               8.652801e-06
## bpps_74              -7.882138e-05
## bpps_75               2.629421e-04
## bpps_76               3.487673e-04
## bpps_77              -2.447200e-04
## bpps_78               2.964779e-04
## bpps_79               2.049606e-04
## bpps_80               6.726510e-05
## bpps_81               1.461178e-04
## bpps_82               1.709018e-05
## bpps_83              -2.309685e-05
## bpps_84              -8.982485e-05
## bpps_85              -9.066104e-05
## bpps_86              -9.271032e-05
## bpps_87              -3.007832e-04
## bpps_88              -2.074114e-04
## bpps_89              -3.429342e-04
## bpps_90              -3.634452e-04
## bpps_91               2.438599e-05
## bpps_92              -3.026131e-04
## bpps_93              -2.829415e-04
## bpps_94              -1.284758e-03
## bpps_95               8.406000e-06
## bpps_96              -3.529551e-05
## bpps_97              -1.123820e-03
## bpps_98               4.417827e-05
## bpps_99              -1.177468e-05
## bpps_100             -9.450804e-04
## bpps_101              5.463976e-05
## bpps_102              6.140876e-06
## bpps_103             -8.656702e-04
## bpps_104              4.552145e-05
## bpps_105             -4.261041e-06
## bpps_106             -3.497220e-04</code></pre>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation ridge.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1">y_pred_ridge_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_pH10_pen_ridge, data_train_pen,</a>
<a class="sourceLine" id="cb113-2" title="2">                                   <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb113-3" title="3">y_pred_ridge_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_pH10_pen_ridge, data_val_pen,</a>
<a class="sourceLine" id="cb113-4" title="4">                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb113-5" title="5">error_ridge_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_ridge_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb113-6" title="6"><span class="kw">print</span>(error_ridge_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.2025919</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1">error_ridge_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_ridge_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb115-2" title="2"><span class="kw">print</span>(error_ridge_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.208533</code></pre>
<p>On pénalise le model_gamma_deg_Mg_pH10 avec une pénalité lasso. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="co">#model_gamma_deg_Mg_pH10_pen_lasso = cv.glmnet(data_train_pen, data_train$deg_Mg_pH10,</span></a>
<a class="sourceLine" id="cb117-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb117-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 1)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1"><span class="co">#saveRDS(model_gamma_deg_Mg_pH10_pen_lasso, &quot;model_gamma_deg_Mg_pH10_pen_lasso.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1">model_gamma_deg_Mg_pH10_pen_lasso &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_Mg_pH10_pen_lasso.rds&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1"><span class="kw">coef</span>(model_gamma_deg_Mg_pH10_pen_lasso, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a></code></pre></div>
<pre><code>## 149 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                                  1
## (Intercept)           1.054890e+00
## (Intercept)           .           
## sequenceC             1.972492e-02
## sequenceG            -2.523481e-01
## sequenceU            -1.443288e-01
## index_sequence        7.333754e-03
## structure)           -5.566499e-02
## structure.           -3.966540e-01
## predicted_loop_typeE -4.025082e-04
## predicted_loop_typeH  1.471351e-01
## predicted_loop_typeI  3.216844e-01
## predicted_loop_typeM  4.365418e-02
## predicted_loop_typeS  6.996614e-03
## predicted_loop_typeX  .           
## seq_beC               8.963471e-02
## seq_beG              -8.971466e-02
## seq_beO              -1.151424e-01
## seq_beU              -9.557125e-02
## seq_afC               4.237900e-01
## seq_afG               4.971623e-01
## seq_afO              -2.055824e-01
## seq_afU              -3.617618e-01
## struct_be)           -1.318682e-01
## struct_be.            .           
## struct_beO           -3.000429e-05
## struct_af)           -8.134554e-02
## struct_af.            .           
## struct_afO           -7.975137e-03
## loop_type_beE         7.221163e-03
## loop_type_beH        -2.863578e-02
## loop_type_beI        -1.057653e-02
## loop_type_beM         1.413950e-02
## loop_type_beO        -2.100487e-03
## loop_type_beS         1.568985e-01
## loop_type_beX         6.073669e-02
## loop_type_afE         2.869650e-01
## loop_type_afH         7.979656e-02
## loop_type_afI         2.656013e-04
## loop_type_afM         3.045196e-03
## loop_type_afO        -3.113070e-03
## loop_type_afS         1.886447e-01
## loop_type_afX        -4.395123e-02
## bpps_0                .           
## bpps_1                .           
## bpps_2                .           
## bpps_3                .           
## bpps_4                .           
## bpps_5               -9.734083e-03
## bpps_6                .           
## bpps_7                8.377063e-02
## bpps_8                1.264558e-01
## bpps_9                1.902197e-01
## bpps_10               3.152342e-01
## bpps_11               3.258821e-01
## bpps_12               2.133965e-01
## bpps_13               2.571336e-01
## bpps_14               3.579894e-01
## bpps_15               3.401208e-01
## bpps_16               3.444683e-01
## bpps_17               2.893769e-01
## bpps_18               2.672620e-01
## bpps_19               3.235957e-01
## bpps_20               3.854543e-01
## bpps_21               4.583586e-01
## bpps_22               3.203931e-01
## bpps_23               3.590007e-01
## bpps_24               3.901713e-01
## bpps_25               2.720587e-01
## bpps_26               3.117366e-01
## bpps_27               3.213186e-01
## bpps_28               3.717521e-01
## bpps_29               4.132102e-01
## bpps_30               4.560906e-01
## bpps_31               4.174433e-01
## bpps_32               4.337353e-01
## bpps_33               3.929578e-01
## bpps_34               2.506604e-01
## bpps_35               3.206495e-01
## bpps_36               1.613640e-01
## bpps_37               1.693354e-01
## bpps_38               3.233643e-01
## bpps_39               2.085897e-01
## bpps_40               3.242912e-01
## bpps_41               3.161661e-01
## bpps_42               3.806413e-01
## bpps_43               3.310832e-01
## bpps_44               2.414995e-01
## bpps_45               2.682690e-01
## bpps_46               1.957268e-01
## bpps_47               1.838823e-01
## bpps_48               2.323021e-01
## bpps_49               2.743232e-01
## bpps_50               3.388051e-01
## bpps_51               2.097785e-01
## bpps_52               3.482479e-01
## bpps_53               3.136121e-01
## bpps_54               3.944451e-01
## bpps_55               3.016504e-01
## bpps_56               4.002354e-01
## bpps_57               3.121775e-01
## bpps_58               3.709023e-01
## bpps_59               2.501142e-01
## bpps_60               2.879339e-01
## bpps_61               2.984785e-01
## bpps_62               3.834421e-01
## bpps_63               3.525637e-01
## bpps_64               3.404795e-01
## bpps_65               2.805847e-01
## bpps_66               1.728824e-01
## bpps_67               6.645540e-02
## bpps_68               .           
## bpps_69               .           
## bpps_70               .           
## bpps_71               .           
## bpps_72               .           
## bpps_73               .           
## bpps_74               .           
## bpps_75               .           
## bpps_76               .           
## bpps_77               .           
## bpps_78               .           
## bpps_79               .           
## bpps_80               .           
## bpps_81               .           
## bpps_82               .           
## bpps_83               .           
## bpps_84               .           
## bpps_85               .           
## bpps_86               .           
## bpps_87               .           
## bpps_88               .           
## bpps_89               .           
## bpps_90               .           
## bpps_91               .           
## bpps_92               .           
## bpps_93               .           
## bpps_94               .           
## bpps_95               .           
## bpps_96               .           
## bpps_97               .           
## bpps_98               .           
## bpps_99               .           
## bpps_100              .           
## bpps_101              .           
## bpps_102              .           
## bpps_103              .           
## bpps_104              .           
## bpps_105              .           
## bpps_106              .</code></pre>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation lasso.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1">y_pred_lasso_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_pH10_pen_lasso, data_train_pen,</a>
<a class="sourceLine" id="cb122-2" title="2">                                   <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb122-3" title="3">error_lasso_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_lasso_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb122-4" title="4"><span class="kw">print</span>(error_lasso_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1792721</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1">y_pred_lasso_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_pH10_pen_lasso, data_val_pen,</a>
<a class="sourceLine" id="cb124-2" title="2">                                 <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb124-3" title="3">error_lasso_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_lasso_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb124-4" title="4"><span class="kw">print</span>(error_lasso_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1769066</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1">models_deg_Mg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_Mg_pH10, <span class="st">&quot;model_gamma_ridge&quot;</span>, <span class="st">&quot;model_gamma_lasso&quot;</span>)</a>
<a class="sourceLine" id="cb126-2" title="2">errors_deg_Mg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_pH10_train, error_ridge_gamma_train,</a>
<a class="sourceLine" id="cb126-3" title="3">                             error_lasso_gamma_train)</a>
<a class="sourceLine" id="cb126-4" title="4">errors_deg_Mg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_pH10_val, error_ridge_gamma_val, error_lasso_gamma_val)</a>
<a class="sourceLine" id="cb126-5" title="5"><span class="kw">rm</span>(error_ridge_gamma_val, error_lasso_gamma_val,</a>
<a class="sourceLine" id="cb126-6" title="6">   error_ridge_gamma_train, error_lasso_gamma_train,</a>
<a class="sourceLine" id="cb126-7" title="7">   y_pred_ridge_gamma_train, y_pred_ridge_gamma_val,</a>
<a class="sourceLine" id="cb126-8" title="8">   y_pred_lasso_gamma_train, y_pred_lasso_gamma_val)</a></code></pre></div>
</div>
<div id="pénalisation-elastic-net-1" class="section level3">
<h3>Pénalisation elastic-net</h3>
<p>On choisit <span class="math inline">\(\alpha\)</span> qui minimise le MSE sur la validation.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1"><span class="co">#alpha_opti_enet_gamma_deg_Mg_pH10 =</span></a>
<a class="sourceLine" id="cb127-2" title="2"><span class="co">#  alpha_opti_enet(data_train = data_train_pen, data_val = data_val_pen,</span></a>
<a class="sourceLine" id="cb127-3" title="3"><span class="co">#                  y_true_train = data_train$deg_Mg_pH10,</span></a>
<a class="sourceLine" id="cb127-4" title="4"><span class="co">#                  y_true_val = data_val$deg_Mg_pH10,</span></a>
<a class="sourceLine" id="cb127-5" title="5"><span class="co">#                  family = Gamma)</span></a></code></pre></div>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1"><span class="co">#print(alpha_opti_enet_gamma_deg_Mg_pH10)</span></a></code></pre></div>
<p>On construit le modèle avec le choix optimal pour <span class="math inline">\(\alpha\)</span>.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1"><span class="co">#model_gamma_deg_Mg_pH10_pen_enet = cv.glmnet(data_train_pen, data_train$deg_Mg_pH10,</span></a>
<a class="sourceLine" id="cb129-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb129-3" title="3"><span class="co">#                                             standardize = FALSE,</span></a>
<a class="sourceLine" id="cb129-4" title="4"><span class="co">#                                             alpha = alpha_opti_enet_gamma_deg_Mg_pH10)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1"><span class="co">#saveRDS(model_gamma_deg_Mg_pH10_pen_enet, &quot;model_gamma_deg_Mg_pH10_pen_enet.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1">model_gamma_deg_Mg_pH10_pen_enet &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_Mg_pH10_pen_enet.rds&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1"><span class="kw">coef</span>(model_gamma_deg_Mg_pH10_pen_enet, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a></code></pre></div>
<pre><code>## 149 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                                 1
## (Intercept)           1.079479557
## (Intercept)           .          
## sequenceC             0.044686377
## sequenceG            -0.221933036
## sequenceU            -0.098901392
## index_sequence        0.006615388
## structure)           -0.061871853
## structure.           -0.302209393
## predicted_loop_typeE  .          
## predicted_loop_typeH  .          
## predicted_loop_typeI  0.192321949
## predicted_loop_typeM  .          
## predicted_loop_typeS  0.191896727
## predicted_loop_typeX -0.019892752
## seq_beC               0.094597751
## seq_beG              -0.063002959
## seq_beO               .          
## seq_beU              -0.063217584
## seq_afC               0.408277733
## seq_afG               0.464455869
## seq_afO              -0.077024396
## seq_afU              -0.351592420
## struct_be)           -0.153170730
## struct_be.            .          
## struct_beO            .          
## struct_af)            .          
## struct_af.            .          
## struct_afO           -0.042520128
## loop_type_beE         .          
## loop_type_beH         .          
## loop_type_beI         .          
## loop_type_beM         .          
## loop_type_beO         .          
## loop_type_beS         0.165951414
## loop_type_beX         .          
## loop_type_afE         0.150679480
## loop_type_afH         0.084804258
## loop_type_afI         .          
## loop_type_afM         .          
## loop_type_afO        -0.018383762
## loop_type_afS         0.158006097
## loop_type_afX        -0.026378624
## bpps_0                .          
## bpps_1                .          
## bpps_2                .          
## bpps_3                .          
## bpps_4                .          
## bpps_5                .          
## bpps_6                .          
## bpps_7                .          
## bpps_8                .          
## bpps_9                .          
## bpps_10               .          
## bpps_11               .          
## bpps_12               .          
## bpps_13               .          
## bpps_14               .          
## bpps_15               .          
## bpps_16               .          
## bpps_17               .          
## bpps_18               .          
## bpps_19               .          
## bpps_20               .          
## bpps_21               .          
## bpps_22               .          
## bpps_23               .          
## bpps_24               .          
## bpps_25               .          
## bpps_26               .          
## bpps_27               .          
## bpps_28               .          
## bpps_29               .          
## bpps_30               .          
## bpps_31               .          
## bpps_32               .          
## bpps_33               .          
## bpps_34               .          
## bpps_35               .          
## bpps_36               .          
## bpps_37               .          
## bpps_38               .          
## bpps_39               .          
## bpps_40               .          
## bpps_41               .          
## bpps_42               .          
## bpps_43               .          
## bpps_44               .          
## bpps_45               .          
## bpps_46               .          
## bpps_47               .          
## bpps_48               .          
## bpps_49               .          
## bpps_50               .          
## bpps_51               .          
## bpps_52               .          
## bpps_53               .          
## bpps_54               .          
## bpps_55               .          
## bpps_56               .          
## bpps_57               .          
## bpps_58               .          
## bpps_59               .          
## bpps_60               .          
## bpps_61               .          
## bpps_62               .          
## bpps_63               .          
## bpps_64               .          
## bpps_65               .          
## bpps_66               .          
## bpps_67               .          
## bpps_68               .          
## bpps_69               .          
## bpps_70               .          
## bpps_71               .          
## bpps_72               .          
## bpps_73               .          
## bpps_74               .          
## bpps_75               .          
## bpps_76               .          
## bpps_77               .          
## bpps_78               .          
## bpps_79               .          
## bpps_80               .          
## bpps_81               .          
## bpps_82               .          
## bpps_83               .          
## bpps_84               .          
## bpps_85               .          
## bpps_86               .          
## bpps_87               .          
## bpps_88               .          
## bpps_89               .          
## bpps_90               .          
## bpps_91               .          
## bpps_92               .          
## bpps_93               .          
## bpps_94               .          
## bpps_95               .          
## bpps_96               .          
## bpps_97               .          
## bpps_98               .          
## bpps_99               .          
## bpps_100              .          
## bpps_101              .          
## bpps_102              .          
## bpps_103              .          
## bpps_104              .          
## bpps_105              .          
## bpps_106              .</code></pre>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation elastic-net.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1">y_pred_enet_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_pH10_pen_enet, data_train_pen,</a>
<a class="sourceLine" id="cb134-2" title="2">                                   <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb134-3" title="3">error_enet_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_enet_gamma_train <span class="op">-</span><span class="st"> </span>data_train<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb134-4" title="4"><span class="kw">print</span>(error_enet_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1810966</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1">y_pred_enet_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_pH10_pen_enet, data_val_pen,</a>
<a class="sourceLine" id="cb136-2" title="2">                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb136-3" title="3">error_enet_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_enet_gamma_val <span class="op">-</span><span class="st"> </span>data_val<span class="op">$</span>deg_Mg_pH10)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb136-4" title="4"><span class="kw">print</span>(error_enet_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1817245</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" title="1">models_deg_Mg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_Mg_pH10, <span class="st">&quot;model_gamma_enet&quot;</span>)</a>
<a class="sourceLine" id="cb138-2" title="2">errors_deg_Mg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_pH10_train, error_enet_gamma_train)</a>
<a class="sourceLine" id="cb138-3" title="3">errors_deg_Mg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_pH10_val, error_enet_gamma_val)</a>
<a class="sourceLine" id="cb138-4" title="4"><span class="kw">rm</span>(error_enet_gamma_train, error_enet_gamma_val,</a>
<a class="sourceLine" id="cb138-5" title="5">   y_pred_enet_gamma_train, y_pred_enet_gamma_val)</a></code></pre></div>
</div>
<div id="récapitulatif-des-résultats-1" class="section level3">
<h3>Récapitulatif des résultats</h3>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1">models_deg_Mg_pH10_errors_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(models_deg_Mg_pH10,</a>
<a class="sourceLine" id="cb139-2" title="2">                                          errors_deg_Mg_pH10_train,</a>
<a class="sourceLine" id="cb139-3" title="3">                                          errors_deg_Mg_pH10_val)</a></code></pre></div>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" title="1">models_deg_Mg_pH10_errors_df</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["models_deg_Mg_pH10"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_deg_Mg_pH10_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_deg_Mg_pH10_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma","2":"0.1984995","3":"0.2006945"},{"1":"model_gamma_ridge","2":"0.2025919","3":"0.2085330"},{"1":"model_gamma_lasso","2":"0.1792721","3":"0.1769066"},{"1":"model_gamma_enet","2":"0.1810966","3":"0.1817245"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Le meilleur modèle (au sens de la minimisation du MSE sur la validation) est le <code>model_gamma_lasso</code> (si on exclut le premier modèle qui n’était pas de plein rang).</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1">models_deg_Mg_pH10_errors_df[<span class="kw">which.min</span>(errors_deg_Mg_pH10_val[<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, ]</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["models_deg_Mg_pH10"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_deg_Mg_pH10_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_deg_Mg_pH10_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma_lasso","2":"0.1792721","3":"0.1769066","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="deg_ph10" class="section level2">
<h2>deg_pH10</h2>
<div id="premier-modèle-2" class="section level3">
<h3>Premier modèle</h3>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" title="1">formula_gamma_deg_pH10 =<span class="st"> </span>formula_model_full</a></code></pre></div>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1">model_gamma_deg_pH10 =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_gamma_deg_pH10,</a>
<a class="sourceLine" id="cb143-2" title="2">                             <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a></code></pre></div>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" title="1"><span class="kw">summary</span>(model_gamma_deg_pH10)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = formula_gamma_deg_pH10, family = Gamma, data = data_train)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.51817  -0.22337  -0.06782   0.12456   3.00792  
## 
## Coefficients: (7 not defined because of singularities)
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           0.7989229  0.0090485  88.294  &lt; 2e-16 ***
## sequenceC             0.2703951  0.0059384  45.533  &lt; 2e-16 ***
## sequenceG            -0.0702891  0.0037986 -18.504  &lt; 2e-16 ***
## sequenceU            -0.0788956  0.0047472 -16.619  &lt; 2e-16 ***
## index_sequence        0.0063617  0.0001042  61.046  &lt; 2e-16 ***
## structure)           -0.0002012  0.0100481  -0.020 0.984022    
## structure.           -0.1436545  0.0129620 -11.083  &lt; 2e-16 ***
## predicted_loop_typeE  0.1320690  0.0231440   5.706 1.16e-08 ***
## predicted_loop_typeH  0.1919257  0.0143698  13.356  &lt; 2e-16 ***
## predicted_loop_typeI  0.2831076  0.0128925  21.959  &lt; 2e-16 ***
## predicted_loop_typeM  0.1810543  0.0177310  10.211  &lt; 2e-16 ***
## predicted_loop_typeS         NA         NA      NA       NA    
## predicted_loop_typeX  0.1618593  0.0210956   7.673 1.70e-14 ***
## seq_beC               0.0124317  0.0047704   2.606 0.009161 ** 
## seq_beG              -0.0955972  0.0036577 -26.136  &lt; 2e-16 ***
## seq_beO              -0.1791055  0.0218148  -8.210 2.24e-16 ***
## seq_beU              -0.0957504  0.0046825 -20.448  &lt; 2e-16 ***
## seq_afC               0.3715125  0.0053188  69.849  &lt; 2e-16 ***
## seq_afG               0.4209183  0.0049139  85.658  &lt; 2e-16 ***
## seq_afO               0.0883727  0.0185190   4.772 1.83e-06 ***
## seq_afU              -0.1162642  0.0041155 -28.250  &lt; 2e-16 ***
## struct_be)            0.0055618  0.0078210   0.711 0.477004    
## struct_be.           -0.0368872  0.0121773  -3.029 0.002453 ** 
## struct_beO                   NA         NA      NA       NA    
## struct_af)           -0.1096620  0.0081422 -13.468  &lt; 2e-16 ***
## struct_af.           -0.1965876  0.0116368 -16.894  &lt; 2e-16 ***
## struct_afO                   NA         NA      NA       NA    
## loop_type_beE         0.0045766  0.0211292   0.217 0.828519    
## loop_type_beH        -0.0045547  0.0133169  -0.342 0.732331    
## loop_type_beI        -0.0479460  0.0134202  -3.573 0.000354 ***
## loop_type_beM        -0.0244848  0.0165647  -1.478 0.139376    
## loop_type_beO                NA         NA      NA       NA    
## loop_type_beS                NA         NA      NA       NA    
## loop_type_beX        -0.0037208  0.0186243  -0.200 0.841653    
## loop_type_afE         0.2034528  0.0159674  12.742  &lt; 2e-16 ***
## loop_type_afH        -0.0452086  0.0132560  -3.410 0.000649 ***
## loop_type_afI         0.0539473  0.0127563   4.229 2.35e-05 ***
## loop_type_afM        -0.0131955  0.0161361  -0.818 0.413494    
## loop_type_afO                NA         NA      NA       NA    
## loop_type_afS                NA         NA      NA       NA    
## loop_type_afX        -0.0191197  0.0185535  -1.031 0.302771    
## bpps_0                1.4307370  0.2293105   6.239 4.42e-10 ***
## bpps_1                1.8499347  0.2617513   7.068 1.59e-12 ***
## bpps_2                0.1286824  0.2637094   0.488 0.625572    
## bpps_3                1.6518813  0.3275784   5.043 4.60e-07 ***
## bpps_4                0.6703695  0.2390895   2.804 0.005051 ** 
## bpps_5                0.5965273  0.0347556  17.163  &lt; 2e-16 ***
## bpps_6                0.7495353  0.0315413  23.764  &lt; 2e-16 ***
## bpps_7                0.8469023  0.0301926  28.050  &lt; 2e-16 ***
## bpps_8                0.8343332  0.0288075  28.962  &lt; 2e-16 ***
## bpps_9                0.9561525  0.0304889  31.361  &lt; 2e-16 ***
## bpps_10               0.8859270  0.0281033  31.524  &lt; 2e-16 ***
## bpps_11               0.9495781  0.0305737  31.059  &lt; 2e-16 ***
## bpps_12               0.9178562  0.0306744  29.923  &lt; 2e-16 ***
## bpps_13               0.8835467  0.0311431  28.371  &lt; 2e-16 ***
## bpps_14               0.9808834  0.0334649  29.311  &lt; 2e-16 ***
## bpps_15               0.9007171  0.0335768  26.826  &lt; 2e-16 ***
## bpps_16               0.8892810  0.0334893  26.554  &lt; 2e-16 ***
## bpps_17               0.8645905  0.0294863  29.322  &lt; 2e-16 ***
## bpps_18               0.8409426  0.0295459  28.462  &lt; 2e-16 ***
## bpps_19               0.8832841  0.0302888  29.162  &lt; 2e-16 ***
## bpps_20               1.0106499  0.0306622  32.961  &lt; 2e-16 ***
## bpps_21               0.9558724  0.0296198  32.271  &lt; 2e-16 ***
## bpps_22               0.9746255  0.0293452  33.212  &lt; 2e-16 ***
## bpps_23               0.9054551  0.0304699  29.716  &lt; 2e-16 ***
## bpps_24               0.8627111  0.0297398  29.009  &lt; 2e-16 ***
## bpps_25               0.8879407  0.0301741  29.427  &lt; 2e-16 ***
## bpps_26               0.9125527  0.0297762  30.647  &lt; 2e-16 ***
## bpps_27               0.9274502  0.0305430  30.365  &lt; 2e-16 ***
## bpps_28               0.9156497  0.0300466  30.474  &lt; 2e-16 ***
## bpps_29               1.0297723  0.0309696  33.251  &lt; 2e-16 ***
## bpps_30               1.0505855  0.0306824  34.241  &lt; 2e-16 ***
## bpps_31               0.9810940  0.0299421  32.766  &lt; 2e-16 ***
## bpps_32               0.9641271  0.0300659  32.067  &lt; 2e-16 ***
## bpps_33               1.0015369  0.0313892  31.907  &lt; 2e-16 ***
## bpps_34               0.8401679  0.0332296  25.284  &lt; 2e-16 ***
## bpps_35               0.8023917  0.0345468  23.226  &lt; 2e-16 ***
## bpps_36               0.7106755  0.0312162  22.766  &lt; 2e-16 ***
## bpps_37               0.7249111  0.0324249  22.357  &lt; 2e-16 ***
## bpps_38               0.7685107  0.0289843  26.515  &lt; 2e-16 ***
## bpps_39               0.8087168  0.0302332  26.749  &lt; 2e-16 ***
## bpps_40               0.8937376  0.0294279  30.370  &lt; 2e-16 ***
## bpps_41               1.0141207  0.0296769  34.172  &lt; 2e-16 ***
## bpps_42               1.0398283  0.0306909  33.881  &lt; 2e-16 ***
## bpps_43               0.9601583  0.0303863  31.598  &lt; 2e-16 ***
## bpps_44               0.8926553  0.0300452  29.710  &lt; 2e-16 ***
## bpps_45               0.9216535  0.0312409  29.501  &lt; 2e-16 ***
## bpps_46               0.8993284  0.0318855  28.205  &lt; 2e-16 ***
## bpps_47               0.9218051  0.0304502  30.273  &lt; 2e-16 ***
## bpps_48               0.8318666  0.0288687  28.816  &lt; 2e-16 ***
## bpps_49               0.6766232  0.0266405  25.398  &lt; 2e-16 ***
## bpps_50               0.9046436  0.0285034  31.738  &lt; 2e-16 ***
## bpps_51               0.9236830  0.0310031  29.793  &lt; 2e-16 ***
## bpps_52               0.9244072  0.0299246  30.891  &lt; 2e-16 ***
## bpps_53               1.0837204  0.0328207  33.019  &lt; 2e-16 ***
## bpps_54               0.9873968  0.0307706  32.089  &lt; 2e-16 ***
## bpps_55               0.9644849  0.0336182  28.689  &lt; 2e-16 ***
## bpps_56               1.0482980  0.0335206  31.273  &lt; 2e-16 ***
## bpps_57               0.8845200  0.0302148  29.274  &lt; 2e-16 ***
## bpps_58               1.0230625  0.0323066  31.667  &lt; 2e-16 ***
## bpps_59               0.9707645  0.0315033  30.815  &lt; 2e-16 ***
## bpps_60               0.9413354  0.0311214  30.247  &lt; 2e-16 ***
## bpps_61               0.9781072  0.0295256  33.127  &lt; 2e-16 ***
## bpps_62               1.0464553  0.0297392  35.188  &lt; 2e-16 ***
## bpps_63               1.1061364  0.0303412  36.457  &lt; 2e-16 ***
## bpps_64               1.0387091  0.0306323  33.909  &lt; 2e-16 ***
## bpps_65               1.0358927  0.0333542  31.057  &lt; 2e-16 ***
## bpps_66               0.9458616  0.0354178  26.706  &lt; 2e-16 ***
## bpps_67               0.8462472  0.0446314  18.961  &lt; 2e-16 ***
## bpps_68               0.3798108  0.1585748   2.395 0.016616 *  
## bpps_69               0.6681696  0.1714272   3.898 9.72e-05 ***
## bpps_70               0.5908460  0.1653453   3.573 0.000353 ***
## bpps_71               0.6344805  0.1691765   3.750 0.000177 ***
## bpps_72               0.7674234  0.1862643   4.120 3.79e-05 ***
## bpps_73               0.7581880  0.1893805   4.004 6.25e-05 ***
## bpps_74               0.6916896  0.1724192   4.012 6.03e-05 ***
## bpps_75               0.6805143  0.1758890   3.869 0.000109 ***
## bpps_76               1.0547971  0.1543099   6.836 8.22e-12 ***
## bpps_77               0.8699627  0.1418368   6.134 8.63e-10 ***
## bpps_78               1.4506684  0.2721420   5.331 9.82e-08 ***
## bpps_79               1.8264153  0.2576450   7.089 1.36e-12 ***
## bpps_80               0.3398083  0.1928548   1.762 0.078075 .  
## bpps_81               1.0733204  0.2277634   4.712 2.45e-06 ***
## bpps_82               0.4352459  0.2003204   2.173 0.029802 *  
## bpps_83               0.8083729  0.2054904   3.934 8.37e-05 ***
## bpps_84               0.6411063  0.2335089   2.746 0.006043 ** 
## bpps_85               0.5180261  0.2691994   1.924 0.054318 .  
## bpps_86               0.2787287  0.2837606   0.982 0.325971    
## bpps_87               0.0660257  0.1878564   0.351 0.725238    
## bpps_88               0.6591123  0.2923211   2.255 0.024151 *  
## bpps_89               0.3902584  0.2604050   1.499 0.133966    
## bpps_90               0.9562840  0.2608179   3.666 0.000246 ***
## bpps_91               0.6834267  0.3017541   2.265 0.023525 *  
## bpps_92               0.2763969  0.3511860   0.787 0.431261    
## bpps_93               0.0020363  0.3324581   0.006 0.995113    
## bpps_94              -0.1817153  0.2192374  -0.829 0.407191    
## bpps_95              -0.9328767  0.4646679  -2.008 0.044687 *  
## bpps_96               1.4153022  0.8143840   1.738 0.082235 .  
## bpps_97               0.7196925  0.4855390   1.482 0.138276    
## bpps_98               1.1436696  1.1727836   0.975 0.329476    
## bpps_99               2.5874159  1.2813900   2.019 0.043467 *  
## bpps_100              1.0424018  0.7578113   1.376 0.168967    
## bpps_101              1.6873105  1.7068059   0.989 0.322873    
## bpps_102             -1.8255209  1.3328189  -1.370 0.170794    
## bpps_103             -1.6660246  0.6775823  -2.459 0.013943 *  
## bpps_104             -0.8962370  1.5301051  -0.586 0.558055    
## bpps_105              3.1935082  1.0489279   3.045 0.002331 ** 
## bpps_106              0.9023737  0.5005205   1.803 0.071412 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.1195312)
## 
##     Null deviance: 22756.3  on 86427  degrees of freedom
## Residual deviance:  8631.1  on 86287  degrees of freedom
## AIC: -21726
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Il est important de noter que le premier modèle n’est pas de plein rang, donc on ne peut pas se fier à ses prédictions. <br> Cependant, la pénalisation va nous aider à résoudre ce problème.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" title="1">y_pred_gamma_train =<span class="st"> </span><span class="kw">predict.glm</span>(model_gamma_deg_pH10,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" title="1">error_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb148-2" title="2"><span class="kw">print</span>(error_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.2764784</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" title="1">y_pred_gamma_val=<span class="kw">predict.glm</span>(model_gamma_deg_pH10,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" title="1">error_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb152-2" title="2"><span class="kw">print</span>(error_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.2672317</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" title="1">models_deg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_pH10, <span class="st">&quot;model_gamma&quot;</span>)</a>
<a class="sourceLine" id="cb154-2" title="2">errors_deg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_pH10_train, error_gamma_train)</a>
<a class="sourceLine" id="cb154-3" title="3">errors_deg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_pH10_val, error_gamma_val)</a>
<a class="sourceLine" id="cb154-4" title="4"><span class="kw">rm</span>(error_gamma_val, error_gamma_train, y_pred_gamma_train, y_pred_gamma_val)</a></code></pre></div>
</div>
<div id="pénalisation-ridge-et-lasso-2" class="section level3">
<h3>Pénalisation ridge et lasso</h3>
<p>On commence par calculer la matrice de design du model_gamma_deg_pH10 sur le train et le test.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" title="1"><span class="co"># Matrice de design du train</span></a>
<a class="sourceLine" id="cb155-2" title="2">data_train_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_gamma_deg_pH10)</a>
<a class="sourceLine" id="cb155-3" title="3"><span class="co">#head(data_train_pen)</span></a></code></pre></div>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" title="1"><span class="co"># Pour faire la matrice de design de la validation</span></a>
<a class="sourceLine" id="cb156-2" title="2">model_gamma_deg_pH10_val =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_gamma_deg_pH10,</a>
<a class="sourceLine" id="cb156-3" title="3">                                 <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_val)</a>
<a class="sourceLine" id="cb156-4" title="4">data_val_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_gamma_deg_pH10_val)</a>
<a class="sourceLine" id="cb156-5" title="5"><span class="co">#head(data_val_pen)</span></a>
<a class="sourceLine" id="cb156-6" title="6"></a>
<a class="sourceLine" id="cb156-7" title="7"><span class="co"># On supprime le modèle sur le test</span></a>
<a class="sourceLine" id="cb156-8" title="8"><span class="kw">rm</span>(model_gamma_deg_pH10_val)</a></code></pre></div>
<p>On pénalise le model_gamma_deg_pH10 avec une pénalité ridge. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" title="1"><span class="co">#model_gamma_deg_pH10_pen_ridge = cv.glmnet(data_train_pen, data_train$deg_pH10,</span></a>
<a class="sourceLine" id="cb157-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb157-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 0)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" title="1"><span class="co">#saveRDS(model_gamma_deg_pH10_pen_ridge, &quot;model_gamma_deg_pH10_pen_ridge.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" title="1">model_gamma_deg_pH10_pen_ridge &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_pH10_pen_ridge.rds&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" title="1"><span class="kw">coef</span>(model_gamma_deg_pH10_pen_ridge, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a></code></pre></div>
<pre><code>## 149 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                                  1
## (Intercept)           8.987095e-01
## (Intercept)           .           
## sequenceC             1.544773e-02
## sequenceG            -7.053182e-02
## sequenceU            -1.849607e-03
## index_sequence        5.562777e-03
## structure)           -3.167754e-03
## structure.           -7.488127e-02
## predicted_loop_typeE -5.051353e-02
## predicted_loop_typeH  7.559650e-03
## predicted_loop_typeI  1.561964e-02
## predicted_loop_typeM -1.414892e-02
## predicted_loop_typeS  7.486368e-02
## predicted_loop_typeX -2.807567e-02
## seq_beC               2.923260e-02
## seq_beG              -2.730809e-02
## seq_beO              -3.818560e-02
## seq_beU               1.125536e-03
## seq_afC               7.019971e-02
## seq_afG               5.432065e-02
## seq_afO              -2.567846e-02
## seq_afU              -6.174520e-02
## struct_be)           -2.098494e-02
## struct_be.           -2.465301e-02
## struct_beO           -3.818723e-02
## struct_af)            5.942230e-03
## struct_af.           -3.765203e-02
## struct_afO           -2.567759e-02
## loop_type_beE        -1.268746e-02
## loop_type_beH         1.611419e-03
## loop_type_beI         1.270913e-02
## loop_type_beM        -7.959248e-03
## loop_type_beO        -3.819132e-02
## loop_type_beS         6.289587e-02
## loop_type_beX        -1.776289e-02
## loop_type_afE        -4.758115e-02
## loop_type_afH         2.058907e-02
## loop_type_afI         1.580269e-02
## loop_type_afM        -7.162660e-03
## loop_type_afO        -2.567657e-02
## loop_type_afS         6.336976e-02
## loop_type_afX        -1.748066e-02
## bpps_0               -1.084289e-04
## bpps_1               -7.731191e-06
## bpps_2               -5.137528e-05
## bpps_3               -7.520422e-05
## bpps_4               -7.566365e-05
## bpps_5               -6.493914e-03
## bpps_6               -3.362334e-03
## bpps_7               -1.879284e-03
## bpps_8               -4.188722e-04
## bpps_9                6.506122e-05
## bpps_10               6.884408e-04
## bpps_11               6.028411e-04
## bpps_12               6.715441e-04
## bpps_13               8.135251e-04
## bpps_14               9.883763e-04
## bpps_15               1.210213e-03
## bpps_16               1.342220e-03
## bpps_17               1.786199e-03
## bpps_18               1.918703e-03
## bpps_19               2.212106e-03
## bpps_20               2.688821e-03
## bpps_21               2.880228e-03
## bpps_22               1.625538e-03
## bpps_23               1.646415e-03
## bpps_24               1.768265e-03
## bpps_25               1.247140e-03
## bpps_26               1.386390e-03
## bpps_27               2.386405e-03
## bpps_28               2.376830e-03
## bpps_29               2.569248e-03
## bpps_30               2.873134e-03
## bpps_31               2.840910e-03
## bpps_32               2.648817e-03
## bpps_33               2.088003e-03
## bpps_34               1.424073e-03
## bpps_35               1.457368e-03
## bpps_36               1.115033e-03
## bpps_37               1.411607e-03
## bpps_38               2.581396e-03
## bpps_39               2.281637e-03
## bpps_40               2.756376e-03
## bpps_41               2.527873e-03
## bpps_42               2.680680e-03
## bpps_43               2.135380e-03
## bpps_44               1.341269e-03
## bpps_45               1.267608e-03
## bpps_46               1.344332e-03
## bpps_47               1.796618e-03
## bpps_48               2.592402e-03
## bpps_49               2.565127e-03
## bpps_50               2.947812e-03
## bpps_51               2.429395e-03
## bpps_52               2.799949e-03
## bpps_53               2.343569e-03
## bpps_54               2.974004e-03
## bpps_55               2.599099e-03
## bpps_56               2.851060e-03
## bpps_57               2.454117e-03
## bpps_58               2.773060e-03
## bpps_59               2.297429e-03
## bpps_60               2.496932e-03
## bpps_61               2.296426e-03
## bpps_62               2.201315e-03
## bpps_63               1.440238e-03
## bpps_64               1.091321e-03
## bpps_65               9.358325e-04
## bpps_66              -3.614377e-04
## bpps_67              -5.665733e-04
## bpps_68              -1.561359e-04
## bpps_69               9.628829e-06
## bpps_70               4.004712e-05
## bpps_71               3.993496e-05
## bpps_72              -1.666737e-05
## bpps_73              -2.903915e-05
## bpps_74              -2.187241e-05
## bpps_75               1.441643e-04
## bpps_76               1.186836e-04
## bpps_77              -1.284528e-04
## bpps_78               1.043715e-04
## bpps_79               5.201385e-05
## bpps_80              -2.436943e-05
## bpps_81               6.162799e-05
## bpps_82               1.482615e-06
## bpps_83              -1.931625e-05
## bpps_84              -6.648492e-05
## bpps_85              -9.273448e-05
## bpps_86              -6.788093e-05
## bpps_87              -1.275087e-04
## bpps_88              -7.535430e-05
## bpps_89              -1.322926e-04
## bpps_90              -2.033513e-04
## bpps_91               6.313898e-05
## bpps_92              -1.375037e-04
## bpps_93              -1.070108e-04
## bpps_94              -1.030989e-03
## bpps_95               1.322250e-05
## bpps_96               8.075414e-07
## bpps_97              -9.607855e-04
## bpps_98               3.935678e-05
## bpps_99               1.580376e-05
## bpps_100             -9.194395e-04
## bpps_101              4.283978e-05
## bpps_102              1.625491e-05
## bpps_103             -9.047194e-04
## bpps_104              3.157983e-05
## bpps_105              5.509881e-08
## bpps_106             -3.854657e-04</code></pre>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation ridge.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" title="1">y_pred_ridge_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_pH10_pen_ridge, data_train_pen,</a>
<a class="sourceLine" id="cb162-2" title="2">                                   <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb162-3" title="3">y_pred_ridge_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_pH10_pen_ridge, data_val_pen,</a>
<a class="sourceLine" id="cb162-4" title="4">                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb162-5" title="5">error_ridge_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_ridge_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb162-6" title="6"><span class="kw">print</span>(error_ridge_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.2083185</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" title="1">error_ridge_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_ridge_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb164-2" title="2"><span class="kw">print</span>(error_ridge_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.2031605</code></pre>
<p>On pénalise le model_gamma_deg_pH10 avec une pénalité lasso. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" title="1"><span class="co">#model_gamma_deg_pH10_pen_lasso = cv.glmnet(data_train_pen, data_train$deg_pH10,</span></a>
<a class="sourceLine" id="cb166-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb166-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 1)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" title="1"><span class="co">#saveRDS(model_gamma_deg_pH10_pen_lasso, &quot;model_gamma_deg_pH10_pen_lasso.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" title="1">model_gamma_deg_pH10_pen_lasso &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_pH10_pen_lasso.rds&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" title="1"><span class="kw">coef</span>(model_gamma_deg_pH10_pen_lasso, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a></code></pre></div>
<pre><code>## 149 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                                  1
## (Intercept)           1.0197739592
## (Intercept)           .           
## sequenceC            -0.0530227766
## sequenceG            -0.1864404338
## sequenceU            -0.1124068338
## index_sequence        0.0057306831
## structure)           -0.0204879890
## structure.           -0.3099014638
## predicted_loop_typeE  .           
## predicted_loop_typeH  0.0547690885
## predicted_loop_typeI  0.1644991898
## predicted_loop_typeM -0.0205327116
## predicted_loop_typeS  0.0122246012
## predicted_loop_typeX -0.0269337203
## seq_beC               0.0390155907
## seq_beG              -0.0894874295
## seq_beO              -0.3813654977
## seq_beU              -0.0488924453
## seq_afC               0.2528084799
## seq_afG               0.2313866514
## seq_afO              -0.3510258062
## seq_afU              -0.1558824311
## struct_be)           -0.1471354958
## struct_be.            .           
## struct_beO           -0.0095606680
## struct_af)            .           
## struct_af.            .           
## struct_afO           -0.0016535156
## loop_type_beE        -0.0360863422
## loop_type_beH        -0.0078943339
## loop_type_beI         0.0160343758
## loop_type_beM         .           
## loop_type_beO        -0.0008361128
## loop_type_beS         0.1811429049
## loop_type_beX         .           
## loop_type_afE         0.0277213331
## loop_type_afH         0.0796416022
## loop_type_afI         .           
## loop_type_afM         .           
## loop_type_afO        -0.0006959675
## loop_type_afS         0.0566949099
## loop_type_afX        -0.0643027908
## bpps_0                .           
## bpps_1                .           
## bpps_2                .           
## bpps_3                .           
## bpps_4                .           
## bpps_5               -0.2951099074
## bpps_6               -0.1311750595
## bpps_7               -0.0415113146
## bpps_8                .           
## bpps_9                .           
## bpps_10               0.0236883917
## bpps_11               0.0163728335
## bpps_12               .           
## bpps_13               0.0114883073
## bpps_14               0.0240475511
## bpps_15               0.0236417077
## bpps_16               0.0081589688
## bpps_17               0.0180215391
## bpps_18               0.0171539061
## bpps_19               0.0625714895
## bpps_20               0.0868727643
## bpps_21               0.1087053444
## bpps_22               0.0601508953
## bpps_23               0.0262299031
## bpps_24               0.0069849696
## bpps_25               0.0037868321
## bpps_26               0.0179347387
## bpps_27               0.0557846286
## bpps_28               0.0800436399
## bpps_29               0.1280418263
## bpps_30               0.1395468666
## bpps_31               0.1035341812
## bpps_32               0.1044465763
## bpps_33               0.0777236867
## bpps_34               .           
## bpps_35               0.0300254603
## bpps_36               .           
## bpps_37               .           
## bpps_38               0.0622906869
## bpps_39               0.0020795563
## bpps_40               0.0433121299
## bpps_41               0.0409302059
## bpps_42               0.0586732993
## bpps_43               0.0377319978
## bpps_44               .           
## bpps_45               .           
## bpps_46               .           
## bpps_47               .           
## bpps_48               0.0458794559
## bpps_49               0.0246706057
## bpps_50               0.0696788069
## bpps_51               0.0049491678
## bpps_52               0.0555112998
## bpps_53               0.0479386127
## bpps_54               0.0931472538
## bpps_55               0.0252683896
## bpps_56               0.0660247165
## bpps_57               0.0126647485
## bpps_58               0.0345053490
## bpps_59               .           
## bpps_60               .           
## bpps_61               .           
## bpps_62               .           
## bpps_63               .           
## bpps_64               .           
## bpps_65               .           
## bpps_66              -0.0165118743
## bpps_67               .           
## bpps_68               .           
## bpps_69               .           
## bpps_70               .           
## bpps_71               .           
## bpps_72               .           
## bpps_73               .           
## bpps_74               .           
## bpps_75               .           
## bpps_76               .           
## bpps_77               .           
## bpps_78               .           
## bpps_79               .           
## bpps_80               .           
## bpps_81               .           
## bpps_82               .           
## bpps_83               .           
## bpps_84               .           
## bpps_85               .           
## bpps_86               .           
## bpps_87               .           
## bpps_88               .           
## bpps_89               .           
## bpps_90               .           
## bpps_91               .           
## bpps_92               .           
## bpps_93               .           
## bpps_94               .           
## bpps_95               .           
## bpps_96               .           
## bpps_97               .           
## bpps_98               .           
## bpps_99               .           
## bpps_100              .           
## bpps_101              .           
## bpps_102              .           
## bpps_103              .           
## bpps_104              .           
## bpps_105              .           
## bpps_106              .</code></pre>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation lasso.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb171-1" title="1">y_pred_lasso_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_pH10_pen_lasso, data_train_pen,</a>
<a class="sourceLine" id="cb171-2" title="2">                                   <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb171-3" title="3">error_lasso_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_lasso_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb171-4" title="4"><span class="kw">print</span>(error_lasso_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1617835</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb173-1" title="1">y_pred_lasso_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_pH10_pen_lasso, data_val_pen,</a>
<a class="sourceLine" id="cb173-2" title="2">                                 <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb173-3" title="3">error_lasso_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_lasso_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb173-4" title="4"><span class="kw">print</span>(error_lasso_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1564803</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" title="1">models_deg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_pH10, <span class="st">&quot;model_gamma_ridge&quot;</span>, <span class="st">&quot;model_gamma_lasso&quot;</span>)</a>
<a class="sourceLine" id="cb175-2" title="2">errors_deg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_pH10_train, error_ridge_gamma_train,</a>
<a class="sourceLine" id="cb175-3" title="3">                             error_lasso_gamma_train)</a>
<a class="sourceLine" id="cb175-4" title="4">errors_deg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_pH10_val, error_ridge_gamma_val, error_lasso_gamma_val)</a>
<a class="sourceLine" id="cb175-5" title="5"><span class="kw">rm</span>(error_ridge_gamma_val, error_lasso_gamma_val,</a>
<a class="sourceLine" id="cb175-6" title="6">   error_ridge_gamma_train, error_lasso_gamma_train,</a>
<a class="sourceLine" id="cb175-7" title="7">   y_pred_ridge_gamma_train, y_pred_ridge_gamma_val,</a>
<a class="sourceLine" id="cb175-8" title="8">   y_pred_lasso_gamma_train, y_pred_lasso_gamma_val)</a></code></pre></div>
</div>
<div id="pénalisation-elastic-net-2" class="section level3">
<h3>Pénalisation elastic-net</h3>
<p>On choisit <span class="math inline">\(\alpha\)</span> qui minimise le MSE sur la validation.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb176-1" title="1"><span class="co">#alpha_opti_enet_gamma_deg_pH10 =</span></a>
<a class="sourceLine" id="cb176-2" title="2"><span class="co">#  alpha_opti_enet(data_train = data_train_pen, data_val = data_val_pen,</span></a>
<a class="sourceLine" id="cb176-3" title="3"><span class="co">#                  y_true_train = data_train$deg_pH10,</span></a>
<a class="sourceLine" id="cb176-4" title="4"><span class="co">#                  y_true_val = data_val$deg_pH10,</span></a>
<a class="sourceLine" id="cb176-5" title="5"><span class="co">#                  family = Gamma)</span></a></code></pre></div>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" title="1"><span class="co">#print(alpha_opti_enet_gamma_deg_pH10)</span></a></code></pre></div>
<p>On construit le modèle avec le choix optimal pour <span class="math inline">\(\alpha\)</span>.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb178-1" title="1"><span class="co">#model_gamma_deg_pH10_pen_enet = cv.glmnet(data_train_pen, data_train$deg_pH10,</span></a>
<a class="sourceLine" id="cb178-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb178-3" title="3"><span class="co">#                                             standardize = FALSE,</span></a>
<a class="sourceLine" id="cb178-4" title="4"><span class="co">#                                             alpha = alpha_opti_enet_gamma_deg_pH10)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb179-1" title="1"><span class="co">#saveRDS(model_gamma_deg_pH10_pen_enet, &quot;model_gamma_deg_pH10_pen_enet.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb180-1" title="1">model_gamma_deg_pH10_pen_enet &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_pH10_pen_enet.rds&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" title="1"><span class="kw">coef</span>(model_gamma_deg_pH10_pen_enet, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a></code></pre></div>
<pre><code>## 149 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                                  1
## (Intercept)           1.0197739592
## (Intercept)           .           
## sequenceC            -0.0530227766
## sequenceG            -0.1864404338
## sequenceU            -0.1124068338
## index_sequence        0.0057306831
## structure)           -0.0204879890
## structure.           -0.3099014638
## predicted_loop_typeE  .           
## predicted_loop_typeH  0.0547690885
## predicted_loop_typeI  0.1644991898
## predicted_loop_typeM -0.0205327116
## predicted_loop_typeS  0.0122246012
## predicted_loop_typeX -0.0269337203
## seq_beC               0.0390155907
## seq_beG              -0.0894874295
## seq_beO              -0.3813654977
## seq_beU              -0.0488924453
## seq_afC               0.2528084799
## seq_afG               0.2313866514
## seq_afO              -0.3510258062
## seq_afU              -0.1558824311
## struct_be)           -0.1471354958
## struct_be.            .           
## struct_beO           -0.0095606680
## struct_af)            .           
## struct_af.            .           
## struct_afO           -0.0016535156
## loop_type_beE        -0.0360863422
## loop_type_beH        -0.0078943339
## loop_type_beI         0.0160343758
## loop_type_beM         .           
## loop_type_beO        -0.0008361128
## loop_type_beS         0.1811429049
## loop_type_beX         .           
## loop_type_afE         0.0277213331
## loop_type_afH         0.0796416022
## loop_type_afI         .           
## loop_type_afM         .           
## loop_type_afO        -0.0006959675
## loop_type_afS         0.0566949099
## loop_type_afX        -0.0643027908
## bpps_0                .           
## bpps_1                .           
## bpps_2                .           
## bpps_3                .           
## bpps_4                .           
## bpps_5               -0.2951099074
## bpps_6               -0.1311750595
## bpps_7               -0.0415113146
## bpps_8                .           
## bpps_9                .           
## bpps_10               0.0236883917
## bpps_11               0.0163728335
## bpps_12               .           
## bpps_13               0.0114883073
## bpps_14               0.0240475511
## bpps_15               0.0236417077
## bpps_16               0.0081589688
## bpps_17               0.0180215391
## bpps_18               0.0171539061
## bpps_19               0.0625714895
## bpps_20               0.0868727643
## bpps_21               0.1087053444
## bpps_22               0.0601508953
## bpps_23               0.0262299031
## bpps_24               0.0069849696
## bpps_25               0.0037868321
## bpps_26               0.0179347387
## bpps_27               0.0557846286
## bpps_28               0.0800436399
## bpps_29               0.1280418263
## bpps_30               0.1395468666
## bpps_31               0.1035341812
## bpps_32               0.1044465763
## bpps_33               0.0777236867
## bpps_34               .           
## bpps_35               0.0300254603
## bpps_36               .           
## bpps_37               .           
## bpps_38               0.0622906869
## bpps_39               0.0020795563
## bpps_40               0.0433121299
## bpps_41               0.0409302059
## bpps_42               0.0586732993
## bpps_43               0.0377319978
## bpps_44               .           
## bpps_45               .           
## bpps_46               .           
## bpps_47               .           
## bpps_48               0.0458794559
## bpps_49               0.0246706057
## bpps_50               0.0696788069
## bpps_51               0.0049491678
## bpps_52               0.0555112998
## bpps_53               0.0479386127
## bpps_54               0.0931472538
## bpps_55               0.0252683896
## bpps_56               0.0660247165
## bpps_57               0.0126647485
## bpps_58               0.0345053490
## bpps_59               .           
## bpps_60               .           
## bpps_61               .           
## bpps_62               .           
## bpps_63               .           
## bpps_64               .           
## bpps_65               .           
## bpps_66              -0.0165118743
## bpps_67               .           
## bpps_68               .           
## bpps_69               .           
## bpps_70               .           
## bpps_71               .           
## bpps_72               .           
## bpps_73               .           
## bpps_74               .           
## bpps_75               .           
## bpps_76               .           
## bpps_77               .           
## bpps_78               .           
## bpps_79               .           
## bpps_80               .           
## bpps_81               .           
## bpps_82               .           
## bpps_83               .           
## bpps_84               .           
## bpps_85               .           
## bpps_86               .           
## bpps_87               .           
## bpps_88               .           
## bpps_89               .           
## bpps_90               .           
## bpps_91               .           
## bpps_92               .           
## bpps_93               .           
## bpps_94               .           
## bpps_95               .           
## bpps_96               .           
## bpps_97               .           
## bpps_98               .           
## bpps_99               .           
## bpps_100              .           
## bpps_101              .           
## bpps_102              .           
## bpps_103              .           
## bpps_104              .           
## bpps_105              .           
## bpps_106              .</code></pre>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation elastic-net.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" title="1">y_pred_enet_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_pH10_pen_enet, data_train_pen,</a>
<a class="sourceLine" id="cb183-2" title="2">                                   <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb183-3" title="3">error_enet_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_enet_gamma_train <span class="op">-</span><span class="st"> </span>data_train<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb183-4" title="4"><span class="kw">print</span>(error_enet_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1617835</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb185-1" title="1">y_pred_enet_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_pH10_pen_enet, data_val_pen,</a>
<a class="sourceLine" id="cb185-2" title="2">                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb185-3" title="3">error_enet_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_enet_gamma_val <span class="op">-</span><span class="st"> </span>data_val<span class="op">$</span>deg_pH10)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb185-4" title="4"><span class="kw">print</span>(error_enet_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1564803</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb187-1" title="1">models_deg_pH10 &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_pH10, <span class="st">&quot;model_gamma_enet&quot;</span>)</a>
<a class="sourceLine" id="cb187-2" title="2">errors_deg_pH10_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_pH10_train, error_enet_gamma_train)</a>
<a class="sourceLine" id="cb187-3" title="3">errors_deg_pH10_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_pH10_val, error_enet_gamma_val)</a>
<a class="sourceLine" id="cb187-4" title="4"><span class="kw">rm</span>(error_enet_gamma_train, error_enet_gamma_val,</a>
<a class="sourceLine" id="cb187-5" title="5">   y_pred_enet_gamma_train, y_pred_enet_gamma_val)</a></code></pre></div>
</div>
<div id="récapitulatif-des-résultats-2" class="section level3">
<h3>Récapitulatif des résultats</h3>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb188-1" title="1">models_deg_pH10_errors_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(models_deg_pH10,</a>
<a class="sourceLine" id="cb188-2" title="2">                                          errors_deg_pH10_train,</a>
<a class="sourceLine" id="cb188-3" title="3">                                          errors_deg_pH10_val)</a></code></pre></div>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" title="1">models_deg_pH10_errors_df</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["models_deg_pH10"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_deg_pH10_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_deg_pH10_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma","2":"0.2764784","3":"0.2672317"},{"1":"model_gamma_ridge","2":"0.2083185","3":"0.2031605"},{"1":"model_gamma_lasso","2":"0.1617835","3":"0.1564803"},{"1":"model_gamma_enet","2":"0.1617835","3":"0.1564803"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Le meilleur modèle (au sens de la minimisation du MSE sur la validation) est le <code>model_gamma_lasso</code> (si on exclut le premier modèle qui n’était pas de plein rang).</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" title="1">models_deg_pH10_errors_df[<span class="kw">which.min</span>(errors_deg_pH10_val[<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, ]</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["models_deg_pH10"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_deg_pH10_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_deg_pH10_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma_lasso","2":"0.1617835","3":"0.1564803","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="deg_mg_50c" class="section level2">
<h2>deg_Mg_50C</h2>
<div id="premier-modèle-3" class="section level3">
<h3>Premier modèle</h3>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" title="1">formula_gamma_deg_Mg_50C =<span class="st"> </span>formula_model_full</a></code></pre></div>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb192-1" title="1">model_gamma_deg_Mg_50C =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_gamma_deg_Mg_50C,</a>
<a class="sourceLine" id="cb192-2" title="2">                             <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a></code></pre></div>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" title="1"><span class="kw">summary</span>(model_gamma_deg_Mg_50C)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = formula_gamma_deg_Mg_50C, family = Gamma, data = data_train)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.51817  -0.22337  -0.06782   0.12456   3.00792  
## 
## Coefficients: (7 not defined because of singularities)
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           0.7989229  0.0090485  88.294  &lt; 2e-16 ***
## sequenceC             0.2703951  0.0059384  45.533  &lt; 2e-16 ***
## sequenceG            -0.0702891  0.0037986 -18.504  &lt; 2e-16 ***
## sequenceU            -0.0788956  0.0047472 -16.619  &lt; 2e-16 ***
## index_sequence        0.0063617  0.0001042  61.046  &lt; 2e-16 ***
## structure)           -0.0002012  0.0100481  -0.020 0.984022    
## structure.           -0.1436545  0.0129620 -11.083  &lt; 2e-16 ***
## predicted_loop_typeE  0.1320690  0.0231440   5.706 1.16e-08 ***
## predicted_loop_typeH  0.1919257  0.0143698  13.356  &lt; 2e-16 ***
## predicted_loop_typeI  0.2831076  0.0128925  21.959  &lt; 2e-16 ***
## predicted_loop_typeM  0.1810543  0.0177310  10.211  &lt; 2e-16 ***
## predicted_loop_typeS         NA         NA      NA       NA    
## predicted_loop_typeX  0.1618593  0.0210956   7.673 1.70e-14 ***
## seq_beC               0.0124317  0.0047704   2.606 0.009161 ** 
## seq_beG              -0.0955972  0.0036577 -26.136  &lt; 2e-16 ***
## seq_beO              -0.1791055  0.0218148  -8.210 2.24e-16 ***
## seq_beU              -0.0957504  0.0046825 -20.448  &lt; 2e-16 ***
## seq_afC               0.3715125  0.0053188  69.849  &lt; 2e-16 ***
## seq_afG               0.4209183  0.0049139  85.658  &lt; 2e-16 ***
## seq_afO               0.0883727  0.0185190   4.772 1.83e-06 ***
## seq_afU              -0.1162642  0.0041155 -28.250  &lt; 2e-16 ***
## struct_be)            0.0055618  0.0078210   0.711 0.477004    
## struct_be.           -0.0368872  0.0121773  -3.029 0.002453 ** 
## struct_beO                   NA         NA      NA       NA    
## struct_af)           -0.1096620  0.0081422 -13.468  &lt; 2e-16 ***
## struct_af.           -0.1965876  0.0116368 -16.894  &lt; 2e-16 ***
## struct_afO                   NA         NA      NA       NA    
## loop_type_beE         0.0045766  0.0211292   0.217 0.828519    
## loop_type_beH        -0.0045547  0.0133169  -0.342 0.732331    
## loop_type_beI        -0.0479460  0.0134202  -3.573 0.000354 ***
## loop_type_beM        -0.0244848  0.0165647  -1.478 0.139376    
## loop_type_beO                NA         NA      NA       NA    
## loop_type_beS                NA         NA      NA       NA    
## loop_type_beX        -0.0037208  0.0186243  -0.200 0.841653    
## loop_type_afE         0.2034528  0.0159674  12.742  &lt; 2e-16 ***
## loop_type_afH        -0.0452086  0.0132560  -3.410 0.000649 ***
## loop_type_afI         0.0539473  0.0127563   4.229 2.35e-05 ***
## loop_type_afM        -0.0131955  0.0161361  -0.818 0.413494    
## loop_type_afO                NA         NA      NA       NA    
## loop_type_afS                NA         NA      NA       NA    
## loop_type_afX        -0.0191197  0.0185535  -1.031 0.302771    
## bpps_0                1.4307370  0.2293105   6.239 4.42e-10 ***
## bpps_1                1.8499347  0.2617513   7.068 1.59e-12 ***
## bpps_2                0.1286824  0.2637094   0.488 0.625572    
## bpps_3                1.6518813  0.3275784   5.043 4.60e-07 ***
## bpps_4                0.6703695  0.2390895   2.804 0.005051 ** 
## bpps_5                0.5965273  0.0347556  17.163  &lt; 2e-16 ***
## bpps_6                0.7495353  0.0315413  23.764  &lt; 2e-16 ***
## bpps_7                0.8469023  0.0301926  28.050  &lt; 2e-16 ***
## bpps_8                0.8343332  0.0288075  28.962  &lt; 2e-16 ***
## bpps_9                0.9561525  0.0304889  31.361  &lt; 2e-16 ***
## bpps_10               0.8859270  0.0281033  31.524  &lt; 2e-16 ***
## bpps_11               0.9495781  0.0305737  31.059  &lt; 2e-16 ***
## bpps_12               0.9178562  0.0306744  29.923  &lt; 2e-16 ***
## bpps_13               0.8835467  0.0311431  28.371  &lt; 2e-16 ***
## bpps_14               0.9808834  0.0334649  29.311  &lt; 2e-16 ***
## bpps_15               0.9007171  0.0335768  26.826  &lt; 2e-16 ***
## bpps_16               0.8892810  0.0334893  26.554  &lt; 2e-16 ***
## bpps_17               0.8645905  0.0294863  29.322  &lt; 2e-16 ***
## bpps_18               0.8409426  0.0295459  28.462  &lt; 2e-16 ***
## bpps_19               0.8832841  0.0302888  29.162  &lt; 2e-16 ***
## bpps_20               1.0106499  0.0306622  32.961  &lt; 2e-16 ***
## bpps_21               0.9558724  0.0296198  32.271  &lt; 2e-16 ***
## bpps_22               0.9746255  0.0293452  33.212  &lt; 2e-16 ***
## bpps_23               0.9054551  0.0304699  29.716  &lt; 2e-16 ***
## bpps_24               0.8627111  0.0297398  29.009  &lt; 2e-16 ***
## bpps_25               0.8879407  0.0301741  29.427  &lt; 2e-16 ***
## bpps_26               0.9125527  0.0297762  30.647  &lt; 2e-16 ***
## bpps_27               0.9274502  0.0305430  30.365  &lt; 2e-16 ***
## bpps_28               0.9156497  0.0300466  30.474  &lt; 2e-16 ***
## bpps_29               1.0297723  0.0309696  33.251  &lt; 2e-16 ***
## bpps_30               1.0505855  0.0306824  34.241  &lt; 2e-16 ***
## bpps_31               0.9810940  0.0299421  32.766  &lt; 2e-16 ***
## bpps_32               0.9641271  0.0300659  32.067  &lt; 2e-16 ***
## bpps_33               1.0015369  0.0313892  31.907  &lt; 2e-16 ***
## bpps_34               0.8401679  0.0332296  25.284  &lt; 2e-16 ***
## bpps_35               0.8023917  0.0345468  23.226  &lt; 2e-16 ***
## bpps_36               0.7106755  0.0312162  22.766  &lt; 2e-16 ***
## bpps_37               0.7249111  0.0324249  22.357  &lt; 2e-16 ***
## bpps_38               0.7685107  0.0289843  26.515  &lt; 2e-16 ***
## bpps_39               0.8087168  0.0302332  26.749  &lt; 2e-16 ***
## bpps_40               0.8937376  0.0294279  30.370  &lt; 2e-16 ***
## bpps_41               1.0141207  0.0296769  34.172  &lt; 2e-16 ***
## bpps_42               1.0398283  0.0306909  33.881  &lt; 2e-16 ***
## bpps_43               0.9601583  0.0303863  31.598  &lt; 2e-16 ***
## bpps_44               0.8926553  0.0300452  29.710  &lt; 2e-16 ***
## bpps_45               0.9216535  0.0312409  29.501  &lt; 2e-16 ***
## bpps_46               0.8993284  0.0318855  28.205  &lt; 2e-16 ***
## bpps_47               0.9218051  0.0304502  30.273  &lt; 2e-16 ***
## bpps_48               0.8318666  0.0288687  28.816  &lt; 2e-16 ***
## bpps_49               0.6766232  0.0266405  25.398  &lt; 2e-16 ***
## bpps_50               0.9046436  0.0285034  31.738  &lt; 2e-16 ***
## bpps_51               0.9236830  0.0310031  29.793  &lt; 2e-16 ***
## bpps_52               0.9244072  0.0299246  30.891  &lt; 2e-16 ***
## bpps_53               1.0837204  0.0328207  33.019  &lt; 2e-16 ***
## bpps_54               0.9873968  0.0307706  32.089  &lt; 2e-16 ***
## bpps_55               0.9644849  0.0336182  28.689  &lt; 2e-16 ***
## bpps_56               1.0482980  0.0335206  31.273  &lt; 2e-16 ***
## bpps_57               0.8845200  0.0302148  29.274  &lt; 2e-16 ***
## bpps_58               1.0230625  0.0323066  31.667  &lt; 2e-16 ***
## bpps_59               0.9707645  0.0315033  30.815  &lt; 2e-16 ***
## bpps_60               0.9413354  0.0311214  30.247  &lt; 2e-16 ***
## bpps_61               0.9781072  0.0295256  33.127  &lt; 2e-16 ***
## bpps_62               1.0464553  0.0297392  35.188  &lt; 2e-16 ***
## bpps_63               1.1061364  0.0303412  36.457  &lt; 2e-16 ***
## bpps_64               1.0387091  0.0306323  33.909  &lt; 2e-16 ***
## bpps_65               1.0358927  0.0333542  31.057  &lt; 2e-16 ***
## bpps_66               0.9458616  0.0354178  26.706  &lt; 2e-16 ***
## bpps_67               0.8462472  0.0446314  18.961  &lt; 2e-16 ***
## bpps_68               0.3798108  0.1585748   2.395 0.016616 *  
## bpps_69               0.6681696  0.1714272   3.898 9.72e-05 ***
## bpps_70               0.5908460  0.1653453   3.573 0.000353 ***
## bpps_71               0.6344805  0.1691765   3.750 0.000177 ***
## bpps_72               0.7674234  0.1862643   4.120 3.79e-05 ***
## bpps_73               0.7581880  0.1893805   4.004 6.25e-05 ***
## bpps_74               0.6916896  0.1724192   4.012 6.03e-05 ***
## bpps_75               0.6805143  0.1758890   3.869 0.000109 ***
## bpps_76               1.0547971  0.1543099   6.836 8.22e-12 ***
## bpps_77               0.8699627  0.1418368   6.134 8.63e-10 ***
## bpps_78               1.4506684  0.2721420   5.331 9.82e-08 ***
## bpps_79               1.8264153  0.2576450   7.089 1.36e-12 ***
## bpps_80               0.3398083  0.1928548   1.762 0.078075 .  
## bpps_81               1.0733204  0.2277634   4.712 2.45e-06 ***
## bpps_82               0.4352459  0.2003204   2.173 0.029802 *  
## bpps_83               0.8083729  0.2054904   3.934 8.37e-05 ***
## bpps_84               0.6411063  0.2335089   2.746 0.006043 ** 
## bpps_85               0.5180261  0.2691994   1.924 0.054318 .  
## bpps_86               0.2787287  0.2837606   0.982 0.325971    
## bpps_87               0.0660257  0.1878564   0.351 0.725238    
## bpps_88               0.6591123  0.2923211   2.255 0.024151 *  
## bpps_89               0.3902584  0.2604050   1.499 0.133966    
## bpps_90               0.9562840  0.2608179   3.666 0.000246 ***
## bpps_91               0.6834267  0.3017541   2.265 0.023525 *  
## bpps_92               0.2763969  0.3511860   0.787 0.431261    
## bpps_93               0.0020363  0.3324581   0.006 0.995113    
## bpps_94              -0.1817153  0.2192374  -0.829 0.407191    
## bpps_95              -0.9328767  0.4646679  -2.008 0.044687 *  
## bpps_96               1.4153022  0.8143840   1.738 0.082235 .  
## bpps_97               0.7196925  0.4855390   1.482 0.138276    
## bpps_98               1.1436696  1.1727836   0.975 0.329476    
## bpps_99               2.5874159  1.2813900   2.019 0.043467 *  
## bpps_100              1.0424018  0.7578113   1.376 0.168967    
## bpps_101              1.6873105  1.7068059   0.989 0.322873    
## bpps_102             -1.8255209  1.3328189  -1.370 0.170794    
## bpps_103             -1.6660246  0.6775823  -2.459 0.013943 *  
## bpps_104             -0.8962370  1.5301051  -0.586 0.558055    
## bpps_105              3.1935082  1.0489279   3.045 0.002331 ** 
## bpps_106              0.9023737  0.5005205   1.803 0.071412 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.1195312)
## 
##     Null deviance: 22756.3  on 86427  degrees of freedom
## Residual deviance:  8631.1  on 86287  degrees of freedom
## AIC: -21726
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Il est important de noter que le premier modèle n’est pas de plein rang, donc on ne peut pas se fier à ses prédictions. <br> Cependant, la pénalisation va nous aider à résoudre ce problème.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" title="1">y_pred_gamma_train =<span class="st"> </span><span class="kw">predict.glm</span>(model_gamma_deg_Mg_50C,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" title="1">error_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb197-2" title="2"><span class="kw">print</span>(error_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1773691</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb199-1" title="1">y_pred_gamma_val=<span class="kw">predict.glm</span>(model_gamma_deg_Mg_50C,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" title="1">error_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb201-2" title="2"><span class="kw">print</span>(error_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1766456</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" title="1">models_deg_Mg_50C &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_Mg_50C, <span class="st">&quot;model_gamma&quot;</span>)</a>
<a class="sourceLine" id="cb203-2" title="2">errors_deg_Mg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_50C_train, error_gamma_train)</a>
<a class="sourceLine" id="cb203-3" title="3">errors_deg_Mg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_50C_val, error_gamma_val)</a>
<a class="sourceLine" id="cb203-4" title="4"><span class="kw">rm</span>(error_gamma_val, error_gamma_train, y_pred_gamma_train, y_pred_gamma_val)</a></code></pre></div>
</div>
<div id="pénalisation-ridge-et-lasso-3" class="section level3">
<h3>Pénalisation ridge et lasso</h3>
<p>On commence par calculer la matrice de design du model_gamma_deg_Mg_50C sur le train et le test.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb204-1" title="1"><span class="co"># Matrice de design du train</span></a>
<a class="sourceLine" id="cb204-2" title="2">data_train_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_gamma_deg_Mg_50C)</a>
<a class="sourceLine" id="cb204-3" title="3"><span class="co">#head(data_train_pen)</span></a></code></pre></div>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" title="1"><span class="co"># Pour faire la matrice de design de la validation</span></a>
<a class="sourceLine" id="cb205-2" title="2">model_gamma_deg_Mg_50C_val =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_gamma_deg_Mg_50C,</a>
<a class="sourceLine" id="cb205-3" title="3">                                 <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_val)</a>
<a class="sourceLine" id="cb205-4" title="4">data_val_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_gamma_deg_Mg_50C_val)</a>
<a class="sourceLine" id="cb205-5" title="5"><span class="co">#head(data_val_pen)</span></a>
<a class="sourceLine" id="cb205-6" title="6"></a>
<a class="sourceLine" id="cb205-7" title="7"><span class="co"># On supprime le modèle sur le test</span></a>
<a class="sourceLine" id="cb205-8" title="8"><span class="kw">rm</span>(model_gamma_deg_Mg_50C_val)</a></code></pre></div>
<p>On pénalise le model_gamma_deg_Mg_50C avec une pénalité ridge. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb206-1" title="1"><span class="co">#model_gamma_deg_Mg_50C_pen_ridge = cv.glmnet(data_train_pen, data_train$deg_Mg_50C,</span></a>
<a class="sourceLine" id="cb206-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb206-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 0)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" title="1"><span class="co">#saveRDS(model_gamma_deg_Mg_50C_pen_ridge, &quot;model_gamma_deg_Mg_50C_pen_ridge.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb208-1" title="1">model_gamma_deg_Mg_50C_pen_ridge &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_Mg_50C_pen_ridge.rds&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" title="1"><span class="kw">coef</span>(model_gamma_deg_Mg_50C_pen_ridge, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a></code></pre></div>
<pre><code>## 149 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                                  1
## (Intercept)           9.766159e-01
## (Intercept)           .           
## sequenceC             3.974458e-02
## sequenceG            -2.319180e-02
## sequenceU             5.766996e-03
## index_sequence        4.399303e-03
## structure)           -2.927883e-04
## structure.           -8.351455e-02
## predicted_loop_typeE -2.650142e-02
## predicted_loop_typeH -5.040989e-03
## predicted_loop_typeI  7.183574e-03
## predicted_loop_typeM -1.914189e-02
## predicted_loop_typeS  8.361180e-02
## predicted_loop_typeX -2.479620e-02
## seq_beC               3.084629e-02
## seq_beG              -2.429714e-02
## seq_beO               7.077214e-03
## seq_beU              -1.220829e-02
## seq_afC               8.680139e-02
## seq_afG               1.132420e-01
## seq_afO              -7.003197e-03
## seq_afU              -1.070139e-01
## struct_be)           -2.147412e-02
## struct_be.           -5.615257e-02
## struct_beO            7.078908e-03
## struct_af)            2.931942e-03
## struct_af.           -6.417758e-02
## struct_afO           -7.001326e-03
## loop_type_beE        -3.110100e-02
## loop_type_beH        -5.062565e-03
## loop_type_beI         9.296708e-03
## loop_type_beM        -8.879975e-03
## loop_type_beO         7.075981e-03
## loop_type_beS         4.908520e-02
## loop_type_beX        -1.511868e-02
## loop_type_afE        -1.839041e-02
## loop_type_afH         4.205362e-03
## loop_type_afI         5.291208e-03
## loop_type_afM        -1.831825e-02
## loop_type_afO        -7.001389e-03
## loop_type_afS         7.110356e-02
## loop_type_afX        -2.708652e-02
## bpps_0                1.025335e-04
## bpps_1                2.112967e-04
## bpps_2                8.729601e-05
## bpps_3                3.786536e-06
## bpps_4               -1.814776e-05
## bpps_5               -2.429747e-03
## bpps_6               -2.464940e-03
## bpps_7               -7.324579e-04
## bpps_8                1.240432e-04
## bpps_9                3.803335e-04
## bpps_10               1.893778e-03
## bpps_11               1.421689e-03
## bpps_12               6.130382e-04
## bpps_13               9.291830e-04
## bpps_14               1.656959e-03
## bpps_15               1.336155e-03
## bpps_16               1.638421e-03
## bpps_17               1.821257e-03
## bpps_18               1.792636e-03
## bpps_19               2.323732e-03
## bpps_20               2.680098e-03
## bpps_21               3.232469e-03
## bpps_22               1.865767e-03
## bpps_23               1.859285e-03
## bpps_24               2.868911e-03
## bpps_25               1.583922e-03
## bpps_26               1.408141e-03
## bpps_27               2.550648e-03
## bpps_28               2.573178e-03
## bpps_29               3.210729e-03
## bpps_30               3.392685e-03
## bpps_31               2.859124e-03
## bpps_32               3.675973e-03
## bpps_33               2.875070e-03
## bpps_34               2.020425e-03
## bpps_35               1.564927e-03
## bpps_36               7.514154e-04
## bpps_37               1.207933e-03
## bpps_38               2.934608e-03
## bpps_39               2.220242e-03
## bpps_40               3.170367e-03
## bpps_41               3.087958e-03
## bpps_42               3.674769e-03
## bpps_43               3.027906e-03
## bpps_44               1.809115e-03
## bpps_45               2.133977e-03
## bpps_46               1.616550e-03
## bpps_47               1.833402e-03
## bpps_48               2.683976e-03
## bpps_49               2.790738e-03
## bpps_50               3.758325e-03
## bpps_51               2.578619e-03
## bpps_52               3.705661e-03
## bpps_53               2.868895e-03
## bpps_54               3.876628e-03
## bpps_55               2.816541e-03
## bpps_56               3.558545e-03
## bpps_57               2.947690e-03
## bpps_58               3.245694e-03
## bpps_59               3.104380e-03
## bpps_60               3.222691e-03
## bpps_61               3.745190e-03
## bpps_62               4.229934e-03
## bpps_63               3.667797e-03
## bpps_64               3.452386e-03
## bpps_65               2.644025e-03
## bpps_66               7.012196e-04
## bpps_67               3.401004e-04
## bpps_68              -1.076501e-04
## bpps_69              -3.055528e-05
## bpps_70               3.564727e-05
## bpps_71              -1.454925e-05
## bpps_72              -4.757199e-05
## bpps_73              -1.865728e-06
## bpps_74              -5.738457e-05
## bpps_75               9.194321e-05
## bpps_76               1.131502e-04
## bpps_77              -2.106012e-04
## bpps_78               1.161510e-04
## bpps_79               1.248855e-04
## bpps_80               3.999867e-05
## bpps_81               1.164299e-04
## bpps_82              -1.115610e-06
## bpps_83              -2.953370e-05
## bpps_84              -1.064450e-04
## bpps_85              -4.704424e-05
## bpps_86              -4.126717e-05
## bpps_87              -1.711034e-04
## bpps_88              -1.364413e-04
## bpps_89              -2.711052e-04
## bpps_90              -3.632016e-04
## bpps_91               3.507422e-05
## bpps_92              -1.616542e-04
## bpps_93              -1.482776e-04
## bpps_94              -7.053845e-04
## bpps_95               3.348700e-05
## bpps_96              -2.148754e-05
## bpps_97              -6.109150e-04
## bpps_98               4.676113e-05
## bpps_99              -4.337334e-06
## bpps_100             -5.297761e-04
## bpps_101              4.608373e-05
## bpps_102             -3.788274e-06
## bpps_103             -4.812118e-04
## bpps_104              3.658510e-05
## bpps_105             -1.064612e-05
## bpps_106             -2.080609e-04</code></pre>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation ridge.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb211-1" title="1">y_pred_ridge_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_50C_pen_ridge, data_train_pen,</a>
<a class="sourceLine" id="cb211-2" title="2">                                   <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb211-3" title="3">y_pred_ridge_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_50C_pen_ridge, data_val_pen,</a>
<a class="sourceLine" id="cb211-4" title="4">                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb211-5" title="5">error_ridge_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_ridge_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb211-6" title="6"><span class="kw">print</span>(error_ridge_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1617703</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" title="1">error_ridge_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_ridge_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb213-2" title="2"><span class="kw">print</span>(error_ridge_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1633563</code></pre>
<p>On pénalise le model_gamma_deg_Mg_50C avec une pénalité lasso. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb215-1" title="1"><span class="co">#model_gamma_deg_Mg_50C_pen_lasso = cv.glmnet(data_train_pen, data_train$deg_Mg_50C,</span></a>
<a class="sourceLine" id="cb215-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb215-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 1)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" title="1"><span class="co">#saveRDS(model_gamma_deg_Mg_50C_pen_lasso, &quot;model_gamma_deg_Mg_50C_pen_lasso.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" title="1">model_gamma_deg_Mg_50C_pen_lasso &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_Mg_50C_pen_lasso.rds&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb218-1" title="1"><span class="kw">coef</span>(model_gamma_deg_Mg_50C_pen_lasso, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a></code></pre></div>
<pre><code>## 149 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                                 1
## (Intercept)           0.889189672
## (Intercept)           .          
## sequenceC             0.061100492
## sequenceG            -0.073932230
## sequenceU            -0.015269170
## index_sequence        0.005399648
## structure)           -0.031518667
## structure.           -0.269586918
## predicted_loop_typeE -0.012451376
## predicted_loop_typeH  0.098935390
## predicted_loop_typeI  0.162923286
## predicted_loop_typeM  .          
## predicted_loop_typeS  0.006382431
## predicted_loop_typeX  0.004152529
## seq_beC               0.064981607
## seq_beG              -0.047523520
## seq_beO               .          
## seq_beU              -0.049255515
## seq_afC               0.269674865
## seq_afG               0.294799004
## seq_afO               .          
## seq_afU              -0.200854795
## struct_be)           -0.075373351
## struct_be.           -0.038220433
## struct_beO            .          
## struct_af)           -0.061655616
## struct_af.           -0.013985043
## struct_afO            .          
## loop_type_beE        -0.047434745
## loop_type_beH        -0.005066496
## loop_type_beI         .          
## loop_type_beM         0.009285483
## loop_type_beO         .          
## loop_type_beS         0.088851102
## loop_type_beX         0.032194322
## loop_type_afE         0.160277089
## loop_type_afH         0.044713737
## loop_type_afI         .          
## loop_type_afM        -0.006227107
## loop_type_afO         .          
## loop_type_afS         0.157854836
## loop_type_afX        -0.084882513
## bpps_0                .          
## bpps_1                .          
## bpps_2                .          
## bpps_3                .          
## bpps_4                .          
## bpps_5                .          
## bpps_6               -0.017756841
## bpps_7                .          
## bpps_8                0.019819657
## bpps_9                0.074220014
## bpps_10               0.184457199
## bpps_11               0.156242102
## bpps_12               0.093080210
## bpps_13               0.117803065
## bpps_14               0.175018097
## bpps_15               0.127795847
## bpps_16               0.127389791
## bpps_17               0.122285162
## bpps_18               0.105419918
## bpps_19               0.159705454
## bpps_20               0.172950147
## bpps_21               0.202678573
## bpps_22               0.155362906
## bpps_23               0.130852502
## bpps_24               0.176706351
## bpps_25               0.116468469
## bpps_26               0.116385873
## bpps_27               0.144385385
## bpps_28               0.172318937
## bpps_29               0.233759597
## bpps_30               0.240374363
## bpps_31               0.170641821
## bpps_32               0.226976710
## bpps_33               0.210220302
## bpps_34               0.132125830
## bpps_35               0.134441978
## bpps_36               0.027304973
## bpps_37               0.020023172
## bpps_38               0.155021085
## bpps_39               0.082341524
## bpps_40               0.152808969
## bpps_41               0.157684760
## bpps_42               0.184543417
## bpps_43               0.159576378
## bpps_44               0.107999643
## bpps_45               0.119359341
## bpps_46               0.059524249
## bpps_47               0.070134458
## bpps_48               0.114898850
## bpps_49               0.104857604
## bpps_50               0.176503702
## bpps_51               0.093307902
## bpps_52               0.185921317
## bpps_53               0.152892168
## bpps_54               0.210041048
## bpps_55               0.108130281
## bpps_56               0.188974090
## bpps_57               0.123917295
## bpps_58               0.138203460
## bpps_59               0.119054519
## bpps_60               0.106141632
## bpps_61               0.159865548
## bpps_62               0.156840705
## bpps_63               0.148980757
## bpps_64               0.130625090
## bpps_65               0.096793116
## bpps_66               .          
## bpps_67               .          
## bpps_68               .          
## bpps_69               .          
## bpps_70               .          
## bpps_71               .          
## bpps_72               .          
## bpps_73               .          
## bpps_74               .          
## bpps_75               .          
## bpps_76               .          
## bpps_77               .          
## bpps_78               .          
## bpps_79               .          
## bpps_80               .          
## bpps_81               .          
## bpps_82               .          
## bpps_83               .          
## bpps_84               .          
## bpps_85               .          
## bpps_86               .          
## bpps_87               .          
## bpps_88               .          
## bpps_89               .          
## bpps_90               .          
## bpps_91               .          
## bpps_92               .          
## bpps_93               .          
## bpps_94               .          
## bpps_95               .          
## bpps_96               .          
## bpps_97               .          
## bpps_98               .          
## bpps_99               .          
## bpps_100              .          
## bpps_101              .          
## bpps_102              .          
## bpps_103              .          
## bpps_104              .          
## bpps_105              .          
## bpps_106              .</code></pre>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation lasso.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb220-1" title="1">y_pred_lasso_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_50C_pen_lasso, data_train_pen,</a>
<a class="sourceLine" id="cb220-2" title="2">                                   <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb220-3" title="3">error_lasso_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_lasso_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb220-4" title="4"><span class="kw">print</span>(error_lasso_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1397498</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb222-1" title="1">y_pred_lasso_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_50C_pen_lasso, data_val_pen,</a>
<a class="sourceLine" id="cb222-2" title="2">                                 <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb222-3" title="3">error_lasso_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_lasso_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb222-4" title="4"><span class="kw">print</span>(error_lasso_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1401656</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb224-1" title="1">models_deg_Mg_50C &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_Mg_50C, <span class="st">&quot;model_gamma_ridge&quot;</span>, <span class="st">&quot;model_gamma_lasso&quot;</span>)</a>
<a class="sourceLine" id="cb224-2" title="2">errors_deg_Mg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_50C_train, error_ridge_gamma_train,</a>
<a class="sourceLine" id="cb224-3" title="3">                             error_lasso_gamma_train)</a>
<a class="sourceLine" id="cb224-4" title="4">errors_deg_Mg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_50C_val, error_ridge_gamma_val, error_lasso_gamma_val)</a>
<a class="sourceLine" id="cb224-5" title="5"><span class="kw">rm</span>(error_ridge_gamma_val, error_lasso_gamma_val,</a>
<a class="sourceLine" id="cb224-6" title="6">   error_ridge_gamma_train, error_lasso_gamma_train,</a>
<a class="sourceLine" id="cb224-7" title="7">   y_pred_ridge_gamma_train, y_pred_ridge_gamma_val,</a>
<a class="sourceLine" id="cb224-8" title="8">   y_pred_lasso_gamma_train, y_pred_lasso_gamma_val)</a></code></pre></div>
</div>
<div id="pénalisation-elastic-net-3" class="section level3">
<h3>Pénalisation elastic-net</h3>
<p>On choisit <span class="math inline">\(\alpha\)</span> qui minimise le MSE sur la validation.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" title="1"><span class="co">#alpha_opti_enet_gamma_deg_Mg_50C =</span></a>
<a class="sourceLine" id="cb225-2" title="2"><span class="co">#  alpha_opti_enet(data_train = data_train_pen, data_val = data_val_pen,</span></a>
<a class="sourceLine" id="cb225-3" title="3"><span class="co">#                  y_true_train = data_train$deg_Mg_50C,</span></a>
<a class="sourceLine" id="cb225-4" title="4"><span class="co">#                  y_true_val = data_val$deg_Mg_50C,</span></a>
<a class="sourceLine" id="cb225-5" title="5"><span class="co">#                  family = Gamma)</span></a></code></pre></div>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" title="1"><span class="co">#print(alpha_opti_enet_gamma_deg_Mg_50C)</span></a></code></pre></div>
<p>On construit le modèle avec le choix optimal pour <span class="math inline">\(\alpha\)</span>.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb227-1" title="1"><span class="co">#model_gamma_deg_Mg_50C_pen_enet = cv.glmnet(data_train_pen, data_train$deg_Mg_50C,</span></a>
<a class="sourceLine" id="cb227-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb227-3" title="3"><span class="co">#                                             standardize = FALSE,</span></a>
<a class="sourceLine" id="cb227-4" title="4"><span class="co">#                                             alpha = alpha_opti_enet_gamma_deg_Mg_50C)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb228-1" title="1"><span class="co">#saveRDS(model_gamma_deg_Mg_50C_pen_enet, &quot;model_gamma_deg_Mg_50C_pen_enet.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb229-1" title="1">model_gamma_deg_Mg_50C_pen_enet &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_Mg_50C_pen_enet.rds&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" title="1"><span class="kw">coef</span>(model_gamma_deg_Mg_50C_pen_enet, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a></code></pre></div>
<pre><code>## 149 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                                 1
## (Intercept)           0.889189672
## (Intercept)           .          
## sequenceC             0.061100492
## sequenceG            -0.073932230
## sequenceU            -0.015269170
## index_sequence        0.005399648
## structure)           -0.031518667
## structure.           -0.269586918
## predicted_loop_typeE -0.012451376
## predicted_loop_typeH  0.098935390
## predicted_loop_typeI  0.162923286
## predicted_loop_typeM  .          
## predicted_loop_typeS  0.006382431
## predicted_loop_typeX  0.004152529
## seq_beC               0.064981607
## seq_beG              -0.047523520
## seq_beO               .          
## seq_beU              -0.049255515
## seq_afC               0.269674865
## seq_afG               0.294799004
## seq_afO               .          
## seq_afU              -0.200854795
## struct_be)           -0.075373351
## struct_be.           -0.038220433
## struct_beO            .          
## struct_af)           -0.061655616
## struct_af.           -0.013985043
## struct_afO            .          
## loop_type_beE        -0.047434745
## loop_type_beH        -0.005066496
## loop_type_beI         .          
## loop_type_beM         0.009285483
## loop_type_beO         .          
## loop_type_beS         0.088851102
## loop_type_beX         0.032194322
## loop_type_afE         0.160277089
## loop_type_afH         0.044713737
## loop_type_afI         .          
## loop_type_afM        -0.006227107
## loop_type_afO         .          
## loop_type_afS         0.157854836
## loop_type_afX        -0.084882513
## bpps_0                .          
## bpps_1                .          
## bpps_2                .          
## bpps_3                .          
## bpps_4                .          
## bpps_5                .          
## bpps_6               -0.017756841
## bpps_7                .          
## bpps_8                0.019819657
## bpps_9                0.074220014
## bpps_10               0.184457199
## bpps_11               0.156242102
## bpps_12               0.093080210
## bpps_13               0.117803065
## bpps_14               0.175018097
## bpps_15               0.127795847
## bpps_16               0.127389791
## bpps_17               0.122285162
## bpps_18               0.105419918
## bpps_19               0.159705454
## bpps_20               0.172950147
## bpps_21               0.202678573
## bpps_22               0.155362906
## bpps_23               0.130852502
## bpps_24               0.176706351
## bpps_25               0.116468469
## bpps_26               0.116385873
## bpps_27               0.144385385
## bpps_28               0.172318937
## bpps_29               0.233759597
## bpps_30               0.240374363
## bpps_31               0.170641821
## bpps_32               0.226976710
## bpps_33               0.210220302
## bpps_34               0.132125830
## bpps_35               0.134441978
## bpps_36               0.027304973
## bpps_37               0.020023172
## bpps_38               0.155021085
## bpps_39               0.082341524
## bpps_40               0.152808969
## bpps_41               0.157684760
## bpps_42               0.184543417
## bpps_43               0.159576378
## bpps_44               0.107999643
## bpps_45               0.119359341
## bpps_46               0.059524249
## bpps_47               0.070134458
## bpps_48               0.114898850
## bpps_49               0.104857604
## bpps_50               0.176503702
## bpps_51               0.093307902
## bpps_52               0.185921317
## bpps_53               0.152892168
## bpps_54               0.210041048
## bpps_55               0.108130281
## bpps_56               0.188974090
## bpps_57               0.123917295
## bpps_58               0.138203460
## bpps_59               0.119054519
## bpps_60               0.106141632
## bpps_61               0.159865548
## bpps_62               0.156840705
## bpps_63               0.148980757
## bpps_64               0.130625090
## bpps_65               0.096793116
## bpps_66               .          
## bpps_67               .          
## bpps_68               .          
## bpps_69               .          
## bpps_70               .          
## bpps_71               .          
## bpps_72               .          
## bpps_73               .          
## bpps_74               .          
## bpps_75               .          
## bpps_76               .          
## bpps_77               .          
## bpps_78               .          
## bpps_79               .          
## bpps_80               .          
## bpps_81               .          
## bpps_82               .          
## bpps_83               .          
## bpps_84               .          
## bpps_85               .          
## bpps_86               .          
## bpps_87               .          
## bpps_88               .          
## bpps_89               .          
## bpps_90               .          
## bpps_91               .          
## bpps_92               .          
## bpps_93               .          
## bpps_94               .          
## bpps_95               .          
## bpps_96               .          
## bpps_97               .          
## bpps_98               .          
## bpps_99               .          
## bpps_100              .          
## bpps_101              .          
## bpps_102              .          
## bpps_103              .          
## bpps_104              .          
## bpps_105              .          
## bpps_106              .</code></pre>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation elastic-net.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb232-1" title="1">y_pred_enet_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_50C_pen_enet, data_train_pen,</a>
<a class="sourceLine" id="cb232-2" title="2">                                   <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb232-3" title="3">error_enet_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_enet_gamma_train <span class="op">-</span><span class="st"> </span>data_train<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb232-4" title="4"><span class="kw">print</span>(error_enet_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1397498</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" title="1">y_pred_enet_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_Mg_50C_pen_enet, data_val_pen,</a>
<a class="sourceLine" id="cb234-2" title="2">                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb234-3" title="3">error_enet_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_enet_gamma_val <span class="op">-</span><span class="st"> </span>data_val<span class="op">$</span>deg_Mg_50C)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb234-4" title="4"><span class="kw">print</span>(error_enet_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1401656</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb236-1" title="1">models_deg_Mg_50C &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_Mg_50C, <span class="st">&quot;model_gamma_enet&quot;</span>)</a>
<a class="sourceLine" id="cb236-2" title="2">errors_deg_Mg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_50C_train, error_enet_gamma_train)</a>
<a class="sourceLine" id="cb236-3" title="3">errors_deg_Mg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_Mg_50C_val, error_enet_gamma_val)</a>
<a class="sourceLine" id="cb236-4" title="4"><span class="kw">rm</span>(error_enet_gamma_train, error_enet_gamma_val,</a>
<a class="sourceLine" id="cb236-5" title="5">   y_pred_enet_gamma_train, y_pred_enet_gamma_val)</a></code></pre></div>
</div>
<div id="récapitulatif-des-résultats-3" class="section level3">
<h3>Récapitulatif des résultats</h3>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb237-1" title="1">models_deg_Mg_50C_errors_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(models_deg_Mg_50C,</a>
<a class="sourceLine" id="cb237-2" title="2">                                          errors_deg_Mg_50C_train,</a>
<a class="sourceLine" id="cb237-3" title="3">                                          errors_deg_Mg_50C_val)</a></code></pre></div>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb238-1" title="1">models_deg_Mg_50C_errors_df</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["models_deg_Mg_50C"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_deg_Mg_50C_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_deg_Mg_50C_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma","2":"0.1773691","3":"0.1766456"},{"1":"model_gamma_ridge","2":"0.1617703","3":"0.1633563"},{"1":"model_gamma_lasso","2":"0.1397498","3":"0.1401656"},{"1":"model_gamma_enet","2":"0.1397498","3":"0.1401656"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Le meilleur modèle (au sens de la minimisation du MSE sur la validation) est le <code>model_gamma_lasso</code> (si on exclut le premier modèle qui n’était pas de plein rang).</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb239-1" title="1">models_deg_Mg_50C_errors_df[<span class="kw">which.min</span>(errors_deg_Mg_50C_val), ]</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["models_deg_Mg_50C"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_deg_Mg_50C_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_deg_Mg_50C_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma_lasso","2":"0.1397498","3":"0.1401656","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="deg_50c" class="section level2">
<h2>deg_50C</h2>
<div id="premier-modèle-4" class="section level3">
<h3>Premier modèle</h3>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb240-1" title="1">formula_gamma_deg_50C =<span class="st"> </span>formula_model_full</a></code></pre></div>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb241-1" title="1">model_gamma_deg_50C =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_gamma_deg_50C,</a>
<a class="sourceLine" id="cb241-2" title="2">                             <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_train)</a></code></pre></div>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb242-1" title="1"><span class="kw">summary</span>(model_gamma_deg_50C)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = formula_gamma_deg_50C, family = Gamma, data = data_train)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.51817  -0.22337  -0.06782   0.12456   3.00792  
## 
## Coefficients: (7 not defined because of singularities)
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           0.7989229  0.0090485  88.294  &lt; 2e-16 ***
## sequenceC             0.2703951  0.0059384  45.533  &lt; 2e-16 ***
## sequenceG            -0.0702891  0.0037986 -18.504  &lt; 2e-16 ***
## sequenceU            -0.0788956  0.0047472 -16.619  &lt; 2e-16 ***
## index_sequence        0.0063617  0.0001042  61.046  &lt; 2e-16 ***
## structure)           -0.0002012  0.0100481  -0.020 0.984022    
## structure.           -0.1436545  0.0129620 -11.083  &lt; 2e-16 ***
## predicted_loop_typeE  0.1320690  0.0231440   5.706 1.16e-08 ***
## predicted_loop_typeH  0.1919257  0.0143698  13.356  &lt; 2e-16 ***
## predicted_loop_typeI  0.2831076  0.0128925  21.959  &lt; 2e-16 ***
## predicted_loop_typeM  0.1810543  0.0177310  10.211  &lt; 2e-16 ***
## predicted_loop_typeS         NA         NA      NA       NA    
## predicted_loop_typeX  0.1618593  0.0210956   7.673 1.70e-14 ***
## seq_beC               0.0124317  0.0047704   2.606 0.009161 ** 
## seq_beG              -0.0955972  0.0036577 -26.136  &lt; 2e-16 ***
## seq_beO              -0.1791055  0.0218148  -8.210 2.24e-16 ***
## seq_beU              -0.0957504  0.0046825 -20.448  &lt; 2e-16 ***
## seq_afC               0.3715125  0.0053188  69.849  &lt; 2e-16 ***
## seq_afG               0.4209183  0.0049139  85.658  &lt; 2e-16 ***
## seq_afO               0.0883727  0.0185190   4.772 1.83e-06 ***
## seq_afU              -0.1162642  0.0041155 -28.250  &lt; 2e-16 ***
## struct_be)            0.0055618  0.0078210   0.711 0.477004    
## struct_be.           -0.0368872  0.0121773  -3.029 0.002453 ** 
## struct_beO                   NA         NA      NA       NA    
## struct_af)           -0.1096620  0.0081422 -13.468  &lt; 2e-16 ***
## struct_af.           -0.1965876  0.0116368 -16.894  &lt; 2e-16 ***
## struct_afO                   NA         NA      NA       NA    
## loop_type_beE         0.0045766  0.0211292   0.217 0.828519    
## loop_type_beH        -0.0045547  0.0133169  -0.342 0.732331    
## loop_type_beI        -0.0479460  0.0134202  -3.573 0.000354 ***
## loop_type_beM        -0.0244848  0.0165647  -1.478 0.139376    
## loop_type_beO                NA         NA      NA       NA    
## loop_type_beS                NA         NA      NA       NA    
## loop_type_beX        -0.0037208  0.0186243  -0.200 0.841653    
## loop_type_afE         0.2034528  0.0159674  12.742  &lt; 2e-16 ***
## loop_type_afH        -0.0452086  0.0132560  -3.410 0.000649 ***
## loop_type_afI         0.0539473  0.0127563   4.229 2.35e-05 ***
## loop_type_afM        -0.0131955  0.0161361  -0.818 0.413494    
## loop_type_afO                NA         NA      NA       NA    
## loop_type_afS                NA         NA      NA       NA    
## loop_type_afX        -0.0191197  0.0185535  -1.031 0.302771    
## bpps_0                1.4307370  0.2293105   6.239 4.42e-10 ***
## bpps_1                1.8499347  0.2617513   7.068 1.59e-12 ***
## bpps_2                0.1286824  0.2637094   0.488 0.625572    
## bpps_3                1.6518813  0.3275784   5.043 4.60e-07 ***
## bpps_4                0.6703695  0.2390895   2.804 0.005051 ** 
## bpps_5                0.5965273  0.0347556  17.163  &lt; 2e-16 ***
## bpps_6                0.7495353  0.0315413  23.764  &lt; 2e-16 ***
## bpps_7                0.8469023  0.0301926  28.050  &lt; 2e-16 ***
## bpps_8                0.8343332  0.0288075  28.962  &lt; 2e-16 ***
## bpps_9                0.9561525  0.0304889  31.361  &lt; 2e-16 ***
## bpps_10               0.8859270  0.0281033  31.524  &lt; 2e-16 ***
## bpps_11               0.9495781  0.0305737  31.059  &lt; 2e-16 ***
## bpps_12               0.9178562  0.0306744  29.923  &lt; 2e-16 ***
## bpps_13               0.8835467  0.0311431  28.371  &lt; 2e-16 ***
## bpps_14               0.9808834  0.0334649  29.311  &lt; 2e-16 ***
## bpps_15               0.9007171  0.0335768  26.826  &lt; 2e-16 ***
## bpps_16               0.8892810  0.0334893  26.554  &lt; 2e-16 ***
## bpps_17               0.8645905  0.0294863  29.322  &lt; 2e-16 ***
## bpps_18               0.8409426  0.0295459  28.462  &lt; 2e-16 ***
## bpps_19               0.8832841  0.0302888  29.162  &lt; 2e-16 ***
## bpps_20               1.0106499  0.0306622  32.961  &lt; 2e-16 ***
## bpps_21               0.9558724  0.0296198  32.271  &lt; 2e-16 ***
## bpps_22               0.9746255  0.0293452  33.212  &lt; 2e-16 ***
## bpps_23               0.9054551  0.0304699  29.716  &lt; 2e-16 ***
## bpps_24               0.8627111  0.0297398  29.009  &lt; 2e-16 ***
## bpps_25               0.8879407  0.0301741  29.427  &lt; 2e-16 ***
## bpps_26               0.9125527  0.0297762  30.647  &lt; 2e-16 ***
## bpps_27               0.9274502  0.0305430  30.365  &lt; 2e-16 ***
## bpps_28               0.9156497  0.0300466  30.474  &lt; 2e-16 ***
## bpps_29               1.0297723  0.0309696  33.251  &lt; 2e-16 ***
## bpps_30               1.0505855  0.0306824  34.241  &lt; 2e-16 ***
## bpps_31               0.9810940  0.0299421  32.766  &lt; 2e-16 ***
## bpps_32               0.9641271  0.0300659  32.067  &lt; 2e-16 ***
## bpps_33               1.0015369  0.0313892  31.907  &lt; 2e-16 ***
## bpps_34               0.8401679  0.0332296  25.284  &lt; 2e-16 ***
## bpps_35               0.8023917  0.0345468  23.226  &lt; 2e-16 ***
## bpps_36               0.7106755  0.0312162  22.766  &lt; 2e-16 ***
## bpps_37               0.7249111  0.0324249  22.357  &lt; 2e-16 ***
## bpps_38               0.7685107  0.0289843  26.515  &lt; 2e-16 ***
## bpps_39               0.8087168  0.0302332  26.749  &lt; 2e-16 ***
## bpps_40               0.8937376  0.0294279  30.370  &lt; 2e-16 ***
## bpps_41               1.0141207  0.0296769  34.172  &lt; 2e-16 ***
## bpps_42               1.0398283  0.0306909  33.881  &lt; 2e-16 ***
## bpps_43               0.9601583  0.0303863  31.598  &lt; 2e-16 ***
## bpps_44               0.8926553  0.0300452  29.710  &lt; 2e-16 ***
## bpps_45               0.9216535  0.0312409  29.501  &lt; 2e-16 ***
## bpps_46               0.8993284  0.0318855  28.205  &lt; 2e-16 ***
## bpps_47               0.9218051  0.0304502  30.273  &lt; 2e-16 ***
## bpps_48               0.8318666  0.0288687  28.816  &lt; 2e-16 ***
## bpps_49               0.6766232  0.0266405  25.398  &lt; 2e-16 ***
## bpps_50               0.9046436  0.0285034  31.738  &lt; 2e-16 ***
## bpps_51               0.9236830  0.0310031  29.793  &lt; 2e-16 ***
## bpps_52               0.9244072  0.0299246  30.891  &lt; 2e-16 ***
## bpps_53               1.0837204  0.0328207  33.019  &lt; 2e-16 ***
## bpps_54               0.9873968  0.0307706  32.089  &lt; 2e-16 ***
## bpps_55               0.9644849  0.0336182  28.689  &lt; 2e-16 ***
## bpps_56               1.0482980  0.0335206  31.273  &lt; 2e-16 ***
## bpps_57               0.8845200  0.0302148  29.274  &lt; 2e-16 ***
## bpps_58               1.0230625  0.0323066  31.667  &lt; 2e-16 ***
## bpps_59               0.9707645  0.0315033  30.815  &lt; 2e-16 ***
## bpps_60               0.9413354  0.0311214  30.247  &lt; 2e-16 ***
## bpps_61               0.9781072  0.0295256  33.127  &lt; 2e-16 ***
## bpps_62               1.0464553  0.0297392  35.188  &lt; 2e-16 ***
## bpps_63               1.1061364  0.0303412  36.457  &lt; 2e-16 ***
## bpps_64               1.0387091  0.0306323  33.909  &lt; 2e-16 ***
## bpps_65               1.0358927  0.0333542  31.057  &lt; 2e-16 ***
## bpps_66               0.9458616  0.0354178  26.706  &lt; 2e-16 ***
## bpps_67               0.8462472  0.0446314  18.961  &lt; 2e-16 ***
## bpps_68               0.3798108  0.1585748   2.395 0.016616 *  
## bpps_69               0.6681696  0.1714272   3.898 9.72e-05 ***
## bpps_70               0.5908460  0.1653453   3.573 0.000353 ***
## bpps_71               0.6344805  0.1691765   3.750 0.000177 ***
## bpps_72               0.7674234  0.1862643   4.120 3.79e-05 ***
## bpps_73               0.7581880  0.1893805   4.004 6.25e-05 ***
## bpps_74               0.6916896  0.1724192   4.012 6.03e-05 ***
## bpps_75               0.6805143  0.1758890   3.869 0.000109 ***
## bpps_76               1.0547971  0.1543099   6.836 8.22e-12 ***
## bpps_77               0.8699627  0.1418368   6.134 8.63e-10 ***
## bpps_78               1.4506684  0.2721420   5.331 9.82e-08 ***
## bpps_79               1.8264153  0.2576450   7.089 1.36e-12 ***
## bpps_80               0.3398083  0.1928548   1.762 0.078075 .  
## bpps_81               1.0733204  0.2277634   4.712 2.45e-06 ***
## bpps_82               0.4352459  0.2003204   2.173 0.029802 *  
## bpps_83               0.8083729  0.2054904   3.934 8.37e-05 ***
## bpps_84               0.6411063  0.2335089   2.746 0.006043 ** 
## bpps_85               0.5180261  0.2691994   1.924 0.054318 .  
## bpps_86               0.2787287  0.2837606   0.982 0.325971    
## bpps_87               0.0660257  0.1878564   0.351 0.725238    
## bpps_88               0.6591123  0.2923211   2.255 0.024151 *  
## bpps_89               0.3902584  0.2604050   1.499 0.133966    
## bpps_90               0.9562840  0.2608179   3.666 0.000246 ***
## bpps_91               0.6834267  0.3017541   2.265 0.023525 *  
## bpps_92               0.2763969  0.3511860   0.787 0.431261    
## bpps_93               0.0020363  0.3324581   0.006 0.995113    
## bpps_94              -0.1817153  0.2192374  -0.829 0.407191    
## bpps_95              -0.9328767  0.4646679  -2.008 0.044687 *  
## bpps_96               1.4153022  0.8143840   1.738 0.082235 .  
## bpps_97               0.7196925  0.4855390   1.482 0.138276    
## bpps_98               1.1436696  1.1727836   0.975 0.329476    
## bpps_99               2.5874159  1.2813900   2.019 0.043467 *  
## bpps_100              1.0424018  0.7578113   1.376 0.168967    
## bpps_101              1.6873105  1.7068059   0.989 0.322873    
## bpps_102             -1.8255209  1.3328189  -1.370 0.170794    
## bpps_103             -1.6660246  0.6775823  -2.459 0.013943 *  
## bpps_104             -0.8962370  1.5301051  -0.586 0.558055    
## bpps_105              3.1935082  1.0489279   3.045 0.002331 ** 
## bpps_106              0.9023737  0.5005205   1.803 0.071412 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.1195312)
## 
##     Null deviance: 22756.3  on 86427  degrees of freedom
## Residual deviance:  8631.1  on 86287  degrees of freedom
## AIC: -21726
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Il est important de noter que le premier modèle n’est pas de plein rang, donc on ne peut pas se fier à ses prédictions. <br> Cependant, la pénalisation va nous aider à résoudre ce problème.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb244-1" title="1">y_pred_gamma_train =<span class="st"> </span><span class="kw">predict.glm</span>(model_gamma_deg_50C,data_train,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb246-1" title="1">error_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb246-2" title="2"><span class="kw">print</span>(error_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1450845</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb248-1" title="1">y_pred_gamma_val=<span class="kw">predict.glm</span>(model_gamma_deg_50C,data_val,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb250-1" title="1">error_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb250-2" title="2"><span class="kw">print</span>(error_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1444097</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb252-1" title="1">models_deg_50C &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_50C, <span class="st">&quot;model_gamma&quot;</span>)</a>
<a class="sourceLine" id="cb252-2" title="2">errors_deg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_50C_train, error_gamma_train)</a>
<a class="sourceLine" id="cb252-3" title="3">errors_deg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_50C_val, error_gamma_val)</a>
<a class="sourceLine" id="cb252-4" title="4"><span class="kw">rm</span>(error_gamma_val, error_gamma_train, y_pred_gamma_train, y_pred_gamma_val)</a></code></pre></div>
</div>
<div id="pénalisation-ridge-et-lasso-4" class="section level3">
<h3>Pénalisation ridge et lasso</h3>
<p>On commence par calculer la matrice de design du model_gamma_deg_50C sur le train et le test.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb253-1" title="1"><span class="co"># Matrice de design du train</span></a>
<a class="sourceLine" id="cb253-2" title="2">data_train_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_gamma_deg_50C)</a>
<a class="sourceLine" id="cb253-3" title="3"><span class="co">#head(data_train_pen)</span></a></code></pre></div>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb254-1" title="1"><span class="co"># Pour faire la matrice de design de la validation</span></a>
<a class="sourceLine" id="cb254-2" title="2">model_gamma_deg_50C_val =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> formula_gamma_deg_50C,</a>
<a class="sourceLine" id="cb254-3" title="3">                                 <span class="dt">family =</span> Gamma, <span class="dt">data =</span> data_val)</a>
<a class="sourceLine" id="cb254-4" title="4">data_val_pen =<span class="st"> </span><span class="kw">model.matrix</span>(model_gamma_deg_50C_val)</a>
<a class="sourceLine" id="cb254-5" title="5"><span class="co">#head(data_val_pen)</span></a>
<a class="sourceLine" id="cb254-6" title="6"></a>
<a class="sourceLine" id="cb254-7" title="7"><span class="co"># On supprime le modèle sur le test</span></a>
<a class="sourceLine" id="cb254-8" title="8"><span class="kw">rm</span>(model_gamma_deg_50C_val)</a></code></pre></div>
<p>On pénalise le model_gamma_deg_50C avec une pénalité ridge. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb255-1" title="1"><span class="co">#model_gamma_deg_50C_pen_ridge = cv.glmnet(data_train_pen, data_train$deg_50C,</span></a>
<a class="sourceLine" id="cb255-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb255-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 0)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb256-1" title="1"><span class="co">#saveRDS(model_gamma_deg_50C_pen_ridge, &quot;model_gamma_deg_50C_pen_ridge.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb257-1" title="1">model_gamma_deg_50C_pen_ridge &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_50C_pen_ridge.rds&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb258-1" title="1"><span class="kw">coef</span>(model_gamma_deg_50C_pen_ridge, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a></code></pre></div>
<pre><code>## 149 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                                  1
## (Intercept)           9.432140e-01
## (Intercept)           .           
## sequenceC             3.606306e-02
## sequenceG            -2.911733e-02
## sequenceU             1.260174e-03
## index_sequence        4.504730e-03
## structure)           -1.058386e-03
## structure.           -7.009988e-02
## predicted_loop_typeE -2.692588e-02
## predicted_loop_typeH -9.147124e-03
## predicted_loop_typeI  3.528450e-03
## predicted_loop_typeM -1.280696e-02
## predicted_loop_typeS  7.025857e-02
## predicted_loop_typeX -1.880167e-02
## seq_beC               2.494712e-02
## seq_beG              -1.324905e-02
## seq_beO               1.710712e-03
## seq_beU              -1.110821e-02
## seq_afC               1.113493e-01
## seq_afG               8.023182e-02
## seq_afO              -1.255967e-02
## seq_afU              -5.808612e-02
## struct_be)           -1.765748e-02
## struct_be.           -4.605959e-02
## struct_beO            1.712631e-03
## struct_af)            5.534691e-03
## struct_af.           -5.035455e-02
## struct_afO           -1.255835e-02
## loop_type_beE        -2.863605e-02
## loop_type_beH        -8.422986e-03
## loop_type_beI         6.993095e-03
## loop_type_beM        -5.551934e-03
## loop_type_beO         1.709770e-03
## loop_type_beS         4.428580e-02
## loop_type_beX        -9.869651e-03
## loop_type_afE        -2.203243e-02
## loop_type_afH         6.948016e-03
## loop_type_afI         3.168510e-04
## loop_type_afM        -1.269191e-02
## loop_type_afO        -1.255935e-02
## loop_type_afS         6.277500e-02
## loop_type_afX        -1.985262e-02
## bpps_0               -1.356975e-04
## bpps_1                2.367367e-04
## bpps_2                7.794451e-05
## bpps_3               -2.204096e-05
## bpps_4               -4.190318e-05
## bpps_5               -5.041927e-03
## bpps_6               -3.647027e-03
## bpps_7               -1.556187e-03
## bpps_8                2.911555e-05
## bpps_9                4.750466e-04
## bpps_10               1.638199e-03
## bpps_11               1.719451e-03
## bpps_12               8.720050e-04
## bpps_13               9.103692e-04
## bpps_14               1.406978e-03
## bpps_15               1.020621e-03
## bpps_16               1.265570e-03
## bpps_17               1.337457e-03
## bpps_18               1.848059e-03
## bpps_19               2.232045e-03
## bpps_20               2.804244e-03
## bpps_21               3.145395e-03
## bpps_22               1.560357e-03
## bpps_23               2.020569e-03
## bpps_24               1.935164e-03
## bpps_25               1.662895e-03
## bpps_26               1.264274e-03
## bpps_27               2.617456e-03
## bpps_28               2.477623e-03
## bpps_29               2.755563e-03
## bpps_30               3.267535e-03
## bpps_31               3.305134e-03
## bpps_32               3.530579e-03
## bpps_33               3.153952e-03
## bpps_34               1.577963e-03
## bpps_35               1.352736e-03
## bpps_36              -3.338982e-04
## bpps_37               1.392683e-03
## bpps_38               2.579928e-03
## bpps_39               2.192972e-03
## bpps_40               2.888495e-03
## bpps_41               2.735422e-03
## bpps_42               3.362162e-03
## bpps_43               2.839895e-03
## bpps_44               2.013710e-03
## bpps_45               1.778722e-03
## bpps_46               1.279816e-03
## bpps_47               2.170828e-03
## bpps_48               3.246873e-03
## bpps_49               2.512581e-03
## bpps_50               3.685866e-03
## bpps_51               2.570461e-03
## bpps_52               3.365759e-03
## bpps_53               2.988100e-03
## bpps_54               3.648546e-03
## bpps_55               2.682872e-03
## bpps_56               3.536363e-03
## bpps_57               2.245592e-03
## bpps_58               3.160861e-03
## bpps_59               2.999108e-03
## bpps_60               2.987957e-03
## bpps_61               3.240777e-03
## bpps_62               3.014905e-03
## bpps_63               3.312402e-03
## bpps_64               2.041098e-03
## bpps_65               1.965120e-03
## bpps_66               7.200332e-05
## bpps_67              -2.605541e-04
## bpps_68              -1.321911e-04
## bpps_69              -2.272057e-05
## bpps_70               2.018867e-05
## bpps_71              -2.966330e-05
## bpps_72              -4.484482e-05
## bpps_73              -5.996776e-05
## bpps_74              -1.119055e-04
## bpps_75               1.053214e-05
## bpps_76               3.551586e-05
## bpps_77              -3.331247e-04
## bpps_78               8.017576e-05
## bpps_79               1.121654e-04
## bpps_80              -5.846360e-05
## bpps_81               2.794089e-05
## bpps_82               2.290875e-05
## bpps_83              -5.365212e-05
## bpps_84              -6.850275e-05
## bpps_85              -2.603958e-05
## bpps_86              -7.042729e-05
## bpps_87              -1.112123e-04
## bpps_88              -7.124925e-05
## bpps_89              -1.944376e-04
## bpps_90              -2.718717e-04
## bpps_91               8.365688e-05
## bpps_92              -1.440703e-04
## bpps_93              -1.725255e-04
## bpps_94              -6.455209e-04
## bpps_95              -2.894737e-05
## bpps_96              -2.150818e-05
## bpps_97              -5.915703e-04
## bpps_98               9.068646e-06
## bpps_99              -1.269829e-05
## bpps_100             -5.244243e-04
## bpps_101              1.434380e-05
## bpps_102             -1.147781e-05
## bpps_103             -4.753590e-04
## bpps_104              1.241560e-05
## bpps_105             -1.417478e-05
## bpps_106             -2.219012e-04</code></pre>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation ridge.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb260-1" title="1">y_pred_ridge_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_50C_pen_ridge, data_train_pen,</a>
<a class="sourceLine" id="cb260-2" title="2">                                   <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb260-3" title="3">y_pred_ridge_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_50C_pen_ridge, data_val_pen,</a>
<a class="sourceLine" id="cb260-4" title="4">                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb260-5" title="5">error_ridge_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_ridge_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb260-6" title="6"><span class="kw">print</span>(error_ridge_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1175899</code></pre>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb262-1" title="1">error_ridge_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_ridge_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb262-2" title="2"><span class="kw">print</span>(error_ridge_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1181343</code></pre>
<p>On pénalise le model_gamma_deg_50C avec une pénalité lasso. On choisira dans la suite le <span class="math inline">\(\lambda\)</span> qui minimise l’erreur de cross validation avec <code>s = &quot;lambda.min&quot;</code>. On peut afficher les coefficients du modèle correspondant.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb264-1" title="1"><span class="co">#model_gamma_deg_50C_pen_lasso = cv.glmnet(data_train_pen, data_train$deg_50C,</span></a>
<a class="sourceLine" id="cb264-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb264-3" title="3"><span class="co">#                                             standardize = FALSE, alpha = 1)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb265-1" title="1"><span class="co">#saveRDS(model_gamma_deg_50C_pen_lasso, &quot;model_gamma_deg_50C_pen_lasso.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb266-1" title="1">model_gamma_deg_50C_pen_lasso &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_50C_pen_lasso.rds&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb267-1" title="1"><span class="kw">coef</span>(model_gamma_deg_50C_pen_lasso, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a></code></pre></div>
<pre><code>## 149 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                                  1
## (Intercept)           0.8297095588
## (Intercept)           .           
## sequenceC             0.0561714562
## sequenceG            -0.0809827400
## sequenceU            -0.0298503680
## index_sequence        0.0051384219
## structure)           -0.0199268043
## structure.           -0.2077795026
## predicted_loop_typeE -0.0006684196
## predicted_loop_typeH  .           
## predicted_loop_typeI  0.0958668119
## predicted_loop_typeM  .           
## predicted_loop_typeS  0.0010129274
## predicted_loop_typeX  .           
## seq_beC               0.0518331645
## seq_beG              -0.0214092549
## seq_beO              -0.0193568441
## seq_beU              -0.0499672347
## seq_afC               0.3914718613
## seq_afG               0.2462677446
## seq_afO              -0.0796132376
## seq_afU              -0.0727894757
## struct_be)           -0.0640282198
## struct_be.            .           
## struct_beO           -0.0001812333
## struct_af)           -0.0236102395
## struct_af.            .           
## struct_afO           -0.0031865976
## loop_type_beE        -0.0530956739
## loop_type_beH        -0.0153545936
## loop_type_beI         .           
## loop_type_beM         .           
## loop_type_beO        -0.0003840333
## loop_type_beS         0.1117236814
## loop_type_beX         0.0410942731
## loop_type_afE         0.0897615105
## loop_type_afH         0.0870186688
## loop_type_afI        -0.0120335414
## loop_type_afM        -0.0090710841
## loop_type_afO         .           
## loop_type_afS         0.1032509495
## loop_type_afX        -0.0825932769
## bpps_0                .           
## bpps_1                .           
## bpps_2                .           
## bpps_3                .           
## bpps_4                .           
## bpps_5               -0.1348574199
## bpps_6               -0.1073632174
## bpps_7                .           
## bpps_8                .           
## bpps_9                0.0378555406
## bpps_10               0.1285976539
## bpps_11               0.1241243237
## bpps_12               0.0511697368
## bpps_13               0.0614178647
## bpps_14               0.1058524889
## bpps_15               0.0652263083
## bpps_16               0.0538861830
## bpps_17               0.0389632521
## bpps_18               0.0628043401
## bpps_19               0.1172548281
## bpps_20               0.1476150224
## bpps_21               0.1655883899
## bpps_22               0.0931153984
## bpps_23               0.0979780994
## bpps_24               0.0774132822
## bpps_25               0.0935609718
## bpps_26               0.0724503630
## bpps_27               0.1040837592
## bpps_28               0.1232768282
## bpps_29               0.1656636601
## bpps_30               0.1882040852
## bpps_31               0.1680263111
## bpps_32               0.1717786563
## bpps_33               0.1786578157
## bpps_34               0.0618876701
## bpps_35               0.0830847690
## bpps_36               .           
## bpps_37               0.0119861206
## bpps_38               0.0908549983
## bpps_39               0.0505398039
## bpps_40               0.1072968528
## bpps_41               0.1233673759
## bpps_42               0.1434459318
## bpps_43               0.1194359272
## bpps_44               0.0910442840
## bpps_45               0.0692439415
## bpps_46               0.0288346640
## bpps_47               0.0749982172
## bpps_48               0.1263846198
## bpps_49               0.0689739781
## bpps_50               0.1508611651
## bpps_51               0.0852487561
## bpps_52               0.1492166423
## bpps_53               0.1494576348
## bpps_54               0.1687896845
## bpps_55               0.0871224474
## bpps_56               0.1639213761
## bpps_57               0.0691626411
## bpps_58               0.1180279175
## bpps_59               0.0935441050
## bpps_60               0.0804975945
## bpps_61               0.1230398119
## bpps_62               0.0699234412
## bpps_63               0.1140102651
## bpps_64               0.0383782649
## bpps_65               0.0511815104
## bpps_66               .           
## bpps_67               .           
## bpps_68               .           
## bpps_69               .           
## bpps_70               .           
## bpps_71               .           
## bpps_72               .           
## bpps_73               .           
## bpps_74               .           
## bpps_75               .           
## bpps_76               .           
## bpps_77               .           
## bpps_78               .           
## bpps_79               .           
## bpps_80               .           
## bpps_81               .           
## bpps_82               .           
## bpps_83               .           
## bpps_84               .           
## bpps_85               .           
## bpps_86               .           
## bpps_87               .           
## bpps_88               .           
## bpps_89               .           
## bpps_90               .           
## bpps_91               .           
## bpps_92               .           
## bpps_93               .           
## bpps_94               .           
## bpps_95               .           
## bpps_96               .           
## bpps_97               .           
## bpps_98               .           
## bpps_99               .           
## bpps_100              .           
## bpps_101              .           
## bpps_102              .           
## bpps_103              .           
## bpps_104              .           
## bpps_105              .           
## bpps_106              .</code></pre>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation lasso.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb269-1" title="1">y_pred_lasso_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_50C_pen_lasso, data_train_pen,</a>
<a class="sourceLine" id="cb269-2" title="2">                                   <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb269-3" title="3">error_lasso_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_lasso_gamma_train<span class="op">-</span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb269-4" title="4"><span class="kw">print</span>(error_lasso_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1014872</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb271-1" title="1">y_pred_lasso_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_50C_pen_lasso, data_val_pen,</a>
<a class="sourceLine" id="cb271-2" title="2">                                 <span class="dt">type=</span><span class="st">&quot;response&quot;</span>, <span class="dt">s=</span><span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb271-3" title="3">error_lasso_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_lasso_gamma_val<span class="op">-</span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb271-4" title="4"><span class="kw">print</span>(error_lasso_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1017301</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb273-1" title="1">models_deg_50C &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_50C, <span class="st">&quot;model_gamma_ridge&quot;</span>, <span class="st">&quot;model_gamma_lasso&quot;</span>)</a>
<a class="sourceLine" id="cb273-2" title="2">errors_deg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_50C_train, error_ridge_gamma_train,</a>
<a class="sourceLine" id="cb273-3" title="3">                             error_lasso_gamma_train)</a>
<a class="sourceLine" id="cb273-4" title="4">errors_deg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_50C_val, error_ridge_gamma_val, error_lasso_gamma_val)</a>
<a class="sourceLine" id="cb273-5" title="5"><span class="kw">rm</span>(error_ridge_gamma_val, error_lasso_gamma_val,</a>
<a class="sourceLine" id="cb273-6" title="6">   error_ridge_gamma_train, error_lasso_gamma_train,</a>
<a class="sourceLine" id="cb273-7" title="7">   y_pred_ridge_gamma_train, y_pred_ridge_gamma_val,</a>
<a class="sourceLine" id="cb273-8" title="8">   y_pred_lasso_gamma_train, y_pred_lasso_gamma_val)</a></code></pre></div>
</div>
<div id="pénalisation-elastic-net-4" class="section level3">
<h3>Pénalisation elastic-net</h3>
<p>On choisit <span class="math inline">\(\alpha\)</span> qui minimise le MSE sur la validation.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb274-1" title="1"><span class="co">#alpha_opti_enet_gamma_deg_50C =</span></a>
<a class="sourceLine" id="cb274-2" title="2"><span class="co">#  alpha_opti_enet(data_train = data_train_pen, data_val = data_val_pen,</span></a>
<a class="sourceLine" id="cb274-3" title="3"><span class="co">#                  y_true_train = data_train$deg_50C,</span></a>
<a class="sourceLine" id="cb274-4" title="4"><span class="co">#                  y_true_val = data_val$deg_50C,</span></a>
<a class="sourceLine" id="cb274-5" title="5"><span class="co">#                  family = Gamma)</span></a></code></pre></div>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb275-1" title="1"><span class="co">#print(alpha_opti_enet_gamma_deg_50C)</span></a></code></pre></div>
<p>On construit le modèle avec le choix optimal pour <span class="math inline">\(\alpha\)</span>.</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb276-1" title="1"><span class="co">#model_gamma_deg_50C_pen_enet = cv.glmnet(data_train_pen, data_train$deg_50C,</span></a>
<a class="sourceLine" id="cb276-2" title="2"><span class="co">#                                             family = Gamma, type.measure = &quot;mse&quot;,</span></a>
<a class="sourceLine" id="cb276-3" title="3"><span class="co">#                                             standardize = FALSE,</span></a>
<a class="sourceLine" id="cb276-4" title="4"><span class="co">#                                             alpha = alpha_opti_enet_gamma_deg_50C)</span></a></code></pre></div>
<p>Sauvegarde du modèle.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb277-1" title="1"><span class="co">#saveRDS(model_gamma_deg_50C_pen_enet, &quot;model_gamma_deg_50C_pen_enet.rds&quot;)</span></a></code></pre></div>
<p>Chargement du modèle.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb278-1" title="1">model_gamma_deg_50C_pen_enet &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;model_gamma_deg_50C_pen_enet.rds&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb279-1" title="1"><span class="kw">coef</span>(model_gamma_deg_50C_pen_enet, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a></code></pre></div>
<pre><code>## 149 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                                  1
## (Intercept)           0.8297095588
## (Intercept)           .           
## sequenceC             0.0561714562
## sequenceG            -0.0809827400
## sequenceU            -0.0298503680
## index_sequence        0.0051384219
## structure)           -0.0199268043
## structure.           -0.2077795026
## predicted_loop_typeE -0.0006684196
## predicted_loop_typeH  .           
## predicted_loop_typeI  0.0958668119
## predicted_loop_typeM  .           
## predicted_loop_typeS  0.0010129274
## predicted_loop_typeX  .           
## seq_beC               0.0518331645
## seq_beG              -0.0214092549
## seq_beO              -0.0193568441
## seq_beU              -0.0499672347
## seq_afC               0.3914718613
## seq_afG               0.2462677446
## seq_afO              -0.0796132376
## seq_afU              -0.0727894757
## struct_be)           -0.0640282198
## struct_be.            .           
## struct_beO           -0.0001812333
## struct_af)           -0.0236102395
## struct_af.            .           
## struct_afO           -0.0031865976
## loop_type_beE        -0.0530956739
## loop_type_beH        -0.0153545936
## loop_type_beI         .           
## loop_type_beM         .           
## loop_type_beO        -0.0003840333
## loop_type_beS         0.1117236814
## loop_type_beX         0.0410942731
## loop_type_afE         0.0897615105
## loop_type_afH         0.0870186688
## loop_type_afI        -0.0120335414
## loop_type_afM        -0.0090710841
## loop_type_afO         .           
## loop_type_afS         0.1032509495
## loop_type_afX        -0.0825932769
## bpps_0                .           
## bpps_1                .           
## bpps_2                .           
## bpps_3                .           
## bpps_4                .           
## bpps_5               -0.1348574199
## bpps_6               -0.1073632174
## bpps_7                .           
## bpps_8                .           
## bpps_9                0.0378555406
## bpps_10               0.1285976539
## bpps_11               0.1241243237
## bpps_12               0.0511697368
## bpps_13               0.0614178647
## bpps_14               0.1058524889
## bpps_15               0.0652263083
## bpps_16               0.0538861830
## bpps_17               0.0389632521
## bpps_18               0.0628043401
## bpps_19               0.1172548281
## bpps_20               0.1476150224
## bpps_21               0.1655883899
## bpps_22               0.0931153984
## bpps_23               0.0979780994
## bpps_24               0.0774132822
## bpps_25               0.0935609718
## bpps_26               0.0724503630
## bpps_27               0.1040837592
## bpps_28               0.1232768282
## bpps_29               0.1656636601
## bpps_30               0.1882040852
## bpps_31               0.1680263111
## bpps_32               0.1717786563
## bpps_33               0.1786578157
## bpps_34               0.0618876701
## bpps_35               0.0830847690
## bpps_36               .           
## bpps_37               0.0119861206
## bpps_38               0.0908549983
## bpps_39               0.0505398039
## bpps_40               0.1072968528
## bpps_41               0.1233673759
## bpps_42               0.1434459318
## bpps_43               0.1194359272
## bpps_44               0.0910442840
## bpps_45               0.0692439415
## bpps_46               0.0288346640
## bpps_47               0.0749982172
## bpps_48               0.1263846198
## bpps_49               0.0689739781
## bpps_50               0.1508611651
## bpps_51               0.0852487561
## bpps_52               0.1492166423
## bpps_53               0.1494576348
## bpps_54               0.1687896845
## bpps_55               0.0871224474
## bpps_56               0.1639213761
## bpps_57               0.0691626411
## bpps_58               0.1180279175
## bpps_59               0.0935441050
## bpps_60               0.0804975945
## bpps_61               0.1230398119
## bpps_62               0.0699234412
## bpps_63               0.1140102651
## bpps_64               0.0383782649
## bpps_65               0.0511815104
## bpps_66               .           
## bpps_67               .           
## bpps_68               .           
## bpps_69               .           
## bpps_70               .           
## bpps_71               .           
## bpps_72               .           
## bpps_73               .           
## bpps_74               .           
## bpps_75               .           
## bpps_76               .           
## bpps_77               .           
## bpps_78               .           
## bpps_79               .           
## bpps_80               .           
## bpps_81               .           
## bpps_82               .           
## bpps_83               .           
## bpps_84               .           
## bpps_85               .           
## bpps_86               .           
## bpps_87               .           
## bpps_88               .           
## bpps_89               .           
## bpps_90               .           
## bpps_91               .           
## bpps_92               .           
## bpps_93               .           
## bpps_94               .           
## bpps_95               .           
## bpps_96               .           
## bpps_97               .           
## bpps_98               .           
## bpps_99               .           
## bpps_100              .           
## bpps_101              .           
## bpps_102              .           
## bpps_103              .           
## bpps_104              .           
## bpps_105              .           
## bpps_106              .</code></pre>
<p>On calcule les prédictions et les erreurs pour le modèle avec pénalisation elastic-net.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb281-1" title="1">y_pred_enet_gamma_train =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_50C_pen_enet, data_train_pen,</a>
<a class="sourceLine" id="cb281-2" title="2">                                   <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb281-3" title="3">error_enet_gamma_train &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_enet_gamma_train <span class="op">-</span><span class="st"> </span>data_train<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb281-4" title="4"><span class="kw">print</span>(error_enet_gamma_train)</a></code></pre></div>
<pre><code>## [1] 0.1014872</code></pre>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb283-1" title="1">y_pred_enet_gamma_val =<span class="st"> </span><span class="kw">predict</span>(model_gamma_deg_50C_pen_enet, data_val_pen,</a>
<a class="sourceLine" id="cb283-2" title="2">                                 <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;lambda.min&quot;</span>)</a>
<a class="sourceLine" id="cb283-3" title="3">error_enet_gamma_val &lt;-<span class="st"> </span><span class="kw">mean</span>((y_pred_enet_gamma_val <span class="op">-</span><span class="st"> </span>data_val<span class="op">$</span>deg_50C)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb283-4" title="4"><span class="kw">print</span>(error_enet_gamma_val)</a></code></pre></div>
<pre><code>## [1] 0.1017301</code></pre>
<p>On stocke les résultats et on supprime les variables temporaires.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb285-1" title="1">models_deg_50C &lt;-<span class="st"> </span><span class="kw">c</span>(models_deg_50C, <span class="st">&quot;model_gamma_enet&quot;</span>)</a>
<a class="sourceLine" id="cb285-2" title="2">errors_deg_50C_train &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_50C_train, error_enet_gamma_train)</a>
<a class="sourceLine" id="cb285-3" title="3">errors_deg_50C_val &lt;-<span class="st"> </span><span class="kw">c</span>(errors_deg_50C_val, error_enet_gamma_val)</a>
<a class="sourceLine" id="cb285-4" title="4"><span class="kw">rm</span>(error_enet_gamma_train, error_enet_gamma_val,</a>
<a class="sourceLine" id="cb285-5" title="5">   y_pred_enet_gamma_train, y_pred_enet_gamma_val)</a></code></pre></div>
</div>
<div id="récapitulatif-des-résultats-4" class="section level3">
<h3>Récapitulatif des résultats</h3>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb286-1" title="1">models_deg_50C_errors_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(models_deg_50C,</a>
<a class="sourceLine" id="cb286-2" title="2">                                       errors_deg_50C_train,</a>
<a class="sourceLine" id="cb286-3" title="3">                                       errors_deg_50C_val)</a></code></pre></div>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb287-1" title="1">models_deg_50C_errors_df</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["models_deg_50C"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_deg_50C_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_deg_50C_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma","2":"0.1450845","3":"0.1444097"},{"1":"model_gamma_ridge","2":"0.1175899","3":"0.1181343"},{"1":"model_gamma_lasso","2":"0.1014872","3":"0.1017301"},{"1":"model_gamma_enet","2":"0.1014872","3":"0.1017301"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Le meilleur modèle (au sens de la minimisation du MSE sur la validation) est le <code>model_gamma_lasso</code> (si on exclut le premier modèle qui n’était pas de plein rang).</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb288-1" title="1">models_deg_50C_errors_df[<span class="kw">which.min</span>(errors_deg_50C_val[<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, ]</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["models_deg_50C"],"name":[1],"type":["fct"],"align":["left"]},{"label":["errors_deg_50C_train"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors_deg_50C_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"model_gamma_lasso","2":"0.1014872","3":"0.1017301","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Sauvegarde des résultats.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb289-1" title="1"><span class="kw">save.image</span>(<span class="dt">file =</span> <span class="st">&quot;GLM_optimization_final_version.Rdata&quot;</span>)</a></code></pre></div>
<p>Chargement des résultats.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb290-1" title="1"><span class="co">#load(file = &quot;GLM_optimization_final_version.Rdata&quot;)</span></a></code></pre></div>
</div>
</div>
</div>
</section>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
